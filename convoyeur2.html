<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css"
    />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles/style-commun.css" />
  <link rel="stylesheet" href="styles/style-code.css" />
  <title>Syst√®me de convoyeur</title>
</head>
<body>
  <header class="header">
    <div class="section__container header__container_domaine">
      <h2>Conception d'un convoyeur</h2>
    </div>
  </header>

  <div class="layout-container">
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="sidebar-toggle" id="sidebarToggle">
        <i class="fas fa-bars"></i>
      </div>

      <nav class="main-nav">
        <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Accueil</a>
        <a href="it.html" class="nav-link"><i class="fas fa-desktop"></i> IT</a>
        <a href="electronique.html" class="nav-link"><i class="fas fa-microchip"></i> √âlectronique</a>
        <a href="mecanique.html" class="nav-link"><i class="fas fa-cogs"></i> M√©canique</a>
        <a href="convoyeur1.html" class="nav-link"></i><i class="fas fa-robot"></i> Convoyeur 1</a>
        
        <div class="nav-section">
         <button class="tab-button active" data-target="conveyor2-content"><i class="fas fa-robot"></i> Convoyeur 2</button>
          <div class="sub-links">
            <a class="subtab-button active" data-target="intro2" href="#introduction2">G√©n√©ralit√©</a>

            <nav class="project-subnav active" id="subnav-intro2">
              <a href="#1-intro2">1. Contexte</a>
              <a href="#2-intro2">2. Objectifs</a>
              <a href="#3-intro2">3. Pr√©sentation du syst√®me</a>
              <a href="#4-intro2">4. Technologies utilis√©es</a>
            </nav>

            <a class="subtab-button" data-target="cahier2" href="#cahier_de_charge2">Cahier de charge</a>
            <nav class="project-subnav" id="subnav-cahier2">
              <a href="#1-cahier2">1. Besoins fonctionnels</a>
              <a href="#2-cahier2">2. Contraintes</a>
            </nav>

            <a class="subtab-button" data-target="meca2" href="#mecanique2">Partie m√©canique</a>
            <nav class="project-subnav" id="subnav-meca2">
              <a href="#1-meca2">1. √âtude de conception m√©canique</a>
              <a href="#2-meca2">2. Choix des composants m√©caniques</a>
              <a href="#3-meca2">3. Mod√©lisation CAO (SolidWorks)</a>
              <a href="#4-meca2">4. R√©alisation</a>
            </nav>

            <a class="subtab-button" data-target="electro2" href="#electronique2">Partie √©lectronique</a>
            <nav class="project-subnav" id="subnav-electro2">
              <a href="#1-electro2">1. Cahier de charge</a>
              <a href="#2-electro2">2. Sch√©ma synoptique</a>
              <a href="#3-electro2">3. Description fonctionnelle </a>
              <a href="#4-electro2">4. Tests et validation</a>
              <a href="#5-electro2">5. R√©alisation du PCB</a>
              <a href="#6-electro2">6. Prototype final</a>
            </nav>

            <a class="subtab-button" data-target="info2" href="#informatique2">Partie informatique</a>
            <nav class="project-subnav" id="subnav-info2">
              <a href="#1-info2">1. D√©tection intelligente et automatisation</a>
              <a href="#2-info2">2. Interface Web</a>
              <a href="#3-info2">3. Architecture technique et Technologies utilis√©es</a>
              <a href="#4-info2">4. Communication s√©rie et Traitement des Donn√©es</a>
              <a href="#5-info2">5. Instructions d'utilisation</a>
            </nav>

            <a class="subtab-button" data-target="test2" href="#validation2">Test et validation</a>
            <nav class="project-subnav" id="subnav-test2">
              <a href="#1-test2">1. Assemblage du convoyeur</a>
              <a href="#2-test2">2. Protocole de test</a>
              <a href="#3-test2">3. R√©sultats et d√©monstration</a>
            </nav>

            <a class="subtab-button" data-target="concl2" href="#conclusion2">Conclusion et Annexes</a>
            <nav class="project-subnav" id="subnav-concl2">
              <a href="#1-concl2">1. Conclusion et perspectives</a>
              <a href="#2-concl2">2. Annexes</a>
            </nav>

          </div>
        </div>

      </nav>
    </div>

    <!-- Contenu principal -->
    <main class="main-content">
      <section id="convoyeur-content" class="tab-content active">

        <div id="introduction2" class="subtab-content active">
          <h2 id="intro2" class="projet-titre">Introduction g√©n√©rale</h2>
          <h3 id="1-intro2">1. Contexte</h3>
            <p>
               Dans le cadre du d√©veloppement durable et de l‚Äôoptimisation des processus industriels, 
               la ville industrielle de TEKBOT CITY souhaite accueillir une nouvelle entreprise sp√©cialis√©e dans le recyclage des d√©chets. 
               Afin de <strong>moderniser</strong> ses infrastructures et de renforcer l‚Äôefficacit√© du <strong>tri</strong>, 
               il est envisag√© d‚Äôinstaller un <strong>syst√®me intelligent de convoyeur</strong> capable d‚Äôidentifier, 
               trier et comptabiliser automatiquement diff√©rents types de d√©chets.
            </p>

            <p>
              Ce projet s'inscrit dans le cadre de la TRC 2025, un challenge technologique pluridisciplinaire visant √† combiner la <strong>m√©canique</strong>, 
              l‚Äô<strong>√©lectronique</strong> et l‚Äô<strong>informatique embarqu√©e</strong> pour r√©soudre des probl√©matiques industrielles concr√®tes.
            </p>
          <h3 id="2-intro2">2. Objectifs</h3>
            <p>
              L‚Äôobjectif principal de ce projet est de concevoir, r√©aliser et tester 
              un <strong>syst√®me de convoyeur intelligent</strong> capable de :
              <ul>
                <li>D√©tecter la pr√©sence d‚Äôun objet(un d√©chet) sur un tapis roulant,</li>
                <li>Identifier sa couleur et son type(Rouge, Vert, Jaune, Bleu) √† l‚Äôaide d‚Äôun capteur adapt√©,</li>
                <li>Compter chaque type de d√©chet d√©tect√©,</li>
                <li>Et afficher en temps r√©el ces donn√©es sur une interface web destin√©e aux administrateurs</li>
              </ul>
            </p>
          <h3 id="3-intro2">3. Pr√©sentation du syst√®me</h3>
            <p>
              Le syst√®me est compos√© de trois grandes parties interconnect√©es :
            </p>
            <ul>
              <li>
                <strong>La bande transporteuse</strong>(convoyeur) reste immobile en l‚Äôabsence de d√©chet 
                et s‚Äôactive automatiquement d√®s qu‚Äôun objet est d√©tect√© par un capteur de pr√©sence. 
                Elle transporte le d√©chet jusqu‚Äô√† une zone de d√©p√¥t.
              </li>
              <li>
                <strong>Le module de tri</strong> utilise un capteur de couleur pour identifier l‚Äôobjet. 
                Un algorithme embarqu√© analyse cette couleur et classe le d√©chet dans une cat√©gorie d√©finie. 
                En fin de course, une indication visuelle informe l‚Äô√©quipe de collecte sur le bac appropri√©.
              </li>
              <li>
                <strong>L‚Äôinterface web</strong> re√ßoit les donn√©es via une communication s√©rie (Web Serial API) 
                et affiche dynamiquement le nombre de d√©chets tri√©s par couleur. Elle offre une visualisation claire, et permet un suivi en direct.
              </li>
            </ul>
          <h3 id="4-intro2">4. Technologies utilis√©es</h3>
            <p>
              Le projet exploite un ensemble coh√©rent de technologies issues des trois domaines du projet :
            </p>
            <table border="2" cellspacing="1" cellpadding="6">
              <thead>
                <tr>
                  <th>Domaine</th>
                  <th>Technologies¬†/ Outils utilis√©s</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>√âlectronique</strong></td>
                  <td>Arduino¬†Nano, capteur de couleur(ColorPal), capteur de pr√©sence(Ultrason), moteur DC, LED¬†RGB, driver moteur, alimentation Li‚ÄëIon</td>
                </tr>
                <tr>
                  <td><strong>Informatique</strong></td>
                  <td>HTML, CSS, JavaScript (Web¬†Serial¬†API), Python, Chart.js pour les graphiques, communication s√©rie¬†USB</td>
                </tr>
                <tr>
                  <td><strong>M√©canique</strong></td>
                  <td>Conception CAO sur SolidWorks, tapis roulant, structure en bois et plastique</td>
                </tr>
              </tbody>
            </table>
        </div>

        <div id="cahier2" class="subtab-content">
          <h2 id="cahier_de_charge2" class="projet-titre">Cahier de charge</h2>
          <h3 id="1-cahier2">1. Besoins fonctionnels</h3>
            <p>
              Le syst√®me de convoyeur doit r√©pondre aux besoins suivants
            </p>
            <ul>
              <li>
                <strong>Tri intelligent de 4 types de d√©chets</strong>, repr√©sent√©s par des objets de couleurs diff√©rentes:
                <ul>
                  <li>Rouge ‚Üí Type 1</li>
                  <li>Vert ‚Üí Type 2</li>
                  <li>Jaune ‚Üí Type 3</li>
                  <li>Bleu ‚Üí Type 4</li>
                </ul>
              </li>
              <li><strong>D√©tection automatique de la pr√©sence</strong> d‚Äôun objet sur la bande transporteuse √† l‚Äôaide d‚Äôun capteur de pr√©sence</li>
              <li><strong>Identification pr√©cise</strong> de la couleur du d√©chet via un capteur de couleur.</li>
              <li><strong>Activation automatique</strong> du convoyeur uniquement lorsqu‚Äôun objet est d√©tect√©.</li>
              <li><strong>Indication claire de la cat√©gorie de tri</strong>, pour permettre une collecte manuelle efficace dans les bacs correspondants.</li>
              <li><strong>Visualisation en temps r√©el</strong>l sur une interface web intuitive, permettant √† l‚Äôadministrateur de :</li>
              <ul>
                <li>Suivre le nombre de d√©chets tri√©s par type.</li>
                <li>Suivre la performance du syst√®me</li>
                <li>Intervenir en cas de probl√®me</li>
              </ul>
            </ul>


          <h3 id="2-cahier2">2. Contraintes</h3>
            <p>
              Le syst√®me doit respecter un ensemble de contraintes techniques fix√©es :
            </p>
            <ul>
              <li>
                <strong>Alimentation autonome</strong> √† partir d‚Äôun bloc de batteries lithium, garantissant une mobilit√© et une s√©curit√© √©nerg√©tique.
              </li>
              <li>
                <strong>D√©tection obligatoire par un syst√®me de capteurs impos√©s :</strong>
                <ul>
                  <li>Capteur de pr√©sence</li>
                  <li>Capteur de couleur</li>
                </ul>
              </li>
              <li>
                <strong>Microcontr√¥leur impos√© :</strong> Arduino Nano ou ATmega
              </li>
              <li>
                <strong>Contraintes m√©caniques pr√©cises :</strong>
                <ul>
                  <li>Longueur du convoyeur : 650 mm.</li>
                  <li>Hauteur du tapis par rapport au sol : 100 mm.</li>
                </ul>
              </li>
              <li>
                <strong>Poids et dimensions des objets √† trier :</strong>
                <ul>
                  <li>Forme : cube.</li>
                  <li>Taille : 30 mm de c√¥t√©.</li>
                </ul>
              </li>
            </ul>
        </div>

        <div id="mecanique2" class="subtab-content">
          <h2 id="meca2" class="projet-titre">Partie m√©canique</h2>
          <h3 id="1-meca2">1. √âtude de conception m√©canique(Analyse fonctionnelle)</h3>
              <p>
                L‚Äôanalyse fonctionnelle est une d√©marche essentielle dans la conception d‚Äôun syst√®me technique. 
                Elle vise √† identifier, comprendre et formaliser les besoins r√©els des utilisateurs ainsi que les fonctions que le syst√®me doit remplir pour y r√©pondre. 
                Dans le cadre de ce projet, qui consiste √† d√©velopper un syst√®me de convoyeur intelligent pour le tri de d√©chets(consid√©r√©s ici comme des objets color√©s), l‚Äôanalyse fonctionnelle permettra de structurer la r√©flexion en distinguant les fonctions principales, les contraintes techniques, et les interactions entre les diff√©rents composants. 
              </p>
            
            <h4>a. Analyse de besoin:</h4>
              <p>
                La b√™te √† cornes est un diagramme repr√©sent√© sous forme de graphique. 
                Il permet de savoir si un produit ou un service r√©pond aux besoins des utilisateurs. 
                Elle est appel√©e b√™te √† corne, car elle ressemble √† une t√™te de taureau avec la ligne reliant les deux boules en haut du diagramme.
                Pour d√©buter, nous allons commencer par faire une analyse de besoin en utilisant ce diagramme de b√™te √† corne qui va nous permettre de r√©pondre aux trois questions suivantes:
                <ul>
                  <li>Qui utilise le syst√®me ?</li>
                  <li>Sur quoi agit-il ?</li>
                  <li>Dans quel but ?</li>
                </ul>
              </p>
              <div class="image-container">
                <img src="images/Test4_2/Mecanique/analyse1.png" alt="analyse" class="image-mean"/>
              </div>

              <h4>b. √ânonc√© du besoin</h4>
                <p>
                  Notre syst√®me de convoyeur rend service √† une entreprise de recyclage dans la zone industrielle de TECHBOT CITY 
                  en permettant de trier automatiquement des d√©chets en fonction de leurs couleurs afin de faciliter la collecte.  
                </p>

              <h4>c. Analyse fonctionnelle du besoin (AFB)</h4>
                <p>
                  Une analyse fonctionnelle de besoin se concentre sur l'identification de deux types principaux de fonctions: les fonctions principales et les fonctions contraintes.
                  Les fonctions principales d√©crivent ce que le produit ou syst√®me doit faire pour satisfaire le besoin de l'utilisateur, tandis que les fonctions contraintes 
                  d√©finissent les limites ou les conditions dans lesquelles ces fonctions principales doivent √™tre r√©alis√©es.
                </p>
                <p>
                  <strong>Fonctions principales:</strong>
                  <ul>
                    <li>Elles sont la raison d'√™tre du produit ou du syst√®me.</li>
                    <li>Elles r√©pondent directement au besoin de l'utilisateur. </li>
                    <li>Elles peuvent √™tre d√©compos√©es en fonctions √©l√©mentaires pour une analyse plus d√©taill√©e.</li>
                  </ul>
                </p>

                <p>
                  <strong>Fonctions contraintes</strong>
                  <ul>
                    <li>Elles limitent les choix du concepteur et du produit.</li>
                    <li>Elles peuvent √™tre li√©es √† la s√©curit√©, l'environnement, l'ergonomie, etc.</li>
                    <li>Exemple: "√ätre compatible avec les normes de s√©curit√©" pour une voiture. </li>
                  </ul>
                </p>

                <p>
                  En plus de ces fonctions principales et les fonctions de contraintes, 
                  nous allons ajouter et d√©tailler des fonctions de services pour mieux satisfaire les besoins de l‚Äôentreprise de faire le syst√®me de tri avec le convoyeur.
                </p>
                <p>
                  En r√©sum√©, l'analyse fonctionnelle de besoin vise √† identifier 
                  et √† caract√©riser ces deux types de fonctions afin de bien comprendre les exigences du produit et de garantir sa pertinence par rapport au besoin initial. 
                </p>
                
                <p>
                  Pour bien √©tudier notre syst√®me et pour d√©finir les fonctions principales et les fonctions de contraintes, nous allons utiliser le diagramme de pieuvre.
                </p>
                <div class="image-container">
                  <p>Diagramme de pieuvre:</p>
                  <img src="images/Test4_2/Mecanique/analyse2.png" alt="analyse" class="image-mean"/>
                </div>

                <table border="2" cellspacing="1" cellpadding="6">
                  <tbody>
                  <tr>
                    <td>FP1</td>
                    <td>transf√©rer les d√©chets</td>
                  </tr>
                  <tr>
                    <td>FP2</td>
                    <td>trier les d√©chets</td>
                  </tr>
                  <tr>
                    <td>FP3</td>
                    <td>interface web pour affichage</td>
                  </tr>
                  <tr>
                    <td>FC1</td>
                    <td>utiliser l'arduino nano</td>
                  </tr>
                  <tr>
                    <td>FC2</td>
                    <td>alimentation batterie lithium</td>
                  </tr>
                  <tr>
                    <td>FC3</td>
                    <td>le convoyeur ne doit fonctionner que si un d√©chet est pr√©sent</td>
                  </tr>
                  <tr>
                    <td>FC4</td>
                    <td>le capteur de pr√©sence(Ultrason)</td>
                  </tr>
                  <tr>
                    <td>FC5</td>
                    <td>
                      dimension:
                      <ul>
                        <li style="font-size: 1rem;">longueur du convoyeur: 650 mm</li>
                        <li style="font-size: 1rem;">hauteur du tapis: 100 mm</li>
                        <li style="font-size: 1rem;">largeur du tapis: 50 mm</li>
                      </ul>
                    </td>
                  </tr>
                  <tr>
                    <td>FC6</td>
                    <td>les d√©chets sous formes de cubes de 30 mm</td>
                  </tr>
                  <tr>
                    <td>FS1</td>
                    <td>d√©tecter la pr√©sence d'un d√©chet</td>
                  </tr>
                  <tr>
                    <td>FS2</td>
                    <td>identifier la couleur du d√©chet</td>
                  </tr>
                  <tr>
                    <td>FS3</td>
                    <td>d√©placer le tapis du convoyeur</td>
                  </tr>
                  <tr>
                    <td>FS4</td>
                    <td>afficher les statistiques de tri en temps r√©el sur une interface web</td>
                  </tr>
                  <tr>
                    <td>FS5</td>
                    <td>indiquer √† l'utilisateur dans quelle benne placer le d√©chet</td>
                  </tr>
                </tbody>
              </table>

            <h4>d. Diagramme FAST</h4>
              <p>
                Le diagramme FAST (Function Analysis System Technique) est la repr√©sentation visuelle d'un produit ou d‚Äôun syst√®me et de toutes ses fonctions.
                Ce diagramme est un outil utilis√© par les entreprises pour obtenir une vision globale d'un produit existant ou en cours de cr√©ation. Il repr√©sente sch√©matiquement toutes les fonctions de l'article et la mani√®re dont il les met en ≈ìuvre.
              </p>
              <p><strong>√Ä quoi sert le diagramme FAST ?</strong></p>
              <p>
                Il r√©pond √† trois grandes questions pour chaque fonction :
                <ul>
                  <li>Pourquoi ?</li>
                  <li>Comment ?</li>
                  <li>Quand ?</li>
                </ul>
              </p>
              <p>
                Il repr√©sente <strong>graphiquement</strong> les relations entre les fonctions principales (FP) et les fonctions de service (FS)
              </p>
              <div class="image-container">
                <img src="images/Test4_2/Mecanique/analyse3.png" alt="analyse" class="image-mean"/>
              </div>
            <h4>e. Conclusion g√©n√©rale de l‚Äôanalyse fonctionnelle</h4>
              <p>
                L‚Äôanalyse fonctionnelle a permis d‚Äôidentifier clairement les fonctions principales du syst√®me de convoyeur : trier automatiquement les d√©chets selon leur couleur.
                Pour r√©pondre efficacement √† ce besoin, plusieurs fonctions de service ont √©t√© d√©finies, telles que la d√©tection de pr√©sence, l‚Äôidentification de couleur, le d√©placement du tapis et l‚Äôaffichage des statistiques en temps r√©el.
              </p>
              <p>
                Les fonctions contraintes impos√©es par le cahier des charges (composants √† utiliser, dimensions, alimentation etc.) ont √©t√© int√©gr√©es dans la conception d√®s les premi√®res √©tapes
              </p>
              <p>
                Cette analyse permet ainsi de poser une base solide pour la phase de conception et garantit que le syst√®me r√©pondra aux attentes techniques, fonctionnelles et ergonomiques de l‚Äôentreprise utilisatrice.
              </p>
            
            

          <h3 id="2-meca2">2. Choix des composants m√©caniques</h3>
            <p>
              Ayant d√©j√† du bois comme mati√®re premi√®re, nous avons d√©cid√© de l‚Äôutiliser, 
              ainsi que d‚Äôautres composants d√©j√† en notre possession tels que le tapis et les roulements.
            </p>
            <p>
              Voici donc le tableau r√©capitulatif des composants utilis√©s et de leur r√¥le :
            </p>
            <table border="2" cellspacing="1" cellpadding="6">
              <thead>
                <tr>
                  <th>Composants</th>
                  <th>Mat√©riaux</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>Parois lat√©rales</strong></td>
                  <td>Bois</td>
                </tr>
                <tr>
                  <td><strong>Tapis</strong></td>
                  <td>Textile</td>
                </tr>
                <tr>
                  <td><strong>Roulements</strong></td>
                  <td>Acier</td>
                </tr>
                <tr>
                  <td><strong>Tambours</strong></td>
                  <td>Plastique</td>
                </tr>
                <tr>
                  <td><strong>Supports des tambours</strong></td>
                  <td>Plastique</td>
                </tr>
                <tr>
                  <td><strong>Supports des composants √©lectroniques</strong></td>
                  <td>Plastique</td>
                </tr>
              </tbody>
            </table>
          <h3 id="3-meca2">3. Mod√©lisation CAO (SolidWorks)</h3>
            <p>
              Nous avons con√ßu les diff√©rentes pi√®ces puis avons assembl√© sur <strong>SolidWorks</strong> 
              en respectant les dimensions du cahier de charge.
            </p>
            <h4>a. Parois lat√©rales</h4>
              <p>
                Il s'agit de la structure principale du convoyeur.
              </p>
              <div class="image-container">
                <img src="images/Test4_2/Mecanique/parois1.png" alt="parois" class="image-mean"/>
                <img src="images/Test4_2/Mecanique/parois2.png" alt="parois" class="image-mean"/>
                <p>
                  <a href="https://github.com/TekBot-Robotics-Challenge/2025-Team-B2MS_CleanTech-Docs/raw/refs/heads/main/Test4_2/Mecanique/Bords.rar" download class="download-link">t√©l√©charger les parois lat√©rales</a>
                </p> 
              </div>

            <h4>b. Tapis</h4>
              <p>
                Il s'agit de la structure principale du convoyeur.
              </p>
              <div class="image-container">
                <img src="images/Test4_2/Mecanique/tapis1.png" alt="tapis" class="image-mean"/>
                <img src="images/Test4_2/Mecanique/tapis2.png" alt="tapis" class="image-mean"/>
                <p>
                  <a href="https://github.com/TekBot-Robotics-Challenge/2025-Team-B2MS_CleanTech-Docs/raw/refs/heads/main/Test4_2/Mecanique/Tapis.SLDPRT" download class="download-link">t√©l√©charger le tapis</a>
                </p> 
              </div>

            <h4>c. Roulements</h4>
              <p>
                Il s'agit de la structure principale du convoyeur.
              </p>

              <div class="image-container">
                <p>Interieur du roulement:</p>
                <img src="images/Test4_2/Mecanique/roulements1.png" alt="roulements" class="image-small"/>
                <img src="images/Test4_2/Mecanique/roulements2.png" alt="roulements" class="image-small"/>
              </div>

              <div class="image-container">
                <p>Exterieur du roulement:</p>
                <img src="images/Test4_2/Mecanique/roulements3.png" alt="roulements" class="image-small"/>
                <img src="images/Test4_2/Mecanique/roulements4.png" alt="roulements" class="image-small"/>
                <img src="images/Test4_2/Mecanique/roulements5.png" alt="roulements" class="image-small"/> 
              </div>

              <div class="image-container">
                <p>Le roulement assembl√©:</p>
                <img src="images/Test4_2/Mecanique/roulements6.png" alt="roulements" class="image-mean"/> 
              </div>

              <p class="txt_center">
                <a href="https://github.com/TekBot-Robotics-Challenge/2025-Team-B2MS_CleanTech-Docs/raw/refs/heads/main/Test4_2/Mecanique/Roulement.rar" download class="download-link">t√©l√©charger les fichiers du roulement</a>
              </p>

            <h4>d. Tambours</h4>
              <p>
                Les deux tambours entrainent le tapis en rotation.
                L'un des tambours est connect√© au moteur.
              </p>
              
              <div class="image-container">
                <p>Tambour connect√© au moteur</p>
                <img src="images/Test4_2/Mecanique/tambours_motor1.png" alt="tambours_motor" class="image-small"/>
                <img src="images/Test4_2/Mecanique/tambours_motor2.png" alt="tambours_motor" class="image-small"/>
                <img src="images/Test4_2/Mecanique/tambours_motor3.png" alt="tambours_motor" class="image-small"/>
                <img src="images/Test4_2/Mecanique/tambours_motor4.png" alt="tambours_motor" class="image-small"/>             
                <p>
                  <a href="https://github.com/TekBot-Robotics-Challenge/2025-Team-B2MS_CleanTech-Docs/raw/refs/heads/main/Test4_2/Mecanique/Cylindre%20convoyeur%20moteur.SLDPRT" download class="download-link">t√©l√©charger le tambour connect√© au moteur</a>
                </p> 
              </div>

              <div class="image-container">
                <p>Tambour libre</p>
                <img src="images/Test4_2/Mecanique/tambours_libre1.png" alt="tambours_libre" class="image-small"/>
                <img src="images/Test4_2/Mecanique/tambours_libre2.png" alt="tambours_libre" class="image-small"/>
                <img src="images/Test4_2/Mecanique/tambours_libre3.png" alt="tambours_libre" class="image-small"/>
                <p>
                  <a href="https://github.com/TekBot-Robotics-Challenge/2025-Team-B2MS_CleanTech-Docs/raw/refs/heads/main/Test4_2/Mecanique/Cylindre%20conv.SLDPRT" download class="download-link">t√©l√©charger le tambour libre</a>
                </p> 
              </div>
              
            <h4>e. Supports des tambours</h4>
              <p>
                Ils permettent de relier les parois, les roulement et les tambours.
              </p>
              <div class="image-container">
                <p>Support du tambour c√¥t√© moteur</p>
                <img src="images/Test4_2/Mecanique/support_tambours_motor1.png" alt="support_tambours_motor" class="image-small"/>
                <img src="images/Test4_2/Mecanique/support_tambours_motor2.png" alt="support_tambours_motor" class="image-small"/>
                <img src="images/Test4_2/Mecanique/support_tambours_motor3.png" alt="support_tambours_motor" class="image-mean"/>
                <p>
                  <a href="https://github.com/TekBot-Robotics-Challenge/2025-Team-B2MS_CleanTech-Docs/raw/refs/heads/main/Test4_2/Mecanique/Roller__Holder_inside.SLDPRT" download class="download-link">t√©l√©charger le support du tambour c√¥t√© moteur</a>
                </p> 
              </div>

              <div class="image-container">
                <p>Support des tambours libres</p>
                <img src="images/Test4_2/Mecanique/support_tambours_libre1.png" alt="support_tambours_libre" class="image-small"/>
                <img src="images/Test4_2/Mecanique/support_tambours_libre2.png" alt="support_tambours_libre" class="image-small"/>
                <img src="images/Test4_2/Mecanique/support_tambours_libre3.png" alt="support_tambours_libre" class="image-mean"/>
                <p>
                  <a href="https://github.com/TekBot-Robotics-Challenge/2025-Team-B2MS_CleanTech-Docs/raw/refs/heads/main/Test4_2/Mecanique/Roller__Holder.SLDPRT" download class="download-link">t√©l√©charger le support du tambour libre</a>
                </p> 
              </div>
            

            <h4>f. Supports des composants √©lectroniques et autres</h4>
              <p>
                Ils permettent de supporter et de fixer les composants √©lectroniques.
              </p>
              <div class="image-container">
                <p>Support Ultrason et moteur</p>
                <img src="images/Test4_2/Mecanique/support_composant1.png" alt="support_composant" class="image-small"/>
                <img src="images/Test4_2/Mecanique/support_composant2.png" alt="support_composant" class="image-small"/>
                <img src="images/Test4_2/Mecanique/support_composant3.png" alt="support_composant" class="image-mean"/>
                <p>
                  <a href="https://github.com/TekBot-Robotics-Challenge/2025-Team-B2MS_CleanTech-Docs/raw/refs/heads/main/Test4_2/Mecanique/Support_Ultrason.SLDPRT" download class="download-link">t√©l√©charger le support Ultrason et moteur</a>
                </p> 
              </div>
              
              <div class="image-container">
                <p>Support du capteur de couleur, de la led RGB et des boutons poussoirs</p>
                 <img src="images/Test4_2/Mecanique/support_composant4.png" alt="support_composant" class="image-small"/>
                 <img src="images/Test4_2/Mecanique/support_composant5.png" alt="support_composant" class="image-small"/>
                 <img src="images/Test4_2/Mecanique/support_composant6.png" alt="support_composant" class="image-small"/>
                <p>
                  <a href="https://github.com/TekBot-Robotics-Challenge/2025-Team-B2MS_CleanTech-Docs/raw/refs/heads/main/Test4_2/Mecanique/Support_ColorSencor.SLDPRT" download class="download-link">t√©l√©charger le support du capteur de couleur et des boutons poussoirs</a>
                </p> 
              </div>

              <div class="image-container">
                <p>Support du capteur infrarouge</p>
                 <img src="images/Test4_2/Mecanique/support_infrarouge.png" alt="support_infrarouge" class="image-small"/>
                 <p>
                  <a href="https://github.com/TekBot-Robotics-Challenge/2025-Team-B2MS_CleanTech-Docs/raw/refs/heads/main/Test4_2/Mecanique/support_infrarouge.SLDPRT" download class="download-link">t√©l√©charger le support du capteur infrarouge</a>
                </p> 
              </div>

              <div class="image-container">
                <p>Un support au milieu du convoyeur pour le circuit</p>
                 <img src="images/Test4_2/Mecanique/support_pcb.png" alt="support_pcb" class="image-small"/>
                <p>
                  <a href="https://github.com/TekBot-Robotics-Challenge/2025-Team-B2MS_CleanTech-Docs/raw/refs/heads/main/Test4_2/Mecanique/supportConvoyeur_milieu.SLDPRT" download class="download-link">t√©l√©charger le support du convoyeur et du circuit</a>
                </p> 
              </div>

              <div class="image-container">
                <p>Deux supports aux extr√©mit√©s pour fixer le convoyeur au sol</p>
                <img src="images/Test4_2/Mecanique/support_extremite.png" alt="support_extremite" class="image-small"/>
                <p>
                  <a href="https://githhttpsub.com/TekBot-Robotics-Challenge/2025-Team-B2MS_CleanTech-Docs/raw/refs/heads/main/Test4_2/Mecanique/supportConvoyeur.SLDPRT" download class="download-link">t√©l√©charger le support du convoyeur</a>
                </p> 
              </div>

            <h4>g. Moteur DC</h4>
              <p>
                Il s'agit de la structure principale du convoyeur.
              </p>
              <div class="image-container">
                <img src="images/Test4_2/Mecanique/moteur1.png" alt="moteur" class="image-small"/>
                <img src="images/Test4_2/Mecanique/moteur2.png" alt="moteur" class="image-small"/>
                <img src="images/Test4_2/Mecanique/moteur3.png" alt="moteur" class="image-small"/>
                <img src="images/Test4_2/Mecanique/moteur4.png" alt="moteur" class="image-small"/>
                <img src="images/Test4_2/Mecanique/moteur5.png" alt="moteur" class="image-small"/>
                <img src="images/Test4_2/Mecanique/moteur6.png" alt="moteur" class="image-small"/>
                <img src="images/Test4_2/Mecanique/moteur7.png" alt="moteur" class="image-small"/>
                <img src="images/Test4_2/Mecanique/moteur8.png" alt="moteur" class="image-small"/>
                <img src="images/Test4_2/Mecanique/moteur9.png" alt="moteur" class="image-small"/>
                <img src="images/Test4_2/Mecanique/moteur10.png" alt="moteur" class="image-small"/>
              </div>

              <div class="image-container">
                <img src="images/Test4_2/Mecanique/moteur11.png" alt="moteur" class="image-mean"/>
                <p>
                  <a href="https://github.com/TekBot-Robotics-Challenge/2025-Team-B2MS_CleanTech-Docs/raw/refs/heads/main/Test4_2/Mecanique/Motor%20DC.rar" download class="download-link">t√©l√©charger le moteur DC</a>
                </p> 
              </div>

            <h4>h. Le convoyeur assembl√©</h4>
              <p>
                A partir de ces pi√®ces, nous avons assembl√© le convoyeur.
              </p>
              <div class="image-container">
                <img src="images/Test4_2/Mecanique/assemblage1.png" alt="assemblage" class="image-small"/>
                <img src="images/Test4_2/Mecanique/assemblage2.png" alt="assemblage" class="image-small"/>
                <img src="images/Test4_2/Mecanique/assemblage3.png" alt="assemblage" class="image-small"/>
                <img src="images/Test4_2/Mecanique/assemblage5.png" alt="assemblage" class="image-small"/>
                <img src="images/Test4_2/Mecanique/assemblage4.png" alt="assemblage" class="image-small"/>
                <img src="images/Test4_2/Mecanique/assemblage6.png" alt="assemblage" class="image-mean"/>
                <p>
                  <a href="https://github.com/TekBot-Robotics-Challenge/2025-Team-B2MS_CleanTech-Docs/raw/refs/heads/main/Test4_2/Mecanique/Assemblage.SLDASM" download class="download-link">t√©l√©charger le convoyeur assembl√©</a>
                </p> 
              </div>

            <p class="txt_center">
              T√©l√©charger l'ensemble(pi√®ces et assemblages) <a href="https://github.com/TekBot-Robotics-Challenge/2025-Team-B2MS_CleanTech-Docs/raw/refs/heads/main/Test4_2/Mecanique/B2MS_convoyeur_CAO.rar" download class="download-link">ici</a>
            </p> 

          <h4 id="4-meca2">4. R√©alisation</h4>
           <p>
            Les pi√®ces en plastique n√©cessaires au montage ont √©t√© mod√©lis√©es puis imprim√©es √† l‚Äôaide d‚Äôune imprimante 3D.
           </p>
           <div class="image-container">
              <img src="images/Test4_2/Mecanique/impression3d1.jpg" alt="impression" class="image-small"/>
              <img src="images/Test4_2/Mecanique/impression3d2.jpg" alt="impression" class="image-small"/>
            </div>

            <video controls width=30%>
              <source src="videos/Test4_2/Mecanique/impression3d1.mp4" type="video/mp4">
              Votre navigateur ne supporte pas la vid√©o HTML5.
            </video>
            <video controls width=30%>
              <source src="videos/Test4_2/Mecanique/impression3d2.mp4" type="video/mp4">
              Votre navigateur ne supporte pas la vid√©o HTML5.
            </video>

           <p>
            Le bois a √©t√© d√©coup√© en respectant les dimensions d√©finies sur SolidWorks, garantissant une structure pr√©cise.
            Pour la fabrication du tapis roulant, un textile utilis√© habituellement pour les sacs a √©t√© choisi, assurant une bonne r√©sistance.
           </p>
           <div class="image-container">
              <img src="images/Test4_2/Mecanique/realisation_piece1.jpg" alt="realisation_piece" class="image-small"/>
              <img src="images/Test4_2/Mecanique/realisation_piece2.jpg" alt="realisation_piece" class="image-small"/>
              <img src="images/Test4_2/Mecanique/montage1.png" alt="realisation_conv" class="image-mean"/>
              <img src="images/Test4_2/Mecanique/montage2.jpg" alt="realisation_conv" class="image-mean"/>
              <img src="images/Test4_2/Mecanique/realisation_conv2.jpg" alt="realisation_conv" class="image-small"/>
            </div>
   
            <p>
              Cette m√©thode a permis d‚Äôobtenir des composants parfaitement adapt√©s au syst√®me.
            L'ensemble a √©t√© assembl√© avec soin pour assurer la stabilit√© et la fonctionnalit√© du convoyeur.
            </p>

            <div class="image-container">
              <img src="images/Test4_2/Mecanique/conv1.png" alt="realisation_conv" class="image-mean"/>
              <img src="images/Test4_2/Mecanique/conv2.jpg" alt="realisation_conv" class="image-mean"/>
            </div>

        </div>

        <div id="electronique2" class="subtab-content">
          <h2 id="electro2" class="projet-titre">Partie √©lectronique</h2>
          <h3 id="1-electro2">1. Cahier de charge</h3>
            <p>
            Dans le cadre d‚Äôun projet final en syst√®mes embarqu√©s, le but est de concevoir un <strong>syst√®me automatis√© de tri de d√©chets</strong> 
            inspir√© des proc√©d√©s industriels de recyclage.
            </p> 
            
            <h4>a. Objectifs fonctionnels</h4>
              <ul>
                <li>D√©tecter la pr√©sence d‚Äôun objet/d√©chet sur la bande.</li>
                <li>Mettre en mouvement la bande uniquement si un d√©chet est d√©tect√©.</li>
                <li>D√©tecter la couleur de l‚Äôobjet (cube) en mouvement.</li>
                <li>Afficher la couleur via une LED RGB.</li>
                <li>Transmettre la couleur d√©tect√©e √† une interface web via Wi-Fi.</li>
              </ul>

            <h4>b. Contraintes techniques</h4>
              <ul>
                <li>Alimentation sur 3 piles Li-ion 3,7V (‚âà11,1V).</li>
                <li>Conversion de tension via module buck MP2307 vers 5V.</li>
                <li>Circuit centr√© sur une Arduino Nano.</li>
                <li>Capteurs aliment√©s en 5V.</li>
                <li>Utilisation minimale de composants externes (driver moteur simple par MOSFET). </li>
              </ul>

            <h4>c. Composants utilis√©s</h4>
              <table border="2" cellspacing="1" cellpadding="6">
                <tbody>
                  <tr>
                    <td><strong>Arduino Nano</strong></td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td><strong>Capteur √† ultrasons HC-SR04</strong></td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td><strong>Capteur de couleur TCS230</strong></td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td><strong>Capteur infrarouge</strong></td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td><strong>LED RGB</strong></td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td><strong>Moteur DC 6-12V</strong></td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td><strong>Module WiFi (ESP-01)</strong></td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td><strong>MOSFET canal N (IRFZ44N)</strong></td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td><strong>R√©gulateur buck MP2307</strong></td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td><strong>Boutons poussoirs</strong></td>
                    <td>2</td>
                  </tr>
                  <tr>
                    <td><strong>Interrupteur</strong></td>
                    <td>1</td>
                  </tr>                 
                  <tr>
                    <td><strong>Diode de roue libre (1N4007)</strong></td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td><strong>R√©sistances, c√¢blage</strong></td>
                    <td>-</td>
                  </tr>
                </tbody>
            </table>

          <h3 id="2-electro2">2. Sch√©ma synoptique</h3>
            <div class="image-container">
              <img src="images/Test4_2/Electronique/schema_synoptique.png" alt="schema_synoptique" class="image-mean"/>
            </div>
    
          <h3 id="3-electro2">3. Description fonctionnelle des blocs</h3>
             <h4>a. Le microcontr√¥leur(Arduino Nano)</h4>
              <p>
                L'Arduino Nano est une carte microcontr√¥leur compacte et polyvalente bas√©e sur l'ATmega328P. 
                Ses broches et ses caract√©ristiques techniques lui conf√®rent de nombreuses fonctionnalit√©s.
              </p>

              <p>
                Il constitue le c≈ìur de notre syst√®me. 
                C‚Äôest lui qui re√ßoit l‚Äôensemble des donn√©es issues des capteurs et qui pilote les diff√©rents actionneurs : 
                l‚Äô√©clairage <strong>RGB</strong>, le <strong>moteur</strong> (pour le d√©marrage et l‚Äôarr√™t du tapis), ainsi que les <strong>boutons</strong> de mise en marche et d‚Äôarr√™t du syst√®me.
                Sans ce composant central, aucun fonctionnement n‚Äôest possible.
              </p>
              <p>
                Son fonctionnement repose sur un programme √©crit en langage C, sp√©cifiquement con√ßu pour coordonner tous les √©l√©ments du syst√®me.
              </p>
              <p>
                Dans la suite du document, nous d√©taillerons le code ainsi que le sch√©ma de c√¢blage, en pr√©cisant √† quelles broches de l‚ÄôArduino Nano chaque capteur ou composant est connect√©.
              </p>
              <div class="image-container">
                <img src="images/Test4_2/Electronique/arduino_nano.png" alt="nano" class="image-mean"/>
              </div>

              <ul>
                <strong>Quelques caract√©ristiques:</strong>
              </ul>
              <table border="2" cellspacing="1" cellpadding="6">
                <thead>
                  <tr>
                    <th></th>
                    <th>R√¥les</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><strong>Vin, 5V, 3.3V</strong></td>
                    <td>Alimentation</td>
                  </tr>
                  <tr>
                    <td><strong>Reset</strong></td>
                    <td>R√©initialisation du microcontr√¥leur.</td>
                  </tr>
                  <tr>
                    <td><strong>Broches analogiques(A0 ‚Äì A7)</strong></td>
                    <td>Entr√©e analogique</td>
                  </tr>
                  <tr>
                    <td><strong>Broches num√©riques (D0 ‚Äì D13)</strong></td>
                    <td>Entr√©e/Sortie num√©rique uniquement</td>
                  </tr>
                  <tr>
                    <td><strong>S√©rie (Rx, Tx)</strong></td>
                    <td>Transmission et la r√©ception de donn√©es s√©rie TTL</td>
                  </tr>
                  <tr>
                    <td><strong>PWM (3, 5, 6, 9, 11)</strong></td>
                    <td>Sortie PWM 8 bits</td>
                  </tr>
                  <tr>
                    <td><strong>SPI (10, 11, 12, 13)</strong></td>
                    <td>Communication SPI</td>
                  </tr>
                </tbody>
              </table>

            <h4>b. Bloc d'alimentation</h4>
              <p>
                Le syst√®me est aliment√© par <strong>trois batteries Li-Ion 3.7V</strong> mont√©es en s√©rie (tension totale ‚âà11.1V). 
                Cette tension alimente directement le moteur via le circuit MOSFET. 
                Pour alimenter les composants √©lectroniques en 5V, un <strong>module buck MP2307</strong> est utilis√©. 
                Ce module convertit efficacement la tension 11.1V vers 5V avec un bon rendement.
              </p>
              <div class="image-container">
                <img src="images/Test4_2/Electronique/alimentation.png" alt="bloc_alimentation" class="image-mean"/>
                <img src="images/Test4_2/Electronique/buck.jpg" alt="bloc_alimentation" class="image-small"/>
              </div>
              <p>
                <ul>
                  <li><strong>Avantages du MP2307</strong>: faible √©chauffement, grande stabilit√©, courant jusqu‚Äô√† 2A. </li>
                </ul>
              </p>

              <h4>c. Les capteurs</h4>
              <h5>&#10022; Capteur √† ultrasons (HC-SR04)</h5>
                <p>
                  Le capteur √† ultrasons d√©termine la distance d‚Äôun objet par rapport √† sa position.
                  Il g√©n√®re un signal √† bande √©troite √† une fr√©quence de 40 kHz et capte le signal r√©fl√©chi(√©cho). 
                  Sur la base du temps de propagation du son vers et depuis l‚Äôobjet, la distance (en centim√®tres) peut √™tre d√©termin√©e assez pr√©cis√©ment.
                  Ce capteur permet donc de d√©tecter la pr√©sence d'une pi√®ce tout le long du convoyeur.                 
                </p>
                <div class="image-container">
                  <img src="images/Test4_2/Electronique/ultrasonic.jpg" alt="Ultrason" class="image-mean"/>
                </div>

                <p>
                  <ul>
                    <li>
                      <strong>TRIG</strong>(OUTPUT) envoie une impulsion √©lectrique de 10 microsecondes pour d√©clencher la mesure. 
                      Cette impulsion commande au capteur d‚Äô√©mettre une onde ultrasonore.
                    </li>
                    <li>
                      <strong>Echo</strong>(INPUT) re√ßoit l‚Äôonde ultrasonore r√©fl√©chie par un objet et passe √† l‚Äô√©tat HAUT pendant une dur√©e proportionnelle √† la distance mesur√©e. 
                      Cette dur√©e est utilis√©e pour calculer la distance entre le capteur et l‚Äôobjet.
                    </li>
                  </ul>
                </p>

                <div class="image-container">
                  <img src="images/Test4_2/Electronique/circuit_ultrason.png" alt="Ultrason" class="image-mean"/>
                </div>
                
                <div class="code-container">
                  <p>code_ultrasonic.ino </p>
                  <div class="btn-bar">
                    <button onclick="copierCode('code_ultrasonic-ino', this)">üìã</button>
                    <button onclick="telechargerCode('code_ultrasonic-ino', 'code_ultrasonic.ino', 'text/ino', this)">ü°á</button>
                  </div>
                  <pre><code id="code_ultrasonic-ino">
    #define trigPin 5 // D√©finir la broche 2 pour le Trig
    #define echoPin 6 // D√©finir la broche 3 pour l'Echo

    long distance = 0;  //stocke la distance calcul√©e

    void setup() {
      pinMode(trigPin, OUTPUT); // Configurer trigPin en sortie
      pinMode(echoPin, INPUT); // Configurer echoPin en entr√©e
      Serial.begin(9600); // Initialiser la communication s√©rie √† 9600 bauds
    }

    void loop() {
      distance = getDistance(); 

      // Afficher la distance sur le moniteur s√©rie
      Serial.print("Distance: ");
      Serial.print(distance);
      Serial.println(" cm");

      delay(1000); // Attendre 1 seconde avant de refaire une lecture
    }

    long getDistance() {
      // Envoyer une impulsion de 10 ¬µs pour d√©clencher le capteur
      digitalWrite(trigPin, LOW);
      delayMicroseconds(2);
      digitalWrite(trigPin, HIGH);
      delayMicroseconds(10);
      digitalWrite(trigPin, LOW);

      // Mesurer la dur√©e de l'√©cho
      long duration = pulseIn(ECHO_PIN, HIGH);
      
      // Calculer la distance en cm
      long distance = (duration / 2) * 0.0344;  // Vitesse du son = 0.0344 cm/¬µs
      
      return distance;
    }
                </code></pre>
              </div>

              <h5>&#10022; Capteur infrarouge</h5>
                <p>
                  Plac√© en bout de convoyeur, √† une distance ad√©quate, il <strong>√©met un faisceau infrarouge</strong> √† courte port√©e √† l‚Äôaide d‚Äôune LED de 940 nm. 
                  Lorsqu‚Äôun objet s‚Äôapproche, la lumi√®re infrarouge est partiellement <strong>r√©fl√©chie vers un r√©cepteur photo√©lectrique int√©gr√©</strong>. 
                  Cette variation de lumi√®re permet au module de g√©n√©rer un signal num√©rique indiquant la pr√©sence ou l'absence d‚Äôun obstacle.
                </p>
                <p>
                  Compatible avec une alimentation de 3,3 V √† 5 V et consommant jusqu‚Äô√† 100 mA, le capteur s‚Äôadapte √† la plupart des microcontr√¥leurs. 
                  Il fonctionne √† une fr√©quence de 38 kHz, limitant les interf√©rences dues √† la lumi√®re ambiante, et peut op√©rer dans des temp√©ratures allant de -25 ¬∞C √† +55 ¬∞C.
                  Sa robustesse et sa pr√©cision en font un composant essentiel pour assurer un arr√™t pr√©cis du convoyeur en fin de cycle.
                </p>
                
                <p>
                  <strong>NB:</strong> le potentiom√®tre int√©gr√© permet d'ajuster la plage de d√©tection du module.
                </p>
                <div class="image-container">
                  <img src="images/Test4_2/Electronique/infrared.png" alt="infrared" class="image-mean"/>
                </div>

                <ul>
                  <strong>Sortie logique: </strong>
                  <li><strong>HIGH</strong> = objet d√©tect√©</li>
                  <li><strong>LOW</strong> = pas d‚Äôobjet</li>
                </ul>

                <p>
                  Ce capteur infrarouge est utilis√© pour d√©tecter l‚Äôarriv√©e d‚Äôune pi√®ce en fin de convoyage et d'arr√™ter le moteur. 
                </p>

                <div class="image-container">
                  <img src="images/Test4_2/Electronique/circuit_infrared.png" alt="infrared" class="image-mean"/>
                </div>

                <div class="code-container">
                  <p>code_infrarouge.ino </p>
                  <div class="btn-bar">
                    <button onclick="copierCode('code_infrarouge-ino', this)">üìã</button>
                    <button onclick="telechargerCode('code_infrarouge-ino', 'code_infrarouge.ino', 'text/ino', this)">ü°á</button>
                  </div>
                  <pre><code id="code_infrarouge-ino">
    #define infraredSensor 19

    int infraredValue = 0; //stocke la valeur du capteur infrarouge

    void setup(){
        pinMode(infraredSensor, INPUT);
        Serial.begin(9600);
    }

    void loop(){
        infraredValue = digitalRead(infraredSensor);
        // affichage sur le moniteur
        Serial.print(" Valeur du capteur: ");
        Serial.println(infraredValue);
        delay(500);
    }
                </code></pre>
              </div>

              <h5>&#10022; Le capteur de couleur TCS230/TCS3200</h5>
                <p>
                  Le capteur de couleur TCS230 (ou TCS3200) est un dispositif optique capable de d√©tecter la couleur dominante d‚Äôun objet. 
                  Il fonctionne en convertissant l‚Äôintensit√© lumineuse de la couleur per√ßue en un signal carr√© dont <strong>la fr√©quence varie selon la couleur d√©tect√©e</strong>.
                  Ce capteur est plus fiable et performant que le capteur de couleur 
                  <a href="https://www.mouser.com/datasheet/2/321/28380-ColorPAL-Documentation-370265.pdf?srsltid=AfmBOoqGq8vwQaI62oqMLZm4TdE2iRID73yldqJOA6wBk9wV9HYMWR5j" target="_blank"><strong>ColorPal</strong></a> utilis√© initialement.
                </p>
                <ul>
                  &#9673; <strong>Fonctionnement:</strong>
                  <li>
                    Le capteur est compos√© d'une matrice de 8√ó8 photodiodes, soit 64 au total: 3x16 photodiodes sensibles au rouge, vert, bleu, et 16 photodiodes sans filtre(blanc). 
                  </li>
                  <li>
                    Les photodiodes sont s√©lectionn√©es via les broches <strong>S2</strong> et <strong>S3</strong>, permettant de choisir la composante de couleur √† mesurer (R, G ou B).
                  </li>
                  <li>La sortie du capteur est fournie sur la broche <strong>OUT</strong>, sous forme d‚Äôun signal carr√© dont <strong>la fr√©quence est proportionnelle √† l‚Äôintensit√© de la couleur mesur√©e</strong>.</li>
                </ul>

                <ul>
                  &#9673; <strong>Brochage:</strong>
                  <table border="2" cellspacing="1" cellpadding="6">
                    <thead>
                      <tr>
                        <th>Pin</th>
                        <th>R√¥le</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td><strong>VCC</strong></td>
                        <td>Alimentation(2.7-5.5V)</td>
                      </tr>
                      <tr>
                        <td><strong>GND</strong></td>
                        <td>Masse</td>
                      </tr>
                      <tr>
                        <td><strong>S0, S1</strong></td>
                        <td>Selection de l'√©chelle de fr√©quence de sortie</td>
                      </tr>
                      <tr>
                        <td><strong>S2, S3</strong></td>
                        <td>Selection du type de photodiode</td>
                      </tr>
                      <tr>
                        <td><strong>Out</strong></td>
                        <td>Sortie de fr√©quence</td>
                      </tr>
                      <tr>
                        <td><strong>OE</strong></td>
                        <td>Activer la sortie(actif bas)</td>
                      </tr>
                    </tbody>
                  </table>
                </ul>

                <ul>
                  &#9673; <strong>Utilisation avec un Arduino:</strong>
                  <li>
                    Lorsqu‚Äôun objet est plac√© devant le capteur, celui-ci mesure la lumi√®re r√©fl√©chie par l‚Äôobjet pour chaque composante de couleur (rouge, vert, bleu).
                  </li>
                  <li>
                    Le capteur envoie ensuite les fr√©quences mesur√©es √† l‚ÄôArduino, qui les analyse pour d√©terminer la couleur dominante.
                  </li>
                </ul>

                <div class="image-container">
                  <img src="images/Test4_2/Electronique/capteur_couleur.jpg" alt="capteur_couleur" class="image-mean"/>
                </div>
                
                <!-- <div class="image-container">
                  <img src="images/Test4/Electronique/circuit_sensorColor.png" alt="capteur_couleur" class="image-mean"/>
                </div> -->
                
                <div class="code-container">
                  <p>code_tcs230.ino </p>
                  <div class="btn-bar">
                    <button onclick="copierCode('code_tcs230-ino', this)">üìã</button>
                    <button onclick="telechargerCode('code_tcs230-ino', 'code_tcs230.ino', 'text/ino', this)">ü°á</button>
                  </div>
                  <pre><code id="code_tcs230-ino">
    // D√©finir les broches du capteur
    #define S0 2
    #define S1 3
    #define S2 4
    #define S3 5
    #define sensorOut 7


    void setup() {
      Serial.begin(9600); // Initialiser la communication s√©rie √† 9600 bauds
      pinMode(S0, OUTPUT); // D√©finir S0 comme sortie
      pinMode(S1, OUTPUT); // D√©finir S1 comme sortie
      pinMode(S2, OUTPUT); // D√©finir S2 comme sortie
      pinMode(S3, OUTPUT); // D√©finir S3 comme sortie
      pinMode(sensorOut, INPUT); // D√©finir sensorOut comme entr√©e


      // Configurer l'√©chelle de fr√©quence √† 20%
      digitalWrite(S0, HIGH);
      digitalWrite(S1, LOW);
    }

    void loop() {
      printColorFrequency();
      delay(500); // Attendre 500 ms avant la prochaine lecture
    }

    void printColorFrequency() {
      // Lire la valeur de la couleur rouge
      digitalWrite(S2, LOW); // Activer les photodiodes rouges
      digitalWrite(S3, LOW);
      int redFrequency = pulseIn(sensorOut, LOW); // Lire la fr√©quence de sortie pour le rouge
      Serial.print("Red: ");
      Serial.print(redFrequency);
      Serial.print("  ");


      // Lire la valeur de la couleur verte
      digitalWrite(S2, HIGH); // Activer les photodiodes vertes
      digitalWrite(S3, HIGH);
      int greenFrequency = pulseIn(sensorOut, LOW); // Lire la fr√©quence de sortie pour le vert
      Serial.print("Green: ");
      Serial.print(greenFrequency);
      Serial.print("  ");


      // Lire la valeur de la couleur bleue
      digitalWrite(S2, LOW); // Activer les photodiodes bleues
      digitalWrite(S3, HIGH);
      int blueFrequency = pulseIn(sensorOut, LOW); // Lire la fr√©quence de sortie pour le bleu
      Serial.print("Blue: ");
      Serial.println(blueFrequency);
    }   
                </code></pre>
              </div>             

              <h4>d. Module Wi-Fi ESP01</h4>
                <p>
                  Le module Wi-Fi ESP8266, version ESP-01, permet aux microcontr√¥leurs de se connecter √† un r√©seau Wi-Fi. 
                  Dans notre projet, il est principalement utilis√© pour communiquer avec une <strong>interface web</strong> et transmettre des informations(la couleur detect√©e et l'√©tat du syst√®me).
                </p>
                <p>
                  <h5>&#10022; Configuration de l‚ÄôIDE Arduino pour l‚ÄôESP8266</h5>
                  Pour utiliser l‚ÄôESP8266 avec l‚ÄôIDE Arduino, il faut suivre les √©tapes suivantes :
                  <ul>
                    <li>Ajouter le support de la carte ESP8266: ajouter l‚ÄôURL(http://arduino.esp8266.com/stable/package_esp8266com_index.json) de la source ESP8266 dans les pr√©f√©rences de l‚ÄôIDE</li>
                    <li>Installer le package logiciel: rechercher et installer la biblioth√®que <strong>ESP8266</strong></li>
                    <li>S√©lectionner la carte: choisir "Generic ESP8266 Module"</li>
                  </ul>
                </p>

                  <h5>&#10022; Brochage de l‚ÄôESP-01 (ESP8266-01)</h5>
                  <table border="2" cellspacing="1" cellpadding="6">
                  <thead>
                    <tr>
                      <th></th>
                      <th>R√¥les</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><strong>VCC</strong></td>
                      <td>Alimentation(<strong>3.3V</strong>)</td>
                    </tr>
                    <tr>
                      <td><strong>GND</strong></td>
                      <td>Masse</td>
                    </tr>
                    <tr>
                      <td><strong>TX</strong></td>
                      <td>Transmission de donn√©es</td>
                    </tr>
                    <tr>
                      <td><strong>RX</strong></td>
                      <td>R√©ception de donn√©es</td>
                    </tr>
                    <tr>
                      <td><strong>CH_PD / EN</strong></td>
                      <td>Activation du module</td>
                    </tr>
                    <tr>
                      <td><strong>Reset</strong></td>
                      <td>R√©initialisation du module</td>
                    </tr>
                    <tr>
                      <td><strong>GPIO0 et GPIO2</strong></td>
                      <td>Broches d‚Äôentr√©e/sortie num√©riques</td>
                    </tr>
                  </tbody>
                </table>
              <div class="image-container">
                <img src="images/Test4_2/Electronique/module_wifi.jpg" alt="module_wifi" class="image-small"/>
              </div>

              <p class="txt_center">
                <strong>NB:</strong> ce module n'est pas encore int√©gr√© dans cette documentation √† cause de probl√®mes de communication avec l'interface.
                La communication se fera alors par cable USB pour le moment.
              </p>

              <h4>e. Bloc de sortie</h4>
              <h5>&#10022; Moteur</h5>
                <p>
                  Le <strong>moteur √† courant continu</strong> (DC) 6‚Äì12 V est utilis√© pour entra√Æner le tapis du convoyeur. 
                  Il assure le d√©placement des objets d√©tect√©s gr√¢ce √† son couple adapt√© aux applications de petite puissance. 
                  Son alimentation est assur√©e par une source externe(12 V), 
                  tandis que sa mise en marche est command√©e √©lectroniquement.
                </p>
                <p>
                  Pour contr√¥ler le moteur, un transistor <strong>MOSFET canal N</strong> est utilis√© comme interrupteur √©lectronique. 
                  Ce composant permet de g√©rer l‚Äôalimentation du moteur en fonction du signal envoy√© par la carte Arduino. 
                  Une diode de roue libre est plac√©e en parall√®le du moteur afin de prot√©ger le circuit contre les surtensions transitoires g√©n√©r√©es lors de l‚Äôarr√™t du moteur, dues √† l‚Äôinduction.
                </p>
                <p>
                  La commande du moteur se fait via une broche <strong>PWM</strong> de l‚ÄôArduino connect√©e √† la grille du MOSFET. 
                  En faisant varier le rapport cyclique du signal PWM, il est possible d'<strong>ajuster la vitesse de rotation</strong> du moteur, et donc la vitesse du convoyeur. 
                  Un signal √† rapport cyclique √©lev√© entra√Æne une rotation rapide, tandis qu‚Äôun rapport plus faible r√©duit la vitesse du moteur.
                </p>
                <p>
                  Ainsi, le syst√®me est plus optimis√© et ne d√©pend plus d'un 
                  <a href="https://www.handsontec.com/dataspecs/L298N%20Motor%20Driver.pdf" download target="_blank">moteur driver</a>.
                </p>

                <div class="image-container">
                  <img src="images/Test4_2/Electronique/mosfet.jpg" alt="Moteur" class="image-small"/>
                  <img src="images/Test4_2/Electronique/moteur_dc.jpg" alt="Moteur" class="image-small"/>
                  <img src="images/Test4_2/Electronique/commande_moteur1.png" alt="Moteur" class="image-mean"/>
                </div>

                <div class="code-container">
                  <p>code_moteur.ino </p>
                  <div class="btn-bar">
                    <button onclick="copierCode('code_moteur-ino', this)">üìã</button>
                    <button onclick="telechargerCode('code_moteur-ino', 'code_moteur.ino', 'text/ino', this)">ü°á</button>
                  </div>
                  <pre><code id="code_moteur-ino">
    #define pinMotor 3

    void setup () {
        pinMode(pinMotor, OUTPUT);
    }

    void loop() {
        analogWrite(pinMotor, 100);
        delay(2000);
        analogWrite(pinMotor, 0);
        delay(5000);
    }
                </code></pre>
              </div>

              <video controls width=50%>
                <source src="videos/Test4_2/Electronique/moteur1.mp4" type="video/mp4">
                Votre navigateur ne supporte pas la vid√©o HTML5.
              </video>

              <h4>&#10022; Led RGB</h4>
                <p>
                  La LED RGB affiche la couleur d√©tect√©e(rouge, bleu, vert, jaune).
                </p>
                <p>
                  Le signal PWM est utilis√© pour moduler l‚Äôintensit√© de chaque couleur et ainsi permettre le m√©lange des couleurs. 
                  Les broches de la LED doivent donc √™tre connect√©es √† des pins compatibles PWM.
                </p>

                <p>
                  Elle peut aussi indiquer l'√©tat du convoyeur(en marche ou √† l'arr√™t).
                </p>

                <div class="image-container">
                  <img src="images/Test4_2/Electronique/led.png" alt="LED" class="image-mean"/>
                  <p>Led RGB √† anode commun</p>
                </div>

                <div class="image-container">
                  <img src="images/Test4_2/Electronique/circuit_led.png" alt="LED" class="image-mean"/>
                </div>

                <div class="code-container">
                  <p>code_led.ino </p>
                  <div class="btn-bar">
                    <button onclick="copierCode('code_led-ino', this)">üìã</button>
                    <button onclick="telechargerCode('code_led-ino', 'code_led.ino', 'text/ino', this)">ü°á</button>
                  </div>
                  <pre><code id="code_led-ino">
    #define LED_R 9
    #define LED_G 10
    #define LED_B 11

    void setup() {
      pinMode(LED_R, OUTPUT);
      pinMode(LED_G, OUTPUT);
      pinMode(LED_B, OUTPUT);
    }

    void loop() {
      setColor(100, 0, 0); //rouge
      delay(2000);
      setColor(0, 100, 0); //vert
      delay(2000);
      setColor(0, 0, 100); //bleu
      delay(2000);
      setColor(100, 100, 0); //jaune
      delay(2000);
    }

    void setColor(unsigned int red, unsigned int green, unsigned int blue) {
      red = map(red, 0, 255, 255, 0);
      green = map(green, 0, 255, 255, 0);
      blue = map(blue, 0, 255, 255, 0);
      analogWrite(LED_R, red);
      analogWrite(LED_G, green);
      analogWrite(LED_B, blue);
    }
                </code></pre>
              </div>

              <video controls width=50%>
                <source src="videos/Test4_2/Electronique/led_rgb.mp4" type="video/mp4">
                Votre navigateur ne supporte pas la vid√©o HTML5.
              </video>

              <p class="txt_center">
                <strong>NB:</strong> Utiliser des r√©sistances pour prot√©ger la led. 
                Ici, nous avons utilis√© des r√©sistances de <strong>270 &ohm;</strong> pour chaque pin RGB.
              </p>

              <h4>f. Bloc de commande</h4>
                <p>
                  Un <strong>interrupteur</strong> a √©t√© install√© pour permettre √† l'utilisateur de mettre sous tension ou de couper le courant.
                </p>
                <p>
                  Par ailleurs, deux <strong>boutons-poussoirs</strong> sont pr√©vus pour commander la mise en marche et l'arr√™t du convoyeur.
                  <ul>
                    <li>
                      <strong>Bouton Start</strong>(connect√© au pin 7 de l'Arduino): permet d'activer le syst√®me.
                    </li>
                    <li>
                      <strong>Bouton Stop</strong>(connect√© au pin 2 de l'Arduino): permet de d√©sactiver le syst√®me √† l'aide 
                      d'<a href="https://docs.arduino.cc/language-reference/en/functions/external-interrupts/attachInterrupt/" download target="_blank">interruption</a>
                      , assurant ainsi un arr√™t rapide et r√©actif.
                    </li>
                  </ul>
                </p>


                <div class="image-container">
                  <img src="images/Test4_2/Electronique/boutons_poussoirs.png" alt="boutons_poussoirs" class="image-mean"/>
                  <p>
                    <strong>NB:</strong> Nous utilisons les r√©sistances 
                    <a href="https://docs.arduino.cc/tutorials/generic/digital-input-pullup/" download target="_blank">pull-up internes</a> 
                    afin d‚Äôoptimiser l‚Äôutilisation du mat√©riel.</p>
                </div>

                <div class="code-container">
                  <p>code_bp.ino </p>
                  <div class="btn-bar">
                    <button onclick="copierCode('code_bp-ino', this)">üìã</button>
                    <button onclick="telechargerCode('code_bp-ino', 'code_bp.ino', 'text/ino', this)">ü°á</button>
                  </div>
                  <pre><code id="code_bp-ino">
    const byte pinStart = 7;
    const byte pinStop = 2; 
    const byte ledPin = 12;
    volatile bool blinking = false;
    unsigned long lastInterrupt = 0;

    void setup() {
      pinMode(ledPin, OUTPUT);
      // boutons poussoirs
      pinMode(pinStart, INPUT_PULLUP);
      pinMode(pinStop, INPUT_PULLUP);
      attachInterrupt(digitalPinToInterrupt(pinStop), interrupt_routine, FALLING);

      digitalWrite(ledPin, LOW); // √©teint la led initialement
    }

    void loop() {
      if(!blinking){
        while(digitalRead(pinStart)){ //tant qu'on n'appuie pas sur btnStart, la boucle continue
          delay(10);
        }
        blinking = true;
      }

      else{
        digitalWrite(ledPin, HIGH);
        delay(300);
        digitalWrite(ledPin, LOW);
        delay(300);
      }
    }

    void interrupt_routine() {
      unsigned long currentMillis = millis();
      if (currentMillis - lastInterrupt > 100) { // anti-rebond de 100 ms
        digitalWrite(ledPin, LOW);
        blinking = false;
        lastInterrupt = currentMillis;
      }
    }
                </code></pre>
              </div>

              <!-- <video controls width=50%>
                <source src="videos/Test4/Electronique/boutons_poussoirs.mp4" type="video/mp4">
                Votre navigateur ne supporte pas la vid√©o HTML5.
              </video> -->
              
          <h3 id="4-electro2">4. Tests et validation</h3>
            <p>
              Apr√®s avoir pris en main chaque composant, il est temps de r√©aliser un test global du syst√®me √©lectrique.
            </p>
            <p>
              Nous avons r√©alis√© les branchements sur un breadboard puis le circuit sur veroboard pour les tests afin de s'assurer que chaque composant s'integre au syst√®me electronique.
            </p>
            <p>Voici quelques uns de ces test:</p>
            <ul>
              <li>Test du capteur de couleur avec la led RGB:</li>
                <video controls width=50%>
                  <source src="videos\Test4_2\Electronique\sensorColor_rgb.mp4" type="video/mp4">
                  Votre navigateur ne supporte pas la vid√©o HTML5.
                </video>

              <li>V√©rification de l‚Äôalimentation et du pilotage du moteur avec le circuit c√¢bl√© sur veroboard.</li>
                <video controls width=50%>
                  <source src="videos/Test4_2/Electronique/moteur2.mp4" type="video/mp4">
                  Votre navigateur ne supporte pas la vid√©o HTML5.
                </video>
            </ul>

            
          <h3 id="5-electro2">5. R√©alisation du PCB</h3>
            <p>
              Apr√®s avoir effectu√© tous les tests, nous avons r√©alis√© un PCB sur Kicad comme suit:
            </p>
            <div class="image-container">
              <img src="images/Test4_2/Electronique/pcb1.png" alt="pcb" class="image-mean" />
              <p>
                Conception du sch√©ma √©lectronique.
              </p>
            </div>

            <p>
              Nous avons d√©cid√© par la suite de rassembler les <strong>Vcc</strong> et <strong>GND</strong> pour les capteurs, la led et les boutons poussoirs afin de faciliter les branchements.
            </p>
            <div class="image-container">
              <img src="images/Test4_2/Electronique/pcb2.png" alt="pcb" class="image-mean" />
              <p>
                Conception du sch√©ma pour le pcb.
              </p>
            </div>
            
            <div class="image-container">
              <img src="images/Test4_2/Electronique/pcb3.png" alt="pcb" class="image-mean" />
              <p>
                Attribution des empreintes.
              </p>
            </div>
        
            <div class="image-container">
              <img src="images/Test4_2/Electronique/pcb4.png" alt="pcb" class="image-mean" />
              <p>
                Verificaton des erreurs (DRC)
              </p>
            </div>
            
            <div class="image-container">
              <img src="images/Test4_2/Electronique/pcb5.png" alt="pcb" class="image-small" />
              <p>
                Ajustement de la disposition et routage des pistes.
              </p>
            </div>


            <div class="image-container">
              <img src="images/Test4_2/Electronique/pcb6.png" alt="pcb" class="image-small" />
              <p>
                Plan de masse GND et ajout des textes pour les diff√©rents composants et pins.
              </p>
            </div>

            <div class="image-container">
              <img src="images/Test4_2/Electronique/pcb7.png" alt="pcb" class="image-small" />
              <img src="images/Test4_2/Electronique/pcb8.png" alt="pcb" class="image-small" />
              <p>
                Ajout des models 3D(arduino nano et serre-fils).
              </p>
            </div>

            <div class="image-container">
              <img src="images/Test4_2/Electronique/pcb9.png" alt="pcb" class="image-mean" />
              <p>
                Visualisation 3D
              </p>
            </div>

            <p class="txt_center">
              <a href="https://github.com/TekBot-Robotics-Challenge/2025-Team-B2MS_CleanTech-Docs/raw/refs/heads/main/Test4_2/Electronique/convoyeur_pcb.rar" class="download-link">t√©l√©charger les fichiers du PCB</a>
            </p>

          <h3 id="6-electro2">6. Prototype final</h3>
            <p>
              Apr√®s les tests sur le breadboard et la conception du PCB, il est temps de r√©aliser le circuit final.
              Nous utilisons ici un veroboard, tout en respectant les pins utilis√©es dans la conception du PCB.
            </p>
            <p>
              <strong>NB:</strong> Nous avons retravaill√© notre circuit pour r√©pondre aux exigences techniques et esth√©tiques.
            </p>
            <div class="image-container">
              <img src="images\Test4_2\Electronique\circuit0.jpg" alt="circuit" class="image-mean"/>
              <p>
                Comparatif des deux prototypes
              </p>
            </div>

            <div class="image-container">
              <p>
                Prototype final adopt√©:
              </p>
              <img src="images\Test4_2\Electronique\circuit1.jpg" alt="circuit" class="image-small"/>
              <img src="images\Test4_2\Electronique\circuit5.jpg" alt="circuit" class="image-small"/>
              <img src="images\Test4_2\Electronique\circuit6.jpg" alt="circuit" class="image-small"/>
              <img src="images\Test4_2\Electronique\circuit7.jpg" alt="circuit" class="image-small"/>

              <img src="images\Test4_2\Electronique\circuit2.jpg" alt="circuit" class="image-small"/>
              <img src="images\Test4_2\Electronique\circuit3.jpg" alt="circuit" class="image-small"/>
              <img src="images\Test4_2\Electronique\circuit4.jpg" alt="circuit" class="image-small"/>
              <img src="images\Test4_2\Electronique\circuit9.jpg" alt="circuit" class="image-small"/>
            </div>
        </div>

        <div id="informatique2" class="subtab-content">
          <h2 id="info2" class="projet-titre">Partie informatique</h2>
          <h3 id="1-info2">1. D√©tection intelligente et automatisation</h3>
            <p>
              La d√©tection intelligente repose sur un syst√®me de reconnaissance de couleur embarqu√© utilisant le capteur <strong>ColorPAL</strong>, pilot√© par une carte <strong>Arduino Nano</strong>. 
              Ce syst√®me a pour mission d‚Äôidentifier la couleur d‚Äôun objet (repr√©sentant un type de d√©chet) √† son passage sur un tapis <strong>convoyeur automatis√©</strong>.
            </p>
              
            <ul>
              <strong>D√©tails</strong>
              <li>Initialement, le convoyeur est √† l'arr√™t.</li>
              <li>
                Un objet(cube) est pos√© sur le tapis.
              </li>
              <li>
                Le capteur de distance d√©tecte l'objet et le convoyeur d√©marre gr√¢ce au moteur.
              </li>
              <li>
                Lorsque l'objet passe dans la zone de d√©tection, le convoyeur s'arr√™te et le capteur de couleur s'active pour identifier la couleur de l'objet.
              </li>
              <li>
                Cette couleur, cod√©es sous forme de lettres majuscules (R, G, B, Y, U), est envoy√©e au serveur Python pour √™tre stock√©e et publi√©e sur l'interface web.
              </li>
              <li>La led RGB s'allume suivant la couleur detect√©e.</li>
              <li>
                Le convoyeur red√©marre et ne s'arr√™te que lorsque l'objet est en bout de course, determin√© par un capteur infrarouge √† la fin du convoyeur.
              </li>
            </ul>


            <div class="code-container">
              <p>code_convoyeur.ino</p>
              <div class="btn-bar">
                <button onclick="copierCode('code_convoyeur-ino', this)">üìã</button>
                <button onclick="telechargerCode('code_convoyeur-ino', 'code_convoyeur.ino', 'text/ino', this)">ü°á</button>
              </div>
              <pre><code id="code_convoyeur-ino">
    // boutons marche arr√™t & urgence
    #define pinStart 7
    #define pinStop = 2;

    // Contr√¥le moteur
    #define pinMotor 3

    // D√©finir les broches du capteur de couleur
    #define LED_R 9
    #define LED_G 10
    #define LED_B 11

    // capteur de couleur
    #define S0 14
    #define S1 15
    #define S2 16
    #define S3 17
    #define Out 18

    // capteur infrarouge
    #define infraredSensor 19

    // capteur Ultrason
    #define trigPin 5
    #define echoPin 6

    unsigned int redFrequency = 0, greenFrequency = 0, blueFrequency = 0, infraredValue = 0;
    const int nbEchantillon = 5;
    unsigned long distance = 0, lastInterrupt = 0;
    char color_detected = 'U';
    bool finTapis = true;
    volatile String state = "OFF";

    void setup()
    {
        pinMode(LED_R, OUTPUT);
        pinMode(LED_G, OUTPUT);
        pinMode(LED_B, OUTPUT);
        setColor(0, 0, 0); // blanc

        // Ultrason
        pinMode(trigPin, OUTPUT);
        pinMode(echoPin, INPUT);

        // Infrarouge
        pinMode(infraredSensor, INPUT);

        // capteur de couleur
        pinMode(S0, OUTPUT);
        pinMode(S1, OUTPUT);
        pinMode(S2, OUTPUT);
        pinMode(S3, OUTPUT);
        pinMode(Out, INPUT);

        // Configurer l'√©chelle de fr√©quence √† 100%
        digitalWrite(S0, HIGH);
        digitalWrite(S1, HIGH);

        // boutons poussoirs
        pinMode(pinStart, INPUT_PULLUP);
        pinMode(pinStop, INPUT_PULLUP);
        attachInterrupt(digitalPinToInterrupt(pinStop), interrupt_routine, FALLING);

        Serial.begin(9600);
        delay(100);
        Serial.println(state);
    }

    void loop()
    {
        if (state == "OFF")
        {
            analogWrite(pinMotor, 0);
            while (digitalRead(pinStart))
            {
                // clignotement de la led pour indiquer que le syst√®me peut √™tre lanc√©
                setColor(255, 165, 0);
                delay(100);
                setColor(0, 0, 0);
                delay(100);
            }
            state = "ON";
            Serial.println(state);
        }
        else
        {
            // distance de l'objet par rapport au capteur
            distance = getDistance();
            infraredValue = digitalRead(infraredSensor);

            if (infraredValue)
            {
                finTapis = true;
                analogWrite(pinMotor, 0);
            }

            else if (distance < 50 || !finTapis)
            {
                // zone de d√©tection de couleur
                if (9 < distance && distance < 13)
                {
                    finTapis = false;
                    // arr√™t du moteur
                    analogWrite(pinMotor, 0);

                    color_detected = getColor(); // detection de couleur

                    Serial.println(color_detected); // envoie de la couleur √† l'interface

                    // redemarrage du moteur
                    analogWrite(pinMotor, 100);
                    delay(500);
                }

                analogWrite(pinMotor, 100);
                delay(20);
            }

            else
            {
                // arr√™t du moteur
                analogWrite(pinMotor, 0);
            }
        }
    }

    void setColor(unsigned int red, unsigned int green, unsigned int blue)
    {
        red = map(red, 0, 255, 255, 0);
        green = map(green, 0, 255, 255, 0);
        blue = map(blue, 0, 255, 255, 0);
        analogWrite(LED_R, red);
        analogWrite(LED_G, green);
        analogWrite(LED_B, blue);
    }

    void getFrequencyColor()
    {
        redFrequency = 0;
        greenFrequency = 0;
        blueFrequency = 0;

        for (unsigned int i = 0; i < nbEchantillon; i++)
        {
            // S√©lectionner filtre rouge
            digitalWrite(S2, LOW);
            digitalWrite(S3, LOW);
            redFrequency += pulseIn(Out, LOW); // Mesure la frequence du rouge

            // S√©lectionner filtre vert
            digitalWrite(S2, HIGH);
            digitalWrite(S3, HIGH);
            greenFrequency += pulseIn(Out, LOW); // Mesure la frequence du vert

            // S√©lectionner filtre bleu
            digitalWrite(S2, LOW);
            digitalWrite(S3, HIGH);
            blueFrequency += pulseIn(Out, LOW); // Mesure la frequence du bleu
        }
        redFrequency /= nbEchantillon;
        greenFrequency /= nbEchantillon;
        blueFrequency /= nbEchantillon;
        /*
            // Afficher les valeurs pour la configuration
            Serial.print("R:");
            Serial.print(redFrequency);
            Serial.print(" G:");
            Serial.print(greenFrequency);
            Serial.print("B:");
            Serial.println(blueFrequency);
        */
    }

    char getColor()
    {
        setColor(0, 0, 0);
        getFrequencyColor();

        if (redFrequency > 25 && greenFrequency > 30 && blueFrequency > 25)
        {
            setColor(50, 50, 50);
            return 'U'; // Pas de couleur d√©tect√©e
        }

        if (redFrequency < 15)
        {
            int diffRG = greenFrequency - redFrequency; // Calculer la diff√©rence entre vert et rouge

            if (diffRG < 5)
            {
                setColor(100, 100, 0); // jaune
                return 'Y';
            }
            else if (diffRG >= 5)
            {
                setColor(100, 0, 0); // rouge
                return 'R';
            }
        }
        else if (greenFrequency < redFrequency && greenFrequency < blueFrequency && greenFrequency < 20)
        {                        // Si vert dominant et faible
            setColor(0, 100, 0); // vert
            return 'G';
        }
        else if (blueFrequency < redFrequency && blueFrequency < greenFrequency && blueFrequency < 20)
        {
            setColor(0, 0, 100); // bleu
            return 'B';
        }
        else
        {
            setColor(50, 50, 50);
            return 'U';
        }
    }

    // Fonction pour lire la distance avec le capteur ultrason
    long getDistance()
    {
        digitalWrite(trigPin, LOW);
        delayMicroseconds(2);
        digitalWrite(trigPin, HIGH);
        delayMicroseconds(10);
        digitalWrite(trigPin, LOW);

        long duration = pulseIn(echoPin, HIGH);
        long distance = (duration / 2.0) * 0.0344;
        return distance;
    }

    void interrupt_routine()
    {
    }

    void interrupt_routine()
    {
        unsigned long currentMillis = millis();
        if (currentMillis - lastInterrupt > 50)
        { // anti-rebond de 50 ms
            // arr√™t moteur
            analogWrite(pinMotor, 0);
            state = "OFF";
            Serial.println(state);
        }
    }
              </code></pre>
            </div>

            <p class="txt_center">
              <strong>NB:</strong> Les commentaires expliquent en d√©tail le code.
            </p>
            

          <h3 id="2-info2">2. Interface Web</h3>
            <p>
              L‚Äôinterface web du projet <strong>Convoyeur Intelligent</strong> permet la visualisation en temps r√©el des donn√©es re√ßues du capteur de couleurs Arduino. 
              Elle affiche les compteurs de d√©chets selon leur couleur (Rouge, Vert, Bleu, Jaune, Inconnu).
              L‚Äôinterface facilite le suivi du tri des d√©chets automatis√© sur le convoyeur.
            </p>
            <h4>Fonctionnalit√©s principales</h4>
              <h5>a. Tableau de bord</h5>
                <div class="image-container">
                  <img src="images/Test4_2/IT/web1.png" alt="web" class="image-mean"/>
                </div>
                
                <ul>
                  Informations sur le syst√®me:           
                  <li>Etat du syst√®me(actif/inactif): permet de savoir si le syst√®me est en marche ou non.</li>
                  <li>Taux de d√©tection: permet un suivi du taux d'objet tri√© sans erreur(inconnu).</li>
                  <li>Nombre total des d√©chets tri√© dans le syst√®me: donne une id√©e sur la quantit√© tri√©e.</li>
                  <li>Le dernier dechet tri: renseigne le dernier dechet par le syst√®me.</li>
                  <li>Animation d'un convoyeur: permet une visualiser les objets entrant(avec leur couleur respective).</li>
                </ul>

                <ul>Le nombre de dechets par cat√©gorie:
                  <li>Visualisation repr√©sentative de chaque type de d√©chet.</li>
                  <li>Visualisation en temps r√©el du nombre de d√©chets par cat√©gorie.</li>
                </ul>
                
              <h5>b. Historiques des d√©chets</h5>
                <div class="image-container">
                  <img src="images/Test4_2/IT/web2.png" alt="web" class="image-mean"/>
                </div>
                <ul>
                  <li>Journal d√©taill√© de toutes les d√©tections d‚Äôobjets tri√©s, avec horodatage, type et couleur</li>
                  <li>Permet de consulter les √©v√©nements pass√©s pour analyse ou v√©rification.</li>
                  <li>Export de l'historique en fichier <strong>.csv</strong> pour analyse plus pous√©e.</li>            
                </ul>

              <h5>c. Statistiques</h5>
                <div class="image-container">
                  <img src="images/Test4_2/IT/web3.png" alt="web" class="image-mean"/>
                </div>
                <ul>
                  <li>Affiche la repartition de chaque cat√©gorie de d√©chets.</li>
                  <li>Export des statistiques en fichier <strong>.csv</strong> pour des analyses.</li>  
                  <li>Export des statistiques en image pour des publications, ...</li>            
                </ul>

              <h5>d. Param√®tres</h5>
                <div class="image-container">
                  <img src="images/Test4_2/IT/web4.png" alt="web" class="image-mean"/>
                  <img src="images/Test4_2/IT/web5.png" alt="web" class="image-mean"/>
                </div>
                <ul>
                  <li>Choix de th√®me: clair(par d√©faut)/sombre</li>
                  <li>Choix de langue: Fran√ßais(par d√©faut)/Anglais</li>
                  <li>R√©initialisation de la base de donn√©es: supprimer l'ensemble des donn√©es</li>
                </ul>


          <h3 id="3-info2">3. Architecture technique</h3>
            <p>
              Voici l'arborescence du dossier
            </p>
            <div class="arbo">
              <ul>
                <li class="folder">convoyeur_web
                  <ul>
                    <li class="folder">__pycache</li>
                    <li class="folder">data
                      <ul>                        
                        <li class="file">historique.json</li>
                      </ul>
                    </li>
                    <li class="folder">static
                      <ul>                        
                        <li class="file">script.js</li>
                        <li class="file">style.css</li>
                        <li class="file">tekbot_logo.png</li>
                        <li class="file">trc.png</li>
                      </ul>
                    </li>
                    <li class="folder">templates
                      <ul>                        
                        <li class="file">index.html</li>
                      </ul>
                    </li>
                    <li class="folder">venv</li>
                    <li class="file">app.py</li>
                  </ul>
                </li>
              </ul>
            </div>

            <h4> a. Backend (Serveur Flask + SocketIO)</h4>
              <p>Nous utilisons <strong>python</strong> avec ces librairies.</p>
              <ul>
                <li>
                  Connexion s√©rie avec l‚ÄôArduino(via <strong>serial</strong>) pour recevoir les donn√©es (lettres repr√©sentant couleurs, √©tat du syst√®me(ON/OFF)).
                </li>
                <li>
                  Traitement, mise √† jour et enregistrement des donn√©es(via <strong>json, os, ...</strong>).
                </li>
                <li>
                  Emission d‚Äô√©v√©nements WebSocket(via <strong>flask, SocketIO</strong>) pour mise √† jour instantan√©e c√¥t√© client.
                </li>
              </ul>

              <div class="code-container">
                <p>app.py</p>
                <div class="btn-bar">
                  <button onclick="copierCode('app-py', this)">üìã</button>
                  <button onclick="telechargerCode('app-py', 'app.py', 'text/py', this)">ü°á</button>
                </div>
                <pre><code id="app-py">  
    from flask import Flask, render_template, jsonify, request
    from flask_socketio import SocketIO, emit
    import threading
    import time
    from datetime import datetime
    import json, os
    from collections import Counter
    import serial.tools.list_ports

    app = Flask(__name__)
    app.secret_key = "tekbot2025"

    # Configuration SocketIO
    socketio = SocketIO(app,
                        cors_allowed_origins="*",
                        async_mode="threading",
                        logger=False,
                        engineio_logger=False)

    # Chemins
    DATA_FOLDER = "data"
    HISTORIQUE_PATH = os.path.join(DATA_FOLDER, "historique.json")

    # Variables globales
    state = "OFF"
    COLOR = ["rouge", "jaune", "bleu", "vert", "inconnu"]

    COULEUR_TYPE = {
        "bleu": "recyclables",
        "jaune": "plastiques",
        "rouge": "dangereux",
        "vert": "organiques",
        "inconnu": "inconnu" 
    }

    # Initialisation dossier et fichier
    if not os.path.exists(DATA_FOLDER):
        os.mkdir(DATA_FOLDER)
    if not os.path.exists(HISTORIQUE_PATH):
        with open(HISTORIQUE_PATH, "w") as f:
            json.dump([], f)

    # Chargement historique
    try:
        with open(HISTORIQUE_PATH, "r") as f:
            historique = json.load(f)
    except (json.JSONDecodeError, FileNotFoundError):
        historique = []
        with open(HISTORIQUE_PATH, "w") as f:
            json.dump(historique, f)

    # Sauvegarde d‚Äôun d√©chet dans l‚Äôhistorique
    def save_historique(couleur):
        type_dechet = COULEUR_TYPE.get(couleur.lower(), 'inconnu')
        entry = {
            "time": datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
            "type": type_dechet,
            "color": couleur
        }
        historique.append(entry)
        with open(HISTORIQUE_PATH, "w", encoding="utf-8") as f:
            json.dump(historique, f, ensure_ascii=False, indent=2)
        return entry

    # G√©n√®re les donn√©es √† transmettre
    def generer_data():
        counts = Counter(entry["color"] for entry in historique)
        compteurs = {c: counts.get(c, 0) for c in COLOR}    
        
        
        total = sum(compteurs.values())
        dernier = historique[-1]["color"] if historique else None

        # Calcul du taux : proportion des couleurs d√©tect√©es diff√©rentes de "inconnu"
        inconnu_count = compteurs.get("inconnu", 0)
        detected_count = total - inconnu_count

        # taux = (detected_count/total)*100 if total > 0 else 0
        taux = round((detected_count / total) * 100, 2) if total > 0 else 0

        return {
            "compteurs": compteurs,
            "total": total,
            "taux": taux,
            "dernier": dernier,
            "historique": historique,
            "etat_systeme": state
        }
        
    # Envoie les donn√©es via WebSocket
    def broadcast_data():
        data = generer_data()
        socketio.emit("update_data", data)

    @app.route('/')
    def index():
        return render_template("index.html")

    # Route pour lecture des donn√©es
    @app.route('/data')
    def get_data():
        data = generer_data()
        socketio.emit("update_data", data)
        return jsonify(data)

    # Route pour ajouter un d√©chet
    @app.route('/add', methods=["POST"])
    def add_dechet():
        data = request.get_json()
        couleur = data.get("type")
        
        if couleur not in {"red", "yellow", "blue", "green", "inconnu"}:
            return jsonify({"error": "Type invalide"}), 400

        save_historique(couleur)
        broadcast_data()
        return jsonify({"success": True})

    # R√©initialiser la base de donn√©es
    @app.route('/reset', methods=["POST"])
    def reset_data():
        historique.clear()
        with open(HISTORIQUE_PATH, "w") as f:
            json.dump([], f)
        broadcast_data()
        return jsonify({"success": True})

            
    @socketio.on('connect')
    def handle_connect():
        emit('update_data', generer_data())
        
    arduino = None
    arduino_connected = False
    selected_port = None

    def select_port():
        global selected_port
        ports = serial.tools.list_ports.comports()
        ports_list = [port.device for port in ports]
        
        if not ports_list:
            print("Aucun port d√©tect√©.")
            exit()
            
        print("Ports disponibles :")
        for port in ports:
            print(str(port))
                
        try:
            choice = int(input("Select Com Port for arduino: "))
            for i in range(len(ports_list)):
                if(ports_list[i].startswith("COM" + str(choice))):
                    selected_port = "COM" + str(choice)
                    print(f"Selected port: {selected_port}")
                    break
            
            if selected_port is None:
                print("Port invalide.")
                exit()

        except ValueError:
            print("Entr√©e invalide.")
            exit()


    def connect_arduino():
        select_port()
        global arduino, arduino_connected, selected_port
        
        try:
            arduino = serial.Serial(selected_port, 9600)
            arduino_connected = True
            print("Connexion Arduino r√©ussie")
            socketio.emit('notification', {'message': 'Arduino connect√©'})
            time.sleep(1)

            
        except Exception as e:
            print(f"√âchec connexion Arduino: {e}")
            arduino_connected = False
            socketio.emit('notification', {
                        'message': f'√âchec connexion Arduino: {e}'})


    def lecture_arduino():
        while arduino_connected:
            if arduino.in_waiting:
                try:
                    data = arduino.readline().decode().strip()
                    if not data:
                        continue

                    print(f"[Arduino] => {data}")

                    if data in ['R', 'G', 'B', 'Y', 'U']:
                        mapping = {"R": "rouge", "Y": "jaune", "B": "bleu", "G": "vert", "U": "inconnu"} 
                        type_ = mapping[data]
                        save_historique(type_)
                        broadcast_data()
                    
                    elif data in ["ON", "OFF"]:
                        global state
                        state = data
                        broadcast_data()
                        

                except Exception as e:
                    print(f"Erreur lecture Arduino: {e}")
                    time.sleep(0.5)

            time.sleep(0.1)


    # Lancement
    if __name__ == '__main__':
        connect_arduino()

        if arduino_connected:
            thread = threading.Thread(target=lecture_arduino)
            thread.daemon = True
            thread.start()

        socketio.run(app, host='0.0.0.0', port=5000,
                    debug=False, allow_unsafe_werkzeug=True)
                </code></pre>
              </div>

              <h4>b. Frontend (HTML, CSS, JavaScript avec Socket.IO)</h4>
                <ul>
                  <li>Affichage dynamique des donn√©es re√ßues via WebSocket.</li>
                  <li>Mises √† jour en temps r√©el(avec temps de communication avec les diff√©rents √©l√©ments).</li>
                  <li>Animation simple du convoyeur.</li>
                </ul>

                  <div class="code-container">
                    <p>index.html</p>
                    <div class="btn-bar">
                      <button onclick="copierCode('index-html', this)">üìã</button>
                      <button onclick="telechargerCode('index-html', 'index.html', 'text/html', this)">ü°á</button>
                    </div>
                    <pre><code id="index-html">
    &lt;!DOCTYPE html&gt;
    &lt;html lang="fr"&gt;
    &lt;head&gt;
      &lt;meta charset="UTF-8"&gt;
      &lt;title&gt;Syst√®me de Tri Intelligent - B2MS&lt;/title&gt;
      &lt;link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}"&gt;
      &lt;link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"&gt;
      &lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;
    &lt;/head&gt;

    &lt;body&gt;
      &lt;header&gt;
        &lt;img class="left-logo" src="{{ url_for('static', filename='trc.png') }}" alt="Logo gauche"&gt;
        
        &lt;div class="header-center"&gt;
          &lt;h1&gt;Syst√®me de Tri Intelligent - Convoyeur&lt;/h1&gt;
          &lt;h2&gt;B2MS CleanTech&lt;/h2&gt;
        &lt;/div&gt;
        
        &lt;img class="right-logo" src="{{ url_for('static', filename='tekbot_logo.png') }}" height="10" alt="Logo droite"&gt;
      &lt;/header&gt;

      &lt;nav&gt;
        &lt;button class="tab-btn active" data-target="dashboard"&gt;Tableau de bord&lt;/button&gt;
        &lt;button class="tab-btn" data-target="historique"&gt;Historique&lt;/button&gt;
        &lt;button class="tab-btn" data-target="statistiques"&gt;Statistiques&lt;/button&gt;
        &lt;button class="tab-btn" data-target="parametres"&gt;Param√®tres&lt;/button&gt;
      &lt;/nav&gt;

      &lt;main&gt;
        &lt;!-- Tableau de bord --&gt;
        &lt;section id="dashboard" class="active"&gt;
          &lt;div class="dashboard-container"&gt;
            &lt;div class="left-column"&gt;
              &lt;div class="system-info"&gt;
                &lt;p&gt;&lt;strong&gt;√âtat :&lt;/strong&gt; &lt;span id="etat-systeme"&gt;üî¥ Inactif&lt;/span&gt;&lt;/p&gt;
                &lt;p&gt;&lt;strong&gt;Total d√©chets trait√©s :&lt;/strong&gt; &lt;span id="total-dechets"&gt;0&lt;/span&gt;&lt;/p&gt;
                &lt;p&gt;&lt;strong&gt;Taux de detection :&lt;/strong&gt; &lt;span id="taux-detection"&gt;0%&lt;/span&gt;&lt;/p&gt;
                &lt;p&gt;&lt;strong&gt;Dernier d√©chet d√©tect√© :&lt;/strong&gt; &lt;span id="dernier-dechet"&gt;N/A&lt;/span&gt;&lt;/p&gt;
              &lt;/div&gt;
            &lt;/div&gt;

            &lt;div class="conveyor-wrapper"&gt;
              &lt;div class="conveyor-container"&gt;
                &lt;div class="belt"&gt;
                  &lt;div id="pattern" class="pattern"&gt;&lt;/div&gt;
                &lt;/div&gt;
                &lt;div id="detected-object" class="detected-object"&gt;&lt;/div&gt;
              &lt;/div&gt;
            &lt;/div&gt;
          &lt;/div&gt;

          &lt;div class="tubes"&gt;
            &lt;div class="tube red"&gt;
              &lt;div class="icon"&gt;‚ò£Ô∏è&lt;/div&gt;
              &lt;div&gt;Dangereux&lt;/div&gt;
              &lt;div class="count" id="count-red"&gt;0&lt;/div&gt;
            &lt;/div&gt;
            &lt;div class="tube yellow"&gt;
              &lt;div class="icon"&gt;üì¶&lt;/div&gt;
              &lt;div&gt;Plastiques/Cartons&lt;/div&gt;
              &lt;div class="count" id="count-yellow"&gt;0&lt;/div&gt;
            &lt;/div&gt;
            &lt;div class="tube blue"&gt;
              &lt;div class="icon"&gt;‚ôªÔ∏è&lt;/div&gt;
              &lt;div&gt;Recyclables&lt;/div&gt;
              &lt;div class="count" id="count-blue"&gt;0&lt;/div&gt;
            &lt;/div&gt;
            &lt;div class="tube green"&gt;
              &lt;div class="icon"&gt;üçÉ&lt;/div&gt;
              &lt;div&gt;Biod√©gradables&lt;/div&gt;
              &lt;div class="count" id="count-green"&gt;0&lt;/div&gt;
            &lt;/div&gt;
          &lt;/div&gt;
        &lt;/section&gt;

        &lt;!-- Historique --&gt;
        &lt;section id="historique"&gt;
          &lt;button id="exportBtn"&gt;Exporter CSV&lt;/button&gt;
          &lt;table&gt;
            &lt;thead&gt;
              &lt;tr&gt;
                &lt;th&gt;Chronologie&lt;/th&gt;
                &lt;th&gt;Type&lt;/th&gt;
                &lt;th&gt;Couleur&lt;/th&gt;
              &lt;/tr&gt;
            &lt;/thead&gt;
            &lt;tbody id="historyBody"&gt;
            &lt;/tbody&gt;
          &lt;/table&gt;
        &lt;/section&gt;

        &lt;!-- Statistiques --&gt;
        &lt;section id="statistiques" class="container"&gt;
          &lt;div id="statsContainer"&gt;
            &lt;canvas id="pieChart"&gt;&lt;/canvas&gt;
            &lt;button id="downloadChart"&gt;T√©l√©charger Graphique&lt;/button&gt;
            &lt;button id="exportStatsCsv"&gt;Exporter Statistiques CSV&lt;/button&gt;
          &lt;/div&gt;
        &lt;/section&gt;

        &lt;!-- Param√®tres --&gt;
        &lt;section id="parametres" class="container"&gt;
          &lt;div id="theme-switcher" class="sub-container"&gt;
            &lt;h1&gt;Th√®me :&lt;/h1&gt;
            &lt;button id="lightThemeBtn" class="active"&gt;Clair&lt;/button&gt;
            &lt;button id="darkThemeBtn"&gt;Sombre&lt;/button&gt;
          &lt;/div&gt;

          &lt;div id="language-switcher" class="sub-container"&gt;
            &lt;h1&gt;Langue :&lt;/h1&gt;
            &lt;button id="frBtn" class="active"&gt;Fran√ßais&lt;/button&gt;
            &lt;button id="enBtn"&gt;English&lt;/button&gt;
          &lt;/div&gt;
          &lt;div class=" sub-container"&gt;
            &lt;h1&gt;Base de donn√©es :&lt;/h1&gt;
            &lt;button id="resetCountersBtn"&gt;üîÑ R√©initialiser&lt;/button&gt;
          &lt;/div&gt;
        &lt;/section&gt;

      &lt;/main&gt;

      &lt;footer&gt;
        Copyright ¬© 2025 Team B2MS CleanTech. All rights reserved.
      &lt;/footer&gt;
      
      &lt;canvas id="pieChart"&gt;&lt;/canvas&gt;
      &lt;script src="https://cdn.jsdelivr.net/npm/chart.js"&gt;&lt;/script&gt;
      &lt;script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"&gt;&lt;/script&gt;
      &lt;script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"&gt;&lt;/script&gt;
      &lt;script src="https://cdn.socket.io/4.7.2/socket.io.min.js"&gt;&lt;/script&gt;
      &lt;script src="{{ url_for('static', filename='script.js') }}"&gt;&lt;/script&gt;

    &lt;/body&gt;
    &lt;/html&gt;
                    </code></pre>
                  </div>

                <div class="code-container">
                  <p>style.css</p>
                  <div class="btn-bar">
                    <button onclick="copierCode('style-css', this)">üìã</button>
                    <button onclick="telechargerCode('style-css', 'style.css', 'text/css', this)">ü°á</button>
                  </div>
                  <pre><code id="style-css">
    @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap");

    :root {
      --primary-color: #00796b;
      --primary-color-dark: #009572;
      --primary-color-under-ligne: #ffffff;
      --text-dark: #0c0a09;
      --text-light: #78716c;
      --white: #ffffff;
      --max-width: 1200px;
      --redLight: #ff4c4c;
      --yellowLight: #fbc02d;
      --greenLight: #388e3c;
      --blueLight: #1976d2;
      
      --gris-clair: #f8f9fa;
      --gris-fonce: #212529;
      --noir: #000000;

      --transition: all 0.3s ease;
    }

    * {
      padding: 0;
      margin: 0;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #ffffff;
      color: black;
      line-height: 1.6;
    }

    /* Header */
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.5rem 1rem;
      font-weight: bold;
      font-size: 1.2rem;
      background-color: #ffffff;
    }

    .header-center {
      text-align: center;
      flex-grow: 1;
    }

    .left-logo {
      width: 15%;
      height: auto;
      margin-right: 1rem;
    }

    .right-logo {
      width: 5%;
      height: auto;
      margin-left: 1rem;
    }

    header h1 {
      color: var(--primary-color);
    }

    header h4 {
      color: var(--primary-color);
    }

    .container {
      border-radius: 12px;
      max-width: 1000px;
      align-items: center; 
      margin: auto;
      width: 100%;         
      border: 2px solid #cce4d8;
      background-color: var(--blanc);
      padding: 1rem;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      margin-top: -0.5rem !important;
      justify-content: center !important;
      align-items: center !important;
    }

    .sub-container {
      align-items: center; 
      border: 2px solid #cce4d8;
      background-color: #f8fbfa;
      padding: 0.5rem;
      margin-bottom: 2rem;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
    }


    /* Nav */
    nav {
      display: flex;
      background: #e0f2f1;
    }

    nav button {
      flex: 1;
      padding: 1rem;
      background: #e0f2f1;
      border: none;
      border-top: none; 
      margin: 0;         
      outline: none;     
      color: #00796b;
      cursor: pointer;
      font-weight: bold;
      font-size: 1.2rem;
      transition: background 0.3s;
    }


    nav button.active,
    nav button:hover {
      background: #b2dfdb;
    }

    /* Main */
    main {
      padding: 1rem;
    }

    section {
      display: none;
    }

    section.active {
      display: block;
    }

    .dashboard-container {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 1rem;
      align-items: start;
    }

    .left-column {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .conveyor-wrapper {
      display: flex;
      justify-content: center;
      margin: 1.5rem;
    }

    /* Bande anim√©e du convoyeur */
    .conveyor-container {
      width: 300px;
      height: 120px;
      background-color: #f8fbfa;
      color: #333;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      position: relative;
      overflow: hidden;
      border-radius: 8px;
    }

    .belt {
      position: absolute;
      bottom: 0;
      width: 100%;
      height: 30px;
      overflow: hidden;
    }

    .pattern {
      width: 200%;
      height: 100%;
      background: linear-gradient(90deg, #777 25%, #bbb 50%, #777 75%);
      background-size: 100px 30px;
      /* animation: scrollBelt 6s linear infinite; */
    }

    .pattern.moving {
      animation: scrollBelt 6s linear infinite;
    }

    @keyframes scrollBelt {
      0% {
        transform: translateX(0);
      }
      100% {
        transform: translateX(-50%);
      }
    }

    .detected-object {
      width: 40px;
      height: 40px;
      border-radius: 4px;
      position: absolute;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      background-color: transparent;
      opacity: 0;
      pointer-events: none;
      transition: background-color 0.3s ease, opacity 0.3s ease;
    }

    .detected-object.active {
      opacity: 1;
    }


    .system-info {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      padding: 1.5rem;
      margin: 1rem auto;
      width: 100%;
      background-color: #f8fbfa;
      color: #333;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      font-size: 1.2rem;
    }

    .system-info p {
      margin: 0;
      padding: 0.3rem 0;
    }

    .system-info strong {
      color: #222;
    }

    .system-info span {
      font-weight: bold;
      color: #0b6f6a;
    }


    /* Dashboard tubes */
    .tubes {
      display: flex;
      gap: 1rem;
      margin-bottom: 2rem;
      justify-content: center;
    }

    .tube {
      flex: 1;
      background: white;
      border-radius: 8px;
      padding: 1rem;
      box-shadow: 0 2px 8px rgb(0 0 0 / 0.1);
      text-align: center;
      position: relative;
    }

    .tube .icon {
      font-size: 3rem;
      margin-bottom: 0.5rem;
    }

    .tube .count {
      font-size: 2rem;
      font-weight: bold;
    }

    .tube.red {
      background: #ffdddd;
      border: 2px solid #ff4c4c;
      color: var(--redLight);
    }

    .tube.yellow {
      background: #fff8cc;
      border: 2px solid #ffcc00;
      color: var(--yellowLight);
    }

    .tube.blue {
      background: #ddeeff;
      border: 2px solid #3399ff;
      color: var(--blueLight);
    }

    .tube.green {
      background: #ddffdd;
      border: 2px solid #33cc33;
      color: var(--greenLight);
    }

    /* Buttons g√©n√©ral */
    button {
      margin-top: 1rem;
      background: #26A69A;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      cursor: pointer;
      border-radius: 4px;
      font-weight: 600;
      transition: background-color 0.3s;
    }

    button:hover {
      background: #42A5F5;
    }

    /* Historique */
    table {
      width: 90%;
      border-collapse: collapse;
      margin-left: auto;
      margin-right: auto;
      margin-top: 1rem;
    }

    th,
    td {
      padding: 0.5rem;
      border: 1px solid #ccc;
      text-align: center;
    }

    th {
      background: #eee;
    }

    /* Statistiques */
    #statsContainer {
      max-width: 400px;
      margin: auto;
      text-align: center;
    }

    #downloadChart{
      margin-top: 1rem; 
      margin-bottom: 1rem
    }

    #pieChart {
      max-width: 100%;
      height: auto;
    }

    /* Param√®tres */
    #parametres {
      text-align: center;
      /* margin-top: 2rem; */
      font-family: Arial, sans-serif;
    }

    /* Label-like buttons "Mode :", "Langue :" */
    .text-btn {
      background: none;
      border: none;
      cursor: default;
      color: inherit;
      font-weight: bold;
      user-select: none;
      font-size: 1.2rem;
      padding: 0 0.5rem 0 0;
      display: flex;
      align-items: center;
    }

    /* Groupes de boutons (th√®me, langue) */
    .theme-switcher,
    .language-switcher {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 0.5rem;
      margin: 1rem 0 1.5rem;
      font-size: 1.1rem;
      color: inherit;
    }

    #parametres button {
      padding: 0.5rem 1.2rem;
      border: none;
      border-radius: 8px;
      background-color: var(--theme-btn-bg, #e0e0e0);
      color: var(--theme-btn-text, #333);
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
      font-size: 1rem;
      user-select: none;
      min-width: 80px;
    }


    #parametres button:hover:not(.active) {
      background-color: var(--theme-btn-hover, #ccc);
      color: var(--theme-btn-text-hover, #000);
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
    }

    #parametres button.active {
      background-color: var(--theme-btn-active, #26a69a);
      color: var(--theme-btn-active-text, #fff);
      cursor: default;
      pointer-events: none;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    /* Bouton r√©initialiser compteurs */
    #resetCountersBtn {
      padding: 0.7rem 1.5rem;
      font-size: 1.1rem;
      background-color: #e53935 !important;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s;
      margin-top: 1rem;
    }

    #resetCountersBtn:hover {
      background-color: #c62828 !important;
    }

    footer{
      text-align: center;
      font-size: 1.2rem;
    }




    /* Th√®me clair par d√©faut */
    body.light-theme {
      background: #f0f2f5;
      color: #333;
    }

    /* Th√®me sombre */
    body.dark-theme {
      background: #121212;
      color: #eee;
    }

    /* Ajustements mode sombre */
    body.dark-theme header {
      background: #222;
      color: #fff;
    }

    body.dark-theme nav {
      background: #333;
    }

    body.dark-theme nav button {
      background: #333;
      color: #bbb;
    }

    body.dark-theme nav button.active,
    body.dark-theme nav button:hover {
      background: #093d38;
      color: white;
    }

    body.dark-theme .tube {
      background: #222;
      color: #eee;
      box-shadow: 0 2px 8px rgb(255 255 255 / 0.1);
      border-color: #555;
    }

    body.dark-theme .tube.red {
      background: #1a0000; 
      color: #ff4c4c;
      border-color: #ff4c4c;
      box-shadow: inset 0 0 15px 5px #ff4c4c80;
    }

    body.dark-theme .tube.yellow {
      background: #332a00;
      color: #ffcc00;
      border-color: #ffcc00;
      box-shadow: inset 0 0 15px 5px #ffcc0080;
    }

    body.dark-theme .tube.blue {
      background: #001a33; 
      color: #3399ff;
      border-color: #3399ff;
      box-shadow: inset 0 0 15px 5px #3399ff80;
    }

    body.dark-theme .tube.green {
      background: #003300; 
      color: #33cc33;
      border-color: #33cc33;
      box-shadow: inset 0 0 15px 5px #33cc3380; 
    }


    body.dark-theme th {
      background: #2a2929;
    }

    body.dark-theme button {
      background: #607D8B;
      color: white;
    }

    body.dark-theme button:hover {
      background: #455A64;
    }




    body.dark-theme #parametres button.active {
      background-color: var(--theme-btn-active, #01655b);
    }

    body.dark-theme #resetCountersBtn {
      background-color: #e53935 !important; /* rouge vif */
      color: #fff;
      box-shadow: 0 0 5px rgba(229, 57, 53, 0.3);
    }

    body.dark-theme #resetCountersBtn:hover {
      background-color: #c62828 !important; /* rouge plus fonc√© */
      color: #fff;
      box-shadow: 0 0 8px rgba(198, 40, 40, 0.4);
    }


    body.dark-theme h {
      color: #fff;
    }

    body.dark-theme .container {       
      border: 2px solid #2a2d34;
      background-color:  #1e1e1e;
      box-shadow: 0 2px 8px rgba(255,255,255,0.05);
    }

    body.dark-theme .sub-container {
      border: 2px solid #31353e;
      background-color: #1e1f24; 
      box-shadow: 0 2px 8px rgba(255,255,255,0.05);
    }



    body.dark-theme .system-info {
      background-color: #1e1e1e;
      color: #ddd;
      box-shadow: 0 2px 8px rgba(255, 255, 255, 0.05);
    }

    body.dark-theme .system-info strong {
      color: #fff;
    }

    body.dark-theme .system-info span {
      color: #90caf9; /* bleu clair pour contraster */
    }

    body.dark-theme .conveyor-container {
      background-color: #1e1e1e;
      color: #ddd;
      box-shadow: 0 2px 8px rgba(255, 255, 255, 0.05);
    }




    /* Dashboard responsive : une seule colonne sous 768px */
    @media (max-width: 768px) {
      .dashboard-container {
        grid-template-columns: 1fr;
      }

      .tubes {
        flex-direction: column;
        gap: 1rem;
      }

      .tube {
        width: 100%;
      }

      .conveyor-container {
        width: 100%;
        height: 100px;
      }

      .detected-object {
        width: 30px;
        height: 30px;
      }

      table {
        font-size: 0.85rem;
        width: 100%;
      }

      th, td {
        padding: 0.4rem;
      }

      #statsContainer {
        max-width: 100%;
        padding: 0 1rem;
      }

      .container,
      .sub-container {
        padding: 1rem;
        margin: 1rem;
      }

      .system-info {
        grid-template-columns: 1fr;
        font-size: 1rem;
      }
    }

    /* Header responsive sous 600px */
    @media (max-width: 600px) {
      header {
        flex-direction: column;
        text-align: center;
      }

      .left-logo,
      .right-logo {
        width: 50px;
        margin: 0.5rem auto;
      }

      .header-center {
        margin: 0.5rem 0;
      }

      nav {
        flex-direction: column;
      }

      nav button {
        font-size: 1rem;
        padding: 0.8rem;
      }
    }

    /* Param√®tres responsive sous 500px */
    @media (max-width: 500px) {
      .theme-switcher,
      .language-switcher {
        flex-direction: column;
        gap: 0.5rem;
      }

      #parametres button {
        min-width: unset;
        width: 100%;
      }
    }
                  </code></pre>
                </div>

                <div class="code-container">
                  <p>script.js</p>
                  <div class="btn-bar">
                    <button onclick="copierCode('script-js', this)">üìã</button>
                    <button onclick="telechargerCode('script-js', 'script.js', 'text/js', this)">ü°á</button>
                  </div>
                  <pre><code id="script-js">
    let hasInitialized = false;

    // Gestion des onglets
    const tabs = document.querySelectorAll('.tab-btn');
    const sections = document.querySelectorAll('main section');

    const DELAI_ANIM = 3000;

    // Donn√©es syst√®me
    let systemActif = false;
    let totalCount = 0;
    const counts = {red: 0, yellow: 0, blue: 0, green: 0, inconnu: 0};
    const countElems = {
      red: document.getElementById('count-red'),
      yellow: document.getElementById('count-yellow'),
      blue: document.getElementById('count-blue'),
      green: document.getElementById('count-green')
    };

    const totalElem = document.getElementById('total-dechets');
    const dernierDechetElem = document.getElementById('dernier-dechet');
    const etatElem = document.getElementById('etat-systeme');

    const detectedObjectElem = document.getElementById('detected-object');
    const conveyorState = document.getElementById('pattern');

    const history = [];
    let currentLang = localStorage.getItem('lang') || 'fr';

    const translations = {
      fr: {
        modeLabel: "Th√®me :",
        languageLabel: "Langue :",
        resetBtn: "R√©initialiser la base de donn√©es",
        exportBtn: "Exporter CSV",
        downloadChart: "T√©l√©charger Graphique",
        exportStatsCsv: "Exporter Statistiques CSV",
        tubes: {
          red: "Dangereux",
          yellow: "Plastiques/Cartons",
          blue: "Recyclables",
          green: "Biod√©gradables",
          unknown: "Inconnu" 
        },
        tabs: ["Tableau de bord", "Historique", "Statistiques", "Param√®tres"],
        title: "Syst√®me de Tri Intelligent - Convoyeur",
        unknown: "Inconnu",
        system: {
          state: "√âtat",
          total: "Total d√©chets trait√©s",
          taux: "Taux de detection",
          last: "Dernier d√©chet d√©tect√©",
          on: "Actif",
          off: "Inactif"
        }
      },
      en: {
        modeLabel: "Theme:",
        languageLabel: "Language:",
        resetBtn: "Reset Database",
        exportBtn: "Export CSV",
        downloadChart: "Download Chart",
        exportStatsCsv: "Export Stats CSV",
        tubes: {
          red: "Hazardous",
          yellow: "Plastics/Cartons",
          blue: "Recyclables",
          green: "Biodegradable",
          unknown: "Unknown"
        },
        tabs: ["Dashboard", "History", "Statistics", "Settings"],
        title: "Smart Sorting System - Conveyor",
        unknown: "Unknown",
        system: {
          state: "State",
          total: "Total Waste Processed",
          taux: "Detection rate",
          last: "Last Detected Waste",
          on: "Active",
          off: "Inactive"
        }
      }
    };


    function switchLang(lang) {
      currentLang = lang;
      localStorage.setItem('lang', lang);

      // Traduction onglets
      tabs.forEach((tab, idx) => {
        tab.textContent = translations[lang].tabs[idx];
      });

      // Traduction tubes
      document.querySelector('.tube.red div:nth-child(2)').textContent = translations[lang].tubes.red;
      document.querySelector('.tube.yellow div:nth-child(2)').textContent = translations[lang].tubes.yellow;
      document.querySelector('.tube.blue div:nth-child(2)').textContent = translations[lang].tubes.blue;
      document.querySelector('.tube.green div:nth-child(2)').textContent = translations[lang].tubes.green;

      // Autres traductions
      document.querySelector('.header-center h1').textContent = translations[lang].title;
      document.getElementById('resetCountersBtn').textContent = translations[lang].resetBtn;
      document.getElementById('exportBtn').textContent = translations[lang].exportBtn;
      document.getElementById('downloadChart').textContent = translations[lang].downloadChart;
      document.getElementById('exportStatsCsv').textContent = translations[lang].exportStatsCsv;
        
      // Labels mode et langue
      document.querySelector("#theme-switcher h1").textContent = translations[lang].modeLabel;
      document.querySelector("#language-switcher h1").textContent = translations[lang].languageLabel;

      // System info labels
      const systemLabels = document.querySelectorAll(".system-info p");

      if (systemLabels.length >= 4) {
        systemLabels[0].querySelector("strong").textContent = translations[lang].system.state + " :";
        systemLabels[1].querySelector("strong").textContent = translations[lang].system.total + " :";
        systemLabels[2].querySelector("strong").textContent = translations[lang].system.duration + " :";
        systemLabels[3].querySelector("strong").textContent = translations[lang].system.last + " :";
      }
      updateChart();  
      updateSystemState(systemActif ? "ON" : "OFF");
    }

    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active'));
        tab.classList.add('active');

        sections.forEach(s => s.classList.remove('active'));
        document.getElementById(tab.dataset.target).classList.add('active');
      });
    });

    // Th√®me
    const lightThemeBtn = document.getElementById('lightThemeBtn');
    const darkThemeBtn = document.getElementById('darkThemeBtn');

    function applyTheme(theme) {
      if (theme === 'dark') {
        document.body.classList.add('dark-theme');
        darkThemeBtn.classList.add('active');
        lightThemeBtn.classList.remove('active');
      } else {
        document.body.classList.remove('dark-theme');
        lightThemeBtn.classList.add('active');
        darkThemeBtn.classList.remove('active');
      }
      localStorage.setItem('theme', theme);
    }

    lightThemeBtn.addEventListener('click', () => applyTheme('light'));
    darkThemeBtn.addEventListener('click', () => applyTheme('dark'));

    // Mise √† jour √©tat syst√®me
    function updateSystemState(state) {
      const lang = localStorage.getItem('lang') || 'fr';
      const isOn = state === "ON";

      systemActif = isOn;
      etatElem.textContent = isOn
        ? "üü¢ " + (lang === "fr" ? "Actif" : "Active")
        : "üî¥ " + (lang === "fr" ? "Inactif" : "Inactive");
      etatElem.style.color = isOn ? "#27ae60" : "#e74c3c";
    }


    // Affichage le taux de detection du backend
    function updateTaux(taux_) {
      document.getElementById('taux-detection').textContent = (taux_ ? taux_ : 0) + '%';
    }


    // Normalise couleurs backend (fr) vers frontend (en)
    function normalizeColor(color) {
      const map = {
        rouge: 'red',
        jaune: 'yellow',
        bleu: 'blue',
        vert: 'green',
        inconnu: 'unknown'
      };
      return map[color] || color;
    }

    // Met √† jour compteurs et affichages depuis donn√©es serveur
    function updateCountsAndHistory(data) {
      // Remise √† z√©ro compteurs locaux
      for (const c of Object.keys(counts)) {
        counts[c] = 0;
      }

      // Met √† jour compteurs avec donn√©es normalis√©es
      for (const [colorFR, count] of Object.entries(data.compteurs)) {
        const colorEN = normalizeColor(colorFR);
        counts[colorEN] = count;
        if(countElems[colorEN]) countElems[colorEN].textContent = count;
      }

      totalCount = data.total || Object.values(counts).reduce((a,b) => a+b,0);
      totalElem.textContent = totalCount;

      if(data.dernier) {
        const dernierNorm = normalizeColor(data.dernier);
        dernierDechetElem.textContent = `${getTypeName(dernierNorm)}`;
      }

      // Mise √† jour de l'historique local (prend les 20 derniers)
      if (Array.isArray(data.historique)) {
        history.length = 0; // vide
        // Normalise et ajoute
        data.historique.slice(-20).forEach(item => {
          history.push({
            time: item.time,
            type: normalizeColor(item.color || item.type),
            color: normalizeColor(item.color || item.type)
          });
        });
      }

      updateHistoryTable();
      updateChart();
    }

    // R√©cup√®re le nom traduit d‚Äôun type (couleur EN)
    function getTypeName(type) {
      const tubes = translations[currentLang].tubes;
      return tubes[type] || translations[currentLang].unknown;
    }

    // Animation convoyeur
    function conveyorAnimation(type) {
      detectedObjectElem.className = 'detected-object active';
      conveyorState.className = 'pattern moving';
      detectedObjectElem.style.backgroundColor = getTubeColor(type);
      setTimeout(() => {
        detectedObjectElem.className = 'detected-object';
        conveyorState.className = 'pattern';
        detectedObjectElem.style.backgroundColor = 'transparent';
      }, DELAI_ANIM);
    }

    // Couleurs tubes (frontend)
    function getTubeColor(type) {
      switch (type) {
        case 'red': return '#ff4c4c';
        case 'yellow': return '#fbc02d';
        case 'blue': return '#1976d2';
        case 'green': return '#388e3c';
        default: return '#999';  //unknown
      }
    }

    // Met √† jour le tableau historique HTML
    function updateHistoryTable() {
      const tbody = document.getElementById('historyBody');
      tbody.innerHTML = '';
      history.slice().reverse().forEach(item => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${item.time}</td>
          <td>${getTypeName(item.type)}</td>
          <td><span style="display:inline-block;width:16px;height:16px;background-color:${getTubeColor(item.color)};border-radius:4px;"></span></td>
        `;
        tbody.appendChild(tr);
      });
    }


    // Export CSV historique
    document.getElementById('exportBtn').addEventListener('click', () => {
      let csv = 'Chronologie,Type,Couleur\n';
      history.forEach(item => {
        csv += `"${item.time}","${getTypeName(item.type)}","${item.color}"\n`;
      });
      downloadFile(csv, 'historique_tri.csv');
    });

    // Export CSV stats
    document.getElementById('exportStatsCsv').addEventListener('click', () => {
      let csv = 'Type,Quantit√©\n';
      for (const [type, count] of Object.entries(counts)) {
        csv += `"${getTypeName(type)}",${count}\n`;
      }
      downloadFile(csv, 'stats_tri.csv');
    });

    // T√©l√©chargement CSV
    function downloadFile(content, filename) {
      const blob = new Blob([content], {type: 'text/csv;charset=utf-8;'});
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = filename;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    // Chart.js
    let pieChart = null;

    function initChart() {
      const ctx = document.getElementById('pieChart').getContext('2d');

      const labels = [
        translations[currentLang].tubes.red,
        translations[currentLang].tubes.yellow,
        translations[currentLang].tubes.blue,
        translations[currentLang].tubes.green,
        translations[currentLang].tubes.unknown
      ];

      pieChart = new Chart(ctx, {
        type: 'pie',
        data: {
          labels: labels,
          datasets: [{
            label: translations[currentLang].system.total,
            data: [0, 0, 0, 0, 0],
            backgroundColor: ['#ff4c4c', '#fbc02d', '#1976d2', '#388e3c', '#746f6f4c'],
            borderColor: '#fff',
            borderWidth: 2,
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              position: 'bottom'
            },
            datalabels: {
              color: '#fff',
              font: {
                weight: 'bold'
              },
              formatter: (value, context) => {
                const total = context.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
                if (total === 0 || value === 0) return '';
                const percentage = (value / total) * 100;
                return percentage.toFixed(1) + '%';
              }
            }
          }
        },
        plugins: [ChartDataLabels]
      });
    }


    function updateChart() {
      if (!pieChart) return;

      pieChart.data.datasets[0].data = [
        counts.red,
        counts.yellow,
        counts.blue,
        counts.green,
        counts.unknown
      ];

      pieChart.data.labels = [
        translations[currentLang].tubes.red,
        translations[currentLang].tubes.yellow,
        translations[currentLang].tubes.blue,
        translations[currentLang].tubes.green,
        translations[currentLang].tubes.unknown
      ];

      pieChart.data.datasets[0].label = translations[currentLang].system.total;

      pieChart.update();
    }

    // T√©l√©charger graphique en PNG
    document.getElementById('downloadChart').addEventListener('click', () => {
      if (!pieChart) return;
      const link = document.createElement('a');
      link.download = 'graphique_tri.png';
      link.href = pieChart.toBase64Image();
      link.click();
    });

    // Boutons langues
    document.getElementById('frBtn').addEventListener('click', () => {
      switchLang('fr');
      setActiveLangBtn('fr');
    });
    document.getElementById('enBtn').addEventListener('click', () => {
      switchLang('en');
      setActiveLangBtn('en');
    });

    function setActiveLangBtn(lang) {
      document.getElementById('frBtn').classList.toggle('active', lang === 'fr');
      document.getElementById('enBtn').classList.toggle('active', lang === 'en');
    }

    // R√©initialisation compteurs (appel API /reset)
    document.getElementById('resetCountersBtn').addEventListener('click', () => {
      const code = prompt("Entrez le code secret (1234) pour r√©initialiser :");
      if (!code) return;
      fetch('/reset', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ code_secret: code })
      }).then(res => {
        if (res.ok) {
          ancienTotal = 0;
          hasInitialized = true;
        } else {
          alert("Code secret incorrect !");
        }
      });
    });

    // Setup Socket.IO
    const socket = io();

    let ancienTotal = 0;

    function setupSocketIO() {
      socket.on('update_data', (data) => {
        updateSystemState(data.etat_systeme);
        updateTaux(data.taux);
        updateCountsAndHistory(data);

        const couleurNorm = normalizeColor(data.dernier);
        const nouveauTotal = data.total;

        if (hasInitialized) {
          if (couleurNorm && nouveauTotal > ancienTotal) {
            ancienTotal = nouveauTotal;
            conveyorAnimation(couleurNorm);
          }
        } else {
          // Premi√®re initialisation : pas d'animation
          ancienTotal = nouveauTotal;
          hasInitialized = true;
        }
      });
    }

    // Initialisation compl√®te
    function init() {
      
      // Th√®me
      const savedTheme = localStorage.getItem('theme') || 'light';
      applyTheme(savedTheme);

      // Langue
      switchLang(currentLang);
      setActiveLangBtn(currentLang);

      // Onglets init (active premier)
      tabs[0].classList.add('active');
      sections.forEach((s, i) => s.classList.toggle('active', i === 0));

      // Chart
      initChart();

      // Socket
      setupSocketIO();
    }

    document.addEventListener('DOMContentLoaded', init);                    
                  </code></pre>
                </div>

                <h4>c. Tableau r√©capitulatif</h4>
                  <table border="2" cellspacing="1" cellpadding="6">
                    <thead>
                      <tr>
                        <th>Domaine</th>
                        <th>Langages / Outils</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td><strong>Web Backend</strong></td>
                        <td>Flask, Python, SocketIO</td>
                      </tr>
                      <tr>
                        <td><strong>Web Frontend</strong></td>
                        <td>HTML, CSS, JS, Bootstrap 5, Chart.js</td>
                      </tr>
                      <tr>
                        <td><strong>Communication PC-Arduino</strong></td>
                        <td>USB, PySerial(port, 9600 bauds)</td>
                      </tr>
                    </tbody>
                  </table>
 
          <h3 id="4-info2">4. Communication s√©rie et Traitement des Donn√©es</h3>
            <p>
              La communication s√©rie entre l'Arduino et l'ordinateur (serveur Python) est essentielle. 
              Elle se fait par port USB en utilisant un port COM (ex: COM3).
            </p>
            
              <h4>a. Communication Arduino-PC-Interface</h4>
                <ul>
                  <li>
                    <strong>Arduino ‚Üí PC</strong>: Envoie une donn√©e 
                    <ul>
                      <li>une caract√®re (R: red, G: green, B: blue, Y: yellow, U: unknown) chaque fois que la couleur de l'objet est identifi√©e.</li>
                      <li>une chaine de caract√®re (ON, OFF) √† chaque mise en marche/arr√™t du syst√®me de convoyeur.</li>
                    </ul>
                  </li>
                  <li>
                    <strong>PC (Python) ‚Üí Web</strong>: Re√ßoit une donn√©e, l‚Äôinterpr√®te, met √† jour les donn√©es(nombre de d√©chats, taux, ...), et l‚Äôenvoie en temps r√©el √† l‚Äôinterface web via WebSocket.
                  </li>
                </ul>

              <h4>b. D√©tails techniques</h4>
                <ul>
                  <li>
                    <strong>Vitesse de transmission</strong>: 9600 bauds (via Serial.begin(9600)).
                  <li>
                    <strong>Traitement des donn√©es</strong> via le module pyserial en Python.
                  </li>
                  <li>
                    Le port s√©rie est ouvert(apr√®s selection de l'utilisateur) au d√©marrage du serveur <strong>Flask</strong>.
                  </li>
                </ul>
              <h4>c. Traitements des donn√©es</h4>
                <p>
                  Les donn√©es re√ßues de l‚ÄôArduino sont trait√©es en temps r√©el c√¥t√© serveur comme suit:
                  <ul>
                    <li>Lecture de la donn√©e re√ßue ('R', 'G', etc.)</li>
                    <li>Mise √† jour de l'ensemble du syst√®me(√©tat, taux, nombre de d√©chets, ...)</li>
                    <li>Enregistrement des donn√©es(historique et statistiques)</li>
                    <li>Emission d'√©v√©nement vers l'interface</li>
                  </ul>
                </p>

          <h3 id="5-info2">5. Instructions d'utilisation</h3>              
              <ul>
                Voici les √©tapes pour lancer et manipuler l'interface web:
                <li><strong>Lancement du serveur</strong></li>
                <p>
                  Lancer le serveur Flask via la commande <strong>python app.py</strong>. 
                </p>
                <li>
                  L'utilisateur selectionne le port auquel l'Arduino est connect√©.
                </li>
                <li>
                  <strong>Acc√®s √† l‚Äôinterface</strong>: 
                  Ouvrir un navigateur et aller √† l‚Äôadresse IP indiqu√©e dans la console.
                </li>
                <li>
                  <strong>Visualisation des donn√©es et navigation sur l'interface</strong>: 
                  l'utilisateur peut suivre le tri sur l'interface et naviguer pour les diff√©rentes options(historique et statistiques) disponibles.
                </li>      
                <li>
                  <strong>Param√®tres</strong>: 
                  l'utilisateur peut modifier certaines param√®tres de l'interfae(th√®me, langue, r√©initialisation)
                </li>
              </ul>


            <div class="image-container">
              <img src="images/Test4_2/IT/web5.png" alt="web" class="image-mean"/>
              <img src="images/Test4_2/IT/web6.png" alt="web" class="image-mean"/>
            </div>

            <p class="txt_center">
              <a href="https://github.com/TekBot-Robotics-Challenge/2025-Team-B2MS_CleanTech-Docs/raw/refs/heads/main/Test4_2/IT/convoyeur_web.zip" download class="download-link">t√©l√©charger les fichiers de l'interface web</a>
            </p>

        </div>

        <div id="validation2" class="subtab-content">
          <h2 id="test2" class="projet-titre">Tests et validation</h2>
          <h3 id="1-test2">1. Assemblage du convoyeur</h3>
            <p>
              Nous avons ici l'assemblage de la partie m√©canique et de la partie √©lectronqiue.
              Nous avons profit√© du temps suppl√©mentaire pour am√©liorer notre convoyeur d√©j√† fonctionnel et r√©pondant au cahier de charge.
              Voici donc l'avant-apr√®s:
            </p>
            <div class="image-container">
              <p>
                <strong>Avant:</strong>
              </p>
              <img src="images/Test4_2/Convoyeur/realisation1_1.jpg" alt="realisation" class="image-small"/>
              <img src="images/Test4_2/Convoyeur/realisation1_2.jpg" alt="realisation" class="image-small"/>
              <img src="images/Test4_2/Convoyeur/realisation1_3.jpg" alt="realisation" class="image-small"/>
              <img src="images/Test4_2/Convoyeur/realisation1_4.jpg" alt="realisation" class="image-small"/>
            </div>

             <video controls width=30%>
              <source src="videos/Test4_2/Convoyeur/convoyeur1.mp4" type="video/mp4">
              Votre navigateur ne supporte pas la vid√©o HTML5.
            </video>

            <div class="image-container">
              <p>
                <strong>Apr√®s:</strong>
              </p>
              <img src="images/Test4_2/Convoyeur/realisation2_1.jpg" alt="realisation" class="image-small"/>
              <img src="images/Test4_2/Convoyeur/realisation2_2.jpg" alt="realisation" class="image-small"/>  
              <img src="images/Test4_2/Convoyeur/realisation2_3.jpg" alt="realisation" class="image-small"/>
              <img src="images/Test4_2/Convoyeur/realisation2_4.jpg" alt="realisation" class="image-small"/>
              <img src="images/Test4_2/Convoyeur/realisation2_5.jpg" alt="realisation" class="image-small"/>
              <img src="images/Test4_2/Convoyeur/realisation2_6.jpg" alt="realisation" class="image-small"/>
              <!-- <img src="images/Test4/Convoyeur/realisation2_7.jpg" alt="realisation" class="image-small"/> -->
            </div>

           

          <h3 id="2-test2">2. Protocole de test</h3>
            <p>
              Les tests individuels de chaque domaine ayant d√©j√† √©t√© effectu√©s, cette section est consacr√©e √† l‚Äô√©valuation du syst√®me global. 
              L‚Äôobjectif est de v√©rifier l‚Äôint√©gration de tous les modules pour garantir le bon fonctionnement de l‚Äôensemble. 
              Il s‚Äôagit donc de s‚Äôassurer que chaque domaine interagit correctement avec les autres dans un environnement complet et coh√©rent. 
            
              <ul>
                <p class="txt_center"><strong>Avant am√©lioration:</strong></p>
                <li>
                  Nous avons commenc√© par tester l'int√©gration de l'√©lectronique et de la d√©tection intelligente avec la structure du convoyeur √† l'aide d'un petit code.
                </li>
                <video controls width=auto>
                  <source src="videos/Test4_2/Convoyeur/test2.mp4" type="video/mp4">
                  Votre navigateur ne supporte pas la vid√©o HTML5.
                </video>

                <li>
                  Puis, nous avons test√© le syst√®me avec l'interface web.
                </li>
                <video controls width=auto>
                  <source src="videos/Test4_2/Convoyeur/test3.mp4" type="video/mp4">
                  Votre navigateur ne supporte pas la vid√©o HTML5.
                </video>
              </ul>
              
            </p>

            <p class="txt_center">
              <strong>Apr√®s am√©lioration: </strong>(bient√¥t disponible)
            </p>

          <h3 id="3-test2">3. R√©sultats et d√©monstration</h3>
            <p>
              Apr√®s plusieurs tests et modifications, nous sommes parvenus √† r√©aliser le syst√®me de convoyeur r√©pondant au cahier de charge.
              En effet, le convoyeur respecte les <strong>contraintes de dimension</strong>(longueur et hauteur).
              Le tapis du convoyeur reste <strong>immobile</strong> et <strong>ne se meut que</strong> le syst√®me d√©tecte des d√©chets.
              Ensuite, les d√©chets sont <strong>identifi√©</strong> lorsqu'ils passent dans la zone du capteur de couleur. 
              Ils  seront <strong>collect√©s manuellement</strong> √† la fin du convoyeur et <strong>mis dans la berne</strong> indiqu√©e par le syst√®me.
              Nous avons aussi mis en place une <strong>interface web</strong> pour permettre un suivi en temps r√©el du tri des d√©chets.
            </p>
            <p>
              Voici des images et videos montrant notre travail:
            </p>

            <p class="txt_center"><strong>Avant am√©lioration:</strong></p>
            <div class="image-container">
              <img src="images/Test4_2/Convoyeur/realisation8.jpg" alt="realisation" class="image-small"/>
            </div>

            <video controls width=auto>
              <source src="videos/Test4_2/Convoyeur/demo1.mp4" type="video/mp4">
              Votre navigateur ne supporte pas la vid√©o HTML5.
            </video>

            <p class="txt_center"><strong>Apr√®s am√©lioration:</strong>(bient√¥t disponible)</p>
            <div class="image-container">
              <img src="images/Test4_2/Convoyeur/realisation9.jpg" alt="realisation" class="image-small"/>
            </div>

            <video controls width=auto>
              <source src="videos/Test4_2/Convoyeur/demo2.mp4" type="video/mp4">
              Votre navigateur ne supporte pas la vid√©o HTML5.
            </video>


        </div>

        <div id="conclusion2" class="subtab-content">
          <h2 id="concl2" class="projet-titre">Conclusion et Annexes</h2>
          <h3 id="1-concl2">1. Conclusion et perspectives</h3>
            <h4>Conclusion</h4>
            <p>
              Ce projet de convoyeur intelligent s‚Äôinscrit dans une dynamique de modernisation des processus industriels en int√©grant des technologies issues de la m√©canique, de l‚Äô√©lectronique embarqu√©e et de l‚Äôinformatique. 
              √Ä travers ce syst√®me, nous avons d√©montr√© la possibilit√© de concevoir un dispositif autonome capable de d√©tecter, identifier, trier et comptabiliser des d√©chets selon leur couleur, 
              tout en assurant une visualisation en temps r√©el via une interface web conviviale.
            </p>
            <p>
              L‚Äôint√©gration r√©ussie des diff√©rents modules (capteurs, motorisation, contr√¥le Arduino, communication s√©rie, interface web) confirme la faisabilit√© technique du syst√®me. 
              Les tests ont permis de valider le bon fonctionnement global, avec une r√©activit√© satisfaisante, une pr√©cision correcte dans l‚Äôidentification des couleurs et une visualisation instantan√©e des donn√©es.
            </p>
            <h4>Perspectives</h4>
              <p>
                Afin d‚Äôam√©liorer et de faire √©voluer ce syst√®me, plusieurs pistes peuvent √™tre envisag√©es :
                <ul>
                  <li>
                    Tri physique automatis√© : 
                    Ajouter des actionneurs (comme des bras ou des trappes motoris√©es) 
                    pour permettre un tri automatique dans les bacs, sans intervention humaine.
                  </li>
                  <li>
                    Reconnaissance avanc√©e : Int√©grer des capteurs plus pr√©cis 
                    ou une cam√©ra avec vision par ordinateur pour reconna√Ætre non seulement la couleur, mais aussi la forme ou la mati√®re du d√©chet.
                  </li>
                  <li>
                    Interface distante : Permettre un acc√®s √† distance √† l‚Äôinterface via le cloud, 
                    pour un suivi en temps r√©el depuis n‚Äôimporte quel appareil connect√©.
                  </li>
                </ul>
              </p>
              <p>
                Ce projet, en plus de sa port√©e p√©dagogique, constitue une base solide pour des applications concr√®tes dans le domaine du tri des d√©chets, 
                contribuant ainsi √† une gestion plus durable des ressources.
              </p>
          <h3 id="2-concl2">2. Annexes</h3>
            <p>
              Fiches techniques des composants √©lectroniques:
            </p>
              <ul>
                <li>
                  Microcontr√¥leur: 
                  <a href="https://docs.arduino.cc/resources/datasheets/A000005-datasheet.pdf" target="_blank">Arduino nano</a>
                </li>
                <li>
                  Capteur de couleur: 
                  <a href="https://www.mouser.com/catalog/specsheets/tcs3200-e11.pdf?srsltid=AfmBOoryK8wKLsTUaZK-DPXlDA7PPmU7zvHeu1G3dqKgPZAXs0rpiqxm" target="_blank">TCS230/TCS3200</a>
                </li>
                <li>
                  Capteur Ultrason: 
                  <a href="https://www.robot-maker.com/shop/img/cms/datasheet-capteur-ultrasons-hc-sr04.pdf" download target="_blank">HC-SR04</a>
                </li>
                <li>
                  Capteur infrarouge: 
                  <a href="https://www.vishay.com/docs/83760/tcrt5000.pdf" download target="_blank">TRCT5000</a>
                </li>
                <li>
                  Affichage visuelle: 
                  <a href="https://www.electronicoscaldas.com/datasheet/LED5D-RGB-CA.pdf?srsltid=AfmBOoqs7qaS3Igqh4KOchV5kW2dMOhyP29FHSZP3KxMu2uM1ZmHUj3s" download target="_blank">LED RGB</a>
                </li>
                <li>
                  Module Wi-Fi: 
                  <a href="https://academy.cba.mit.edu/classes/networking_communications/ESP8266/esp01.pdf" download target="_blank">ESP-01</a>
                </li>
                <li>
                  Module Buck: 
                  <a href="https://cdn-shop.adafruit.com/datasheets/MP2307_r1.9.pdf" download target="_blank">MP2307</a>
                </li>
              </ul>
        </div>

      </section>
    </main>
  </div>

  <footer>
    Copyright ¬© 2025 Team B2MS CleanTech. All rights reserved.
  </footer>

  <script src="scripts/script_commun.js"></script>
  <script src="scripts/script_code.js"></script>
</body>
</html>
