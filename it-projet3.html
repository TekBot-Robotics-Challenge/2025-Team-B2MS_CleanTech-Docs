<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css"
    />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles/style-commun.css" />
  <link rel="stylesheet" href="styles/style-code.css" />
  <title>D√©partement IT ‚Äì B2MS CleanTech</title>
</head>
<body>
  <header class="header">
    <div class="section__container header__container_domaine">
      <h2>D√©partement IT</h2>
    </div>
  </header>

  <div class="layout-container">
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="sidebar-toggle" id="sidebarToggle">
        <i class="fas fa-bars"></i>
      </div>

      <nav class="main-nav">
        <a href="./" class="nav-link"><i class="fas fa-home"></i> Accueil</a>

        <div class="nav-section">
          <a href="./it" style="text-decoration: none;"><button class="tab-button active"><i class="fas fa-desktop"></i> IT</button> </a>       
          
          <div class="sub-links">
            <a class="subtab-button" href="./it-projet1">Projet 2</a>
            <a class="subtab-button" href="./it-projet2">Projet 3</a>
            <a href="./it-projet3" class="subtab-button active">Projet 3</a>
            <nav class="project-subnav active" id="subnav-test3">
              <a href="#1-test3">1. Contexte et objectifs</a>
              <a href="#2-test3">2. Configurations n√©cessaires</a>
              <a href="#3-test3">3. Prise en main du package tekbot_sim</a>
              <a href="#4-test3">4. Navigation du robot</a>
              <a href="#5-test3">5. Conclusion</a>
              <a href="#6-test3">6. Ressources utiles</a>
            </nav>
          </div>
        </div>

        <a href="./electronique" class="nav-link"><i class="fas fa-microchip"></i> √âlectronique</a>
        <a href="./mecanique" class="nav-link"><i class="fas fa-cogs"></i> M√©canique</a>
        <a href="./convoyeur" class="nav-link"></i><i class="fas fa-robot"></i> Convoyeur</a>
      </nav>
    </div>

    <!-- Contenu principal -->
    <main class="main-content">
      <section id="it-content" class="tab-content active">
        <div id="test3" class="subtab-content active">
          <h2 id="projet3" class="projet-titre">Projet 3 ‚Äì Algorithme de Pathfinding</h2>

          <h3 id="1-test3">1. Contexte et objectifs:</h3>
          <p>
            Avec l‚Äôessor des robots mobiles autonomes, la capacit√© √† naviguer efficacement
            dans des environnements complexes et dynamiques est devenue un enjeu majeur. 
            Pour permettre √† un robot de se d√©placer de mani√®re autonome, il est essentiel 
            de lui fournir un syst√®me de navigation capable de planifier des trajectoires 
            optimales tout en √©vitant les obstacles. 
          </p>
          <p>   
            <strong>ROS2</strong>, combin√© au simulateur <strong>Gazebo</strong>, offre un cadre complet pour d√©velopper, 
            tester et valider ces syst√®mes dans un environnement virtuel proche du r√©el. 
            Le robot TekBot, √©quip√© de capteurs et d‚Äôune configuration pr√™te √† l‚Äôemploi, 
            constitue une base id√©ale pour exp√©rimenter et impl√©menter des 
            <strong>algorithmes de pathfinding</strong> classiques dans un labyrinthe simul√©. 
          </p>
          <p>
            L‚Äôobjectif principal de ce projet est de cr√©er un syst√®me de navigation 
            autonome pour un robot mobile en utilisant:
          </p>
          <ul>
            <li><strong>ROS2 Humble</strong> sous Ubuntu 22.04</li>
            <li><strong>Gazebo Classic</strong>: simulateur 3D permettant de visualiser l'environnement et le robot</li>
            <li><strong>RViz</strong>: outil de visualisation pour les donn√©es et les capteurs ROS2.</li>
            <li><strong>SLAM Toolbox</strong>: utilis√© pour le mapping et la localisation simultan√©e. </li>
            <li><strong>Nav2</strong>: framework pour la navigation autonome, int√©grant le pathfinding et l'√©vitement d'obstacles.</li>
          </ul>

          <h3 id="2-test3">2. Configurations n√©cessaires</h3>
          <p>
            ROS2, Rviz et Gazebo √©tant d√©j√† install√©s, il ne reste qu'√† y ajouter les packages manquants
          </p>

          <ul>
            <li><strong>mise √† jour</strong>:</li>
              <div class="code-container">
                <div class="btn-bar">
                  <button onclick="copierCode('test3_T1', this)">üìã</button>
            </div>
            <pre><code id="test3_T1">
  user@user:~$ sudo apt update
  user@user:~$ sudo apt upgrade
                </code></pre>
              </div>
            <li><strong>teleop_joy</strong>:</li>
              <div class="code-container">
                <div class="btn-bar">
                  <button onclick="copierCode('test3_T2', this)">üìã</button>
            </div>
            <pre><code id="test3_T2">
  user@user:~$ sudo apt install ros-humble-teleop-twist-joy
                </code></pre>
              </div>
            <li><strong>robot_localization</strong>:</li>
              <div class="code-container">
                <div class="btn-bar">
                  <button onclick="copierCode('test3_T3', this)">üìã</button>
            </div>
            <pre><code id="test3_T3">
  user@user:~$ sudo apt install ros-humble-robot-localization
                </code></pre>
              </div>
            <li><strong>rqt</strong>:</li>
              <div class="code-container">
                <div class="btn-bar">
                  <button onclick="copierCode('test3_T4', this)">üìã</button>
            </div>
            <pre><code id="test3_T4">
  user@user:~$ sudo apt install ros-humble-rqt*
                </code></pre>
              </div>
              <li><strong>SLAM_toolbox</strong>:</li>
              <div class="code-container">
                <div class="btn-bar">
                  <button onclick="copierCode('test3_T5', this)">üìã</button>
            </div>
            <pre><code id="test3_T5">
  user@user:~$ sudo apt install ros-humble-slam-toolbox
                </code></pre>
              </div>
              <li><strong>Nav2</strong>:</li>
              <div class="code-container">
                <div class="btn-bar">
                  <button onclick="copierCode('test3_T6', this)">üìã</button>
            </div>
            <pre><code id="test3_T6">
  user@user:~$ sudo apt install ros-humble-navigation2 ros-humble-nav2-bringup
                </code></pre>
              </div>
          </ul>


          <h3 id="3-test3">3. Prise en main du package <strong>tekbot_sim</strong></h3>
            <p>
              Le robot et l'environnement sont mis √† disposition.
            </p>
            <ul>
            <li><strong>Clonage du metapackage tekbot_sim</strong> depuis GitHub: </li>
              <div class="code-container">
                <div class="btn-bar">
                  <button onclick="copierCode('test3_T7', this)">üìã</button>
            </div>
            <pre><code id="test3_T7">
  user@user:~$ git clone https://github.com/charif-tekbot/tekbot_sim.git
                </code></pre>
              </div>
            <li><strong>Compilation et configuration</strong> du workspace: </li>
              <div class="code-container">
                <div class="btn-bar">
                  <button onclick="copierCode('test3_T8', this)">üìã</button>
            </div>
            <pre><code id="test3_T8">
  user@user:~$ cd tekbot_sim
  user@user:~/tekbot_sim$ chmod +x configure.sh (optional)
  user@user:~/tekbot_sim$ source configure.sh
                </code></pre>
              </div>
          </ul>

          <p>
            tekbot_ws contient plusieurs packages dont:
            <ul>
              <li><strong>maze_solving</strong>: pour l'environnement</li>
              <li><strong>tekbot</strong>: pour le robot(tekbot_control et tekbot_description)</li>
            </ul>
          </p>

          <div class="arbo">
            <ul>
                <li class="folder">tekbot_ws
                  <ul>
                    <li class="folder">build</li>
                    <li class="folder">install</li>
                    <li class="folder">log</li>

                    <li class="folder">src
                      <ul>
                        <li class="folder">tekbot_sim
                            <ul>
                                <li class="folder">maze_solving</li>
                                <li class="folder">tekbot
                                    <ul>
                                        <li class="folder">tekbot_control</li>
                                        <li class="folder">tekbot_description</li>
                                    </ul>
                                </li>
                                <li class="file">README.md</li>
                                <li class="file">configure.sh</li>
                        </li>
                      </ul>
                    </li>
                  </ul>
                </li>
              </ul>
            </div>

          
          <h4><strong>a. L'environnement</strong></h4>
          <p>
            L'environnement dans lequel le robot √©voluera est contenu dans le package maze_solving. 
            Cet environnement comprend un labyrinthe adapt√© pour les tests de navigation et 
            d'√©vitement d'obstacles. Les simulations s'ex√©cutent principalement dans Gazebo, un 
            simulateur robotique 3D. Pour le lancer avec le robot:
          </p>
          <div class="code-container">
            <div class="btn-bar">
              <button onclick="copierCode('test3_T9', this)">üìã</button>
            </div>
            <pre><code id="test3_T9">
  user@user:~/tekbot_ws$ source install/setup.bash
  user@user:~/tekbot_ws$ ros2 launch maze_solving tekbot_maze.launch.py
            </code></pre>
          </div>
          <div class="image-container">
            <img src="images/Test3/IT/gazebo.webp" alt="gazebo" class="image-mean"/>
            <p>
              Gazebo simulant le robot dans un labyrinthe
            </p>
          </div>
          <div class="image-container">
            <img src="images/Test3/IT/rqt.webp" alt="gazebo" class="image-mean"/>
            <p>
              rqt_graph montrant les nodes et topics
            </p>
          </div>

          <p>
            Le package maze_solving contient d'autres launchers:
          </p>
          <div class="image-container">
            <img src="images/Test3/IT/maze.webp" alt="maze" class="image-mean"/>
          </div>
          

          <h4><strong>b. Le robot</strong></h4>
          <p>
            Le robot est pr√©construit avec des capteurs int√©gr√©s 
            permettant de naviguer dans des environnements simul√©s.
          </p>
          <p>
            Sa configuration est pr√©d√©finie dans le package <strong>tekbot_description</strong>.
          </p>
          <p>
            Et il est possible de le commander gr√¢ce au package <strong>tekbot_control</strong> bas√© sur teleop_joy.
          </p>

          <div class="image-container">
            <img src="images/Test3/IT/tekbot1.webp" alt="arborescence" class="image-small"/>
            <img src="images/Test3/IT/tekbot2.webp" alt="arborescence" class="image-small"/>
          </div>
            
        <h3 id="4-test3">4. Navigation du robot</h3>
            <p>
              Le package <strong>tekbot_navigation</strong> a √©t√© cr√©e afin de travailler 
              sur la navigation du robot dans le labyrinthe.
            </p>

            <p>
              Cette partie se divise en deux √©tapes:
              <ul>
                <li><strong>Mapping</strong>: l'environnement est cartographi√©e manuellement.</li>
                <li><strong>Navigation autonome</strong>: le robot se d√©place juste en indiquant le point d'arriver.</li>
              </ul>

              <div class="arbo">
                <ul>
                  <li class="folder">tekbot_ws/src/tekbot_sim
                    <ul>
                        <li class="folder">maze_solving</li>
                        <li class="folder">tekbot
                        <li class="folder">tekbot_navigation</li>
                        <li class="file">README.md</li>
                        <li class="file">configure.sh</li>
                    </ul> 
                  </li>
                </ul>
              </div>

              <p>
                <strong>NB:</strong> Pour une meilleure lisibilit√© et accessibilit√©, nous avons utilis√© des <strong>launcher</strong> dans chacune de ces √©tapes.
              </p>

              <h4>a. Mapping de l'environnement</h4>
              <p>
                <strong>SLAM_toolbox</strong> a permis de cartographier le labyrinthe.
              </p>
              <p>
                N'ayant pas de manette(n√©cessaire pour commander le robot via <strong>teleop_joy</strong>), 
                nous nous sommes rabattus sur <strong>teleop_twist_keyboard</strong>, 
                ce qui nous a permis de controller le robot avec le clavier.
              </p>

              <p>
                Le launcher <strong>tekbot_mapping2_b2ms.launch.py</strong> permet de lancer avec des configurations sp√©cifiques:
                <ul>
                  <li>
                    <strong>SLAM_toolbox</strong>: 
                    <ul>
                      <li>online_async_launch.py: donn√©es en temps r√©el et traitement de scans non bloquant(plus fluide)</li>
                      <li>use_sim_time: true (utilise le temps de simulation)</li>
                    </ul>
                  </li>
                  <li>
                    <strong>RVIZ2</strong>: 
                    <ul>
                      <li>
                        tekbot_config_b2ms.rviz: configuration initiale pour RViz: 
                        <ul>
                          <li>map sur le topic /map,</li>
                          <li>TF: map et basic_link,</li>
                          <li>RobotModel: visualisation du robot,</li>
                          <li>Laserscan sur /scan: visualisation des donn√©es des capteurs.</li>
                        </ul>
                      </li>
                      <li>use_sim_time: true (utilise le temps de simulation)</li>
                    </ul>
                  </li>
                </ul>
              </p>
              <div class="code-container">
                <p>
                  <strong>tekbot_mapping2_b2ms.launch.py</strong>
                </p>
                <div class="btn-bar">
                  <button onclick="copierCode('tekbot_mapping2_b2ms-py', this)">üìã</button>
                  <button onclick="telechargerCode('tekbot_mapping2_b2ms-py', 'tekbot_mapping2_b2ms.launch.py', 'text/py', this)">ü°á</button>
                </div>
                <pre><code id="tekbot_mapping2_b2ms-py">
    from launch import LaunchDescription
    from launch_ros.actions import Node
    from launch.actions import IncludeLaunchDescription
    from launch.substitutions import PathJoinSubstitution
    from launch_ros.substitutions import FindPackageShare
    from launch.launch_description_sources import PythonLaunchDescriptionSource

    def generate_launch_description():

        # Fichier de config RViz
        rviz_config_file = PathJoinSubstitution([
            FindPackageShare("tekbot_navigation"),
            "rviz",
            "tekbot_config_b2ms.rviz"
        ])

        # Lancement de slam_toolbox avec use_sim_time activ√©
        slam_toolbox_launch = IncludeLaunchDescription(
            PythonLaunchDescriptionSource([
                PathJoinSubstitution([
                    FindPackageShare("slam_toolbox"),
                    "launch",
                    "online_async_launch.py"
                ])
            ]),
            launch_arguments={'use_sim_time': 'true'}.items()
        )

        return LaunchDescription([
            slam_toolbox_launch,

            Node(
                package='rviz2',
                executable='rviz2',
                name='rviz2',
                output='screen',
                parameters=[{'use_sim_time': True}],
                arguments=['-d', rviz_config_file]
            )
        ])
                </code></pre>
              </div>

             
              <ul>
                <li>Terminal 1: lancement de tekbot_maze.launch.py</li>
                <div class="code-container">
                  <div class="btn-bar">
                    <button onclick="copierCode('0', this)">üìã</button>
            </div>
            <pre><code id="test3_T10">
  user@user:~/tekbot_ws$ colcon build --symlink-install
  user@user:~/tekbot_ws$ source install/setup.bash
  user@user:~/tekbot_ws$ ros2 launch maze_solving tekbot_maze.launch.py
                  </code></pre>
                </div>

                <li>Terminal 2: lancement de tekbot_mapping2_b2ms.launch.py</li>
                <div class="code-container">
                  <div class="btn-bar">
                    <button onclick="copierCode('test3_T11', this)">üìã</button>
            </div>
            <pre><code id="test3_T11">
  user@user:~/tekbot_ws$ source install/setup.bash
  user@user:~/tekbot_ws$ ros2 launch tekbot_navigation tekbot_mapping2_b2ms.launch.py
                  </code></pre>
                </div>

                <li>Terminal 3: execution de teleop_twist_keyboard</li>
                <div class="code-container">
                  <div class="btn-bar">
                    <button onclick="copierCode('test3_T12', this)">üìã</button>
            </div>
            <pre><code id="test3_T12">
  user@user:~/tekbot_ws$ ros2 run teleop_twist_keyboard teleop_twist_keyboard
                  </code></pre>
                </div>
              </ul>

              <video controls width=auto>
                <source src="videos/Test3/IT/Mapping.mp4" type="video/mp4">
                Votre navigateur ne supporte pas la vid√©o HTML5.
              </video>

              <div class="image-container">
                <img src="images/Test3/IT/map.webp" alt="carte" class="image-mean"/>
                <p>
                  La carte g√©n√©r√©e a √©t√© sauvergad√©e dans <strong>tekbot_ws</strong> 
                  puis d√©plac√©e dans <strong>tekbot_ws/src/tekbot_sim/tekbot_navigation/maps/</strong> 
                </p>
              </div>
              
            <h4>b. Navigation autonome</h4>
              <p>
                Pour la cette √©tape, nous avons utilis√©:
                <ul>
                  <li><strong>Nav2</strong>: permet de planifier et de suivre les trajectoires sur la carte</li>
                  <li><strong>AMCL</strong>(Adaptive Monte Carlo localization): localise le robot</li>
                </ul>
              </p>
            
              <p>
                Le launcher <strong>tekbot_nav_b2ms.launch.py</strong> permet de lancer avec des configurations sp√©cifiques:
                <ul>
                  <li>
                    <strong>AMCL</strong>: 
                    <ul>
                      <li>localization_launch.py: localization du robot en temps r√©el</li>
                      <li>map: tekbot_map.yaml (carte g√©n√©r√©e par SLAM_toolbox)</li>
                      <li>use_sim_time: true (utilise le temps de simulation)</li>
                    </ul>
                  </li>
                  <li>
                    <strong>Nav2</strong>: 
                    <ul>
                      <li>navigation_launch.py: itin√©raire et calcul de navigation</li>
                      <li>map_subscriber_transient_local: true (permet aux nodes de recevoir la carte publi√©e par le map_server)</li>
                      <li>use_sim_time: true (utilise le temps de simulation)</li>
                    </ul>
                  </li>
                  <li>
                    <strong>RVIZ2</strong>: 
                    <ul>
                      <li>
                        tekbot_config_nav_b2ms.rviz: 
                        <ul>
                          <li>premier map sur le topic /map(affichage de la carte cartographi√©e),</li>
                          <li>deuxi√®me map sur le topic /global_costmap/costmap_updates,</li>
                          <li>TF: map et basic_link,</li>
                          <li>RobotModel: visualisation du robot,</li>
                          <li>Laserscan sur /scan: visualisation des donn√©es des capteurs.</li>
                          <li>Path: sur le topic /plan(visualisation du chemin calcul√© par l'algorithme)</li>
                        </ul>
                      </li>
                      <li>use_sim_time: true (utilise le temps de simulation)</li>
                    </ul>
                  </li>
                </ul>
              </p>

              <div class="code-container">
                <p>
                  <strong>tekbot_nav_b2ms.launch.py</strong>
                </p>
                <div class="btn-bar">
                  <button onclick="copierCode('tekbot_nav_b2ms-py', this)">üìã</button>
                  <button onclick="telechargerCode('tekbot_nav_b2ms-py', 'tekbot_nav_b2ms.launch.py', 'text/py', this)">ü°á</button>
                </div>
                <pre><code id="tekbot_nav_b2ms-py">
    from launch import LaunchDescription
    from launch_ros.actions import Node
    from launch.actions import IncludeLaunchDescription
    from launch.substitutions import PathJoinSubstitution
    from launch_ros.substitutions import FindPackageShare
    from launch.launch_description_sources import PythonLaunchDescriptionSource


    def generate_launch_description():

        # Chemin du fichier RViz
        rviz_config_file = PathJoinSubstitution([
            FindPackageShare("tekbot_navigation"),
            "rviz",
            "tekbot_config_nav_b2ms.rviz"
        ])

        # Chemin de la carte YAML
        my_map = PathJoinSubstitution([
            FindPackageShare("tekbot_navigation"),
            "maps",
            "tekbot_map.yaml"
        ])

        # Lancement de la localisation (amcl)
        nav2_launch_localization = IncludeLaunchDescription(
            PythonLaunchDescriptionSource([
                PathJoinSubstitution([
                    FindPackageShare("nav2_bringup"),
                    "launch",
                    "localization_launch.py"
                ])
            ]),
            launch_arguments={
                'use_sim_time': 'true',
                'map': my_map
            }.items()
        )

        # Lancement de la navigation
        nav2_launch_navigation = IncludeLaunchDescription(
            PythonLaunchDescriptionSource([
                PathJoinSubstitution([
                    FindPackageShare("nav2_bringup"),
                    "launch",
                    "navigation_launch.py"
                ])
            ]),
            launch_arguments={
                'use_sim_time': 'true',
                'map_subscriber_transient_local': 'true'
            }.items()
        )

        # Lancement de RViz
        rviz_node = Node(
            package='rviz2',
            executable='rviz2',
            name='rviz2',
            output='screen',
            parameters=[{'use_sim_time': True}],
            arguments=['-d', rviz_config_file]
        )

        return LaunchDescription([
            nav2_launch_localization,
            nav2_launch_navigation,
            rviz_node
        ])
                </code></pre>
              </div>

             
              <ul>
                <li>Terminal 1: lancement de tekbot_maze.launch.py</li>
                <div class="code-container">
                  <div class="btn-bar">
                    <button onclick="copierCode('test3_T13', this)">üìã</button>
            </div>
            <pre><code id="test3_T13">
  user@user:~/tekbot_ws$ colcon build --symlink-install
  user@user:~/tekbot_ws$ source install/setup.bash
  user@user:~/tekbot_ws$ ros2 launch maze_solving tekbot_maze.launch.py
                  </code></pre>
                </div>

                <li>Terminal 2: lancement de tekbot_nav_b2ms.launch.py</li>
                <div class="code-container">
                  <div class="btn-bar">
                    <button onclick="copierCode('test3_T14', this)">üìã</button>
            </div>
            <pre><code id="test3_T14">
  user@user:~/tekbot_ws$ source install/setup.bash
  user@user:~/tekbot_ws$ ros2 launch tekbot_navigation tekbot_nav_b2ms.launch.py
                  </code></pre>
                </div>
              </ul>

              <video controls width=auto>
                <source src="videos/Test3/IT/Demo2.mp4" type="video/mp4">
                Votre navigateur ne supporte pas la vid√©o HTML5.
              </video>

              <p>
                Le robot effectue le trajet du point de d√©part √† la sortie du labyrinthe de mani√®re autonome.
              </p>

          <h4>Explication suppl√©mentaire(Notion sur <strong>Nav2</strong>)</h4>
              <p>
                Le package <strong>nav2_bringup</strong> est compos√© de plusieurs launcher, notamment:
                <ul>
                  <li>
                <strong>localization_launch.py</strong> qui permet de lancer AMCL pour la localisation d'un objet sur une carte, 
                  </li>
                  <li>
                 <strong>navigation2_launch.py</strong> qui permet de lancer plusieurs nodes pour la navigation.
                  </li>
                </ul> 
              </p>

              <p>
                <strong>planner_server</strong> est un des nodes de ROS2 lanc√© par <strong>navigation.launch.py</strong>.
                Son r√¥le est de calculer un chemin global depuis la position actuelle du robot (fournie par AMCL) jusqu‚Äô√† une destination donn√©e.
                Il utilise des algorithmes de pathfinding sur la carte d‚Äôoccupation pour g√©n√©rer ce chemin.
                Il peut utiliser diff√©rents algorithmes, selon la configuration.
              </p>

              <p>
                Nous avons opt√© pour les param√®tres par d√©faut.
                De ce fait, <strong>l'algorithme de pathfinding</strong> utilis√© par 
                <strong>planner_server</strong> est <strong>NavFnPlanner</strong> 
                qui est bas√© sur <strong>Dijkstra</strong>.
                Dijkstra explore tous les chemins pour trouver celui avec le co√ªt total le plus faible.
                Il est robuste, fiable et est suffisant pour notre simulation.
              </p>

              <p>
                Ces param√®tres par d√©faut sont dans le fichier ~/nav2_bringup/params/<strong>nav2_params.yaml</strong>.
                Pour l'adapter √† nos besoins, nous l'avons copi√© et modifi√©.
              </p>

              <div class="image-container">
                <img src="images/Test3/IT/nav2_params2.webp" alt="params" class="image-mean"/>
                <p>
                  Aper√ßu du fichier <strong>nav2_params.yaml</strong>
                </p>
              </div>
              

          <h4>c. R√©sultat final</h4>
            <p>
              Lors des tests, nous sommes oblig√©s d'initialiser √† chaque fois la position initale du robot 
              dans <strong>RVIZ2</strong> pour que <strong>AMCL</strong> se mette √† fonctionner.
              De m√™me pour la position finale.
              Ceci peut √™tre √©viter en initialisation les positions dans le launcher. 
            </p>
            <p>
              Par la m√™me occasion, nous avons inclus dans un seul launcher le lancement de tous les launchers pour 
              gazebo, rqt_graph, ...
            </p>
            <p>

            </p>

            <div class="code-container">
                <p>
                  <strong>tekbot_nav2_b2ms.launch.py</strong>
                </p>
                <div class="btn-bar">
                  <button onclick="copierCode('tekbot_nav2_b2ms-py', this)">üìã</button>
                  <button onclick="telechargerCode('tekbot_nav2_b2ms-py', 'tekbot_nav2_b2ms.launch.py', 'text/py', this)">ü°á</button>
                </div>
                <pre><code id="tekbot_nav2_b2ms-py">
    import os
    from launch import LaunchDescription
    from launch.actions import DeclareLaunchArgument, IncludeLaunchDescription, SetEnvironmentVariable
    from launch.launch_description_sources import PythonLaunchDescriptionSource
    from launch.substitutions import LaunchConfiguration, PathJoinSubstitution
    from launch_ros.actions import Node
    from launch_ros.substitutions import FindPackageShare
    from launch.actions import ExecuteProcess, TimerAction

    ARGUMENTS = [
        DeclareLaunchArgument('x_init',
                default_value='-2.5',
                description='robot initial x'),
        DeclareLaunchArgument('y_init',
                default_value='-0.5',
                description='robot initial y'),
        DeclareLaunchArgument('z_init',
                default_value='0.0',
                description='robot initial z'),
        DeclareLaunchArgument('yaw_init',
                default_value='0.0',
                description='robot initial yaw')
    ]

    def generate_launch_description():    

        tekbot_maze_launch = IncludeLaunchDescription(
        PythonLaunchDescriptionSource(
            [PathJoinSubstitution([
                FindPackageShare("maze_solving"),
                "launch",
                "tekbot_maze.launch.py"
            ])]
        ),
        launch_arguments={
            'x_init': LaunchConfiguration('x_init'),
            'y_init': LaunchConfiguration('y_init'),
            'z_init': LaunchConfiguration('z_init'),
            'yaw_init': LaunchConfiguration('yaw_init'),
        }.items()
    )


        # Chemin de la configuration de nav2 (avec Hybrid-A*)
        params_file = PathJoinSubstitution([
            FindPackageShare("tekbot_navigation"),
            "config",
            "nav2_params.yaml"
        ])


        # Chemin du fichier RViz
        rviz_config_file = PathJoinSubstitution([
            FindPackageShare("tekbot_navigation"),
            "rviz",
            "tekbot_config_nav_b2ms.rviz"
        ])

        # Chemin de la carte YAML
        my_map = PathJoinSubstitution([
            FindPackageShare("tekbot_navigation"),
            "maps",
            "tekbot_map.yaml"
        ])

        # Lancement de la localisation (amcl)
        nav2_launch_localization = IncludeLaunchDescription(
            PythonLaunchDescriptionSource([
                PathJoinSubstitution([
                    FindPackageShare("nav2_bringup"),
                    "launch",
                    "localization_launch.py"
                ])
            ]),
            launch_arguments={
                'use_sim_time': 'true',
                'map': my_map,
            }.items()
        )


        nav2_launch_navigation = IncludeLaunchDescription(
            PythonLaunchDescriptionSource([
                PathJoinSubstitution([
                    FindPackageShare("nav2_bringup"),
                    "launch",
                    "navigation_launch.py"
                ])
            ]),
            launch_arguments={
                'use_sim_time': 'true',
                'params_file': params_file,
                'map_subscriber_transient_local': 'true'
            }.items()
        )

        # Lancement de RViz
        rviz_node = Node(
            package='rviz2',
            executable='rviz2',
            name='rviz2',
            output='screen',
            parameters=[{'use_sim_time': True}],
            arguments=['-d', rviz_config_file]
        )


        # donne la position initiale apr√®s 3s via /initialpose
        publish_initialpose = TimerAction(
        period=3.0,  
        actions=[
            ExecuteProcess(
            cmd=[
                'ros2', 'topic', 'pub', '--once', '/initialpose', 'geometry_msgs/msg/PoseWithCovarianceStamped',
                '{header: {frame_id: "map"}, pose: {pose: {position: {x: -2.5, y: -0.5, z: 0.0}}}}'
            ],
            output='screen'
            )
            ]
        )
      
        # donne la position √† atteindre apr√®s 6s via /goal_pose
        publish_goalpose = TimerAction(
        period=6.0,  
        actions=[
            ExecuteProcess(
            cmd=[
                'ros2', 'topic', 'pub', '--once', '/goal_pose', 'geometry_msgs/msg/PoseStamped',
                '{header: {frame_id: "odom"}, pose: {position: {x: 2.5, y: 2.5, z: 0.0}, orientation: {x: 0.0, y: 0.0, z: 0.0, w: 1.0}}}'
            ],
            output='screen'
            )
            ]
        )
        
        
        # Create the launch description and populate
        ld = LaunchDescription(ARGUMENTS)
        
        ld.add_action(tekbot_maze_launch)


        ld.add_action(nav2_launch_localization)
        ld.add_action(nav2_launch_navigation)
        ld.add_action(rviz_node)

        ld.add_action(publish_initialpose) 
        ld.add_action(publish_goalpose) 

        return ld
                </code></pre>
              </div>

            <video controls width=auto>
              <source src="videos/Test3/IT/Demo_final.mp4" type="video/mp4">
              Votre navigateur ne supporte pas la vid√©o HTML5.
            </video>

            <p  class="txt_center">
              <a href="https://github.com/TekBot-Robotics-Challenge/2025-Team-B2MS_CleanTech-Docs/tree/main/Test3/IT/tekbot_sim" target="_blank">lien vers le repository github</a>
            </p>


        <h3 id="5-test3">5. Conclusion</h3>    
          <p>
            Ce projet permet d‚Äô√©valuer la ma√Ætrise des concepts fondamentaux de la navigation 
            autonome gr√¢ce √† <strong>SLAM</strong> et <strong>Nav2</strong> 
            qui garantissent une navigation s√ªre et optimale dans un environnement complexe.
          </p>
          <p>
            La simulation d‚Äôun robot mobile √† l'aide de <strong>Gazebo</strong> dans un labyrinthe 
            a permis de valider et d'affiner les performances de ces outils.
          </p>
          <p>
            Ce travail constitue une √©tape cl√© vers le d√©veloppement de robots mobiles autonomes 
            capables d‚Äô√©voluer avec succ√®s dans des espaces structur√©s et dynamiques.
          </p>

          <h3 id="6-test3">6. Ressources utiles</h3>
            <p>
              <ul>
                <li>
                  ROS2 Documentation: <a href="https://docs.ros.org/en/kilted/index.html" target="_blank">https://docs.ros.org/en/kilted/index.html</a>
                </li>
                <li>
                  Metapackage tekbot_sim : <a href="https://github.com/charif-tekbot/tekbot_sim" target="_blank">lien vers le repository github</a>
                </li>
              </ul>
            </p>

        </div>

      </section>
    </main>
  </div>

  <footer>
    Copyright ¬© 2025 Team B2MS CleanTech. All rights reserved.
  </footer>

  <script src="scripts/script_commun.js"></script>
  <script src="scripts/script_code.js"></script>
</body>
</html>
