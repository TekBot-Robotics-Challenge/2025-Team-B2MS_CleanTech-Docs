<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css"
    />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../styles/style-commun.css" />
  <link rel="stylesheet" href="../styles/style-code.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/srcery.min.css">
  <link rel="icon" type="image/x-icon" href="../logo/favicon.ico">
  <title>Syst√®me de convoyeur - B2MS CleanTech</title>
</head>
<body>
  <header class="header">
    <div class="section__container header__container_domaine">
      <h2>Syst√®me de convoyeur</h2>
    </div>
  </header>

  <div class="layout-container">
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="sidebar-toggle" id="sidebarToggle">
        <i class="fas fa-bars"></i>
      </div>

      <nav class="main-nav">
        <a href=".././" class="nav-link"><i class="fas fa-home"></i> Accueil</a>
        <a href="./it" class="nav-link"><i class="fas fa-desktop"></i> IT</a>
        <a href="./electronique" class="nav-link"><i class="fas fa-microchip"></i> √âlectronique</a>
        <a href="./mecanique" class="nav-link"><i class="fas fa-cogs"></i> M√©canique</a>

        <div class="nav-section">
          <a href="./convoyeur" style="text-decoration: none;"><button class="tab-button active"><i class="fas fa-forward"></i> Convoyeur</button> </a>       
          <div class="sub-links">
            <a class="subtab-button" href="./convoyeur-meca">Partie m√©canique</a>
            <a class="subtab-button active" href="./convoyeur-electro">Partie √©lectronique</a>
            <nav class="project-subnav active" id="subnav-electro">
              <a href="#1-electro">1. Cahier de charge √©lectronique</a>
              <a href="#2-electro">2. Sch√©ma synoptique</a>
              <a href="#3-electro">3. Description fonctionnelle </a>
              <a href="#4-electro">4. Tests et validation</a>
              <a href="#5-electro">5. R√©alisation du PCB</a>
              <a href="#6-electro">6. Prototype final</a>
            </nav>
            <a class="subtab-button" href="./convoyeur-it">Partie informatique</a>
            <a class="subtab-button" href="./convoyeur-validation">Tests et validation</a>
          </div>
        </div>
        <a href="./trc25" class="nav-link"><i class="fas fa-robot"></i> TRC25</a>
      </nav>
    </div>

    <!-- Contenu principal -->
    <main class="main-content">
      <section id="convoyeur-content" class="tab-content active">
        <div id="electronique" class="subtab-content active">
          <h2 id="electro" class="projet-titre">Partie √©lectronique - Syst√®me de convoyeur</h2>
          <h3 id="1-electro">1. Cahier de charge √©lectronique</h3>
            <p>
            Dans le cadre d‚Äôun projet final en syst√®mes embarqu√©s, le but est de concevoir un <strong>syst√®me automatis√© de tri de d√©chets</strong> 
            inspir√© des proc√©d√©s industriels de recyclage.
            </p> 
            
            <h4>a. Objectifs fonctionnels</h4>
              <ul>
                <li>D√©tecter la pr√©sence d‚Äôun objet/d√©chet sur la bande.</li>
                <li>Mettre en mouvement la bande uniquement si un d√©chet est d√©tect√©.</li>
                <li>D√©tecter la couleur de l‚Äôobjet (cube) en mouvement.</li>
                <li>Afficher la couleur via une LED RGB.</li>
                <li>Transmettre la couleur d√©tect√©e √† une interface web via Wi-Fi.</li>
              </ul>

            <h4>b. Contraintes techniques</h4>
              <ul>
                <li>Alimentation sur 3 piles Li-ion 3,7V (‚âà11,1V).</li>
                <li>Conversion de tension via module buck MP2307 vers 5V.</li>
                <li>Circuit centr√© sur une Arduino Nano.</li>
                <li>Capteurs aliment√©s en 5V.</li>
                <li>Utilisation minimale de composants externes (driver moteur simple par MOSFET). </li>
              </ul>

            <h4>c. Composants utilis√©s</h4>
              <table>
                <tbody>
                  <tr>
                    <td><strong>Arduino Nano</strong></td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td><strong>Capteur √† ultrasons HC-SR04</strong></td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td><strong>Capteur de couleur TCS230</strong></td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td><strong>Capteur infrarouge</strong></td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td><strong>LED RGB</strong></td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td><strong>Moteur DC 6-12V</strong></td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td><strong>Module WiFi (ESP-01)</strong></td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td><strong>MOSFET canal N (IRFZ44N)</strong></td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td><strong>R√©gulateur buck MP2307</strong></td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td><strong>Boutons poussoirs</strong></td>
                    <td>2</td>
                  </tr>
                  <tr>
                    <td><strong>Interrupteur</strong></td>
                    <td>1</td>
                  </tr>                 
                  <tr>
                    <td><strong>Diode de roue libre (1N4007)</strong></td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td><strong>R√©sistances, c√¢blage</strong></td>
                    <td>-</td>
                  </tr>
                </tbody>
            </table>

          <h3 id="2-electro">2. Sch√©ma synoptique</h3>
            <div class="image-container">
              <img src="../images/Test4/Electronique/schema_synoptique.webp" alt="schema_synoptique" class="image-mean"/>
            </div>
    
          <h3 id="3-electro">3. Description fonctionnelle des blocs</h3>
             <h4>a. Le microcontr√¥leur(Arduino Nano)</h4>
              <p>
                L'<a href="https://docs.arduino.cc/resources/datasheets/A000005-datasheet.pdf" target="_blank">Arduino nano</a> 
                est une carte microcontr√¥leur compacte et polyvalente bas√©e sur l'ATmega328P. 
                Ses broches et ses caract√©ristiques techniques lui conf√®rent de nombreuses fonctionnalit√©s.
              </p>

              <p>
                Il constitue le c≈ìur de notre syst√®me. 
                C‚Äôest lui qui re√ßoit l‚Äôensemble des donn√©es issues des capteurs et qui pilote les diff√©rents actionneurs : 
                l‚Äô√©clairage <strong>RGB</strong>, le <strong>moteur</strong> (pour le d√©marrage et l‚Äôarr√™t du tapis), ainsi que les <strong>boutons</strong> de mise en marche et d‚Äôarr√™t du syst√®me.
                Sans ce composant central, aucun fonctionnement n‚Äôest possible.
              </p>
              <p>
                Son fonctionnement repose sur un programme √©crit en langage C, sp√©cifiquement con√ßu pour coordonner tous les √©l√©ments du syst√®me.
              </p>
              <p>
                Dans la suite du document, nous d√©taillerons le code ainsi que le sch√©ma de c√¢blage, en pr√©cisant √† quelles broches de l‚ÄôArduino Nano chaque capteur ou composant est connect√©.
              </p>
              <div class="image-container">
                <img src="../images/Test4/Electronique/arduino_nano.webp" alt="nano" class="image-mean"/>
              </div>

              <ul>
                <strong>Quelques caract√©ristiques:</strong>
              </ul>
              <table>
                <thead>
                  <tr>
                    <th></th>
                    <th>R√¥les</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><strong>Vin, 5V, 3.3V</strong></td>
                    <td>Alimentation</td>
                  </tr>
                  <tr>
                    <td><strong>Reset</strong></td>
                    <td>R√©initialisation du microcontr√¥leur.</td>
                  </tr>
                  <tr>
                    <td><strong>Broches analogiques(A0 ‚Äì A7)</strong></td>
                    <td>Entr√©e analogique</td>
                  </tr>
                  <tr>
                    <td><strong>Broches num√©riques (D0 ‚Äì D13)</strong></td>
                    <td>Entr√©e/Sortie num√©rique uniquement</td>
                  </tr>
                  <tr>
                    <td><strong>S√©rie (Rx, Tx)</strong></td>
                    <td>Transmission et la r√©ception de donn√©es s√©rie TTL</td>
                  </tr>
                  <tr>
                    <td><strong>PWM (3, 5, 6, 9, 11)</strong></td>
                    <td>Sortie PWM 8 bits</td>
                  </tr>
                  <tr>
                    <td><strong>SPI (10, 11, 12, 13)</strong></td>
                    <td>Communication SPI</td>
                  </tr>
                </tbody>
              </table>

            <h4>b. Bloc d'alimentation</h4>
              <p>
                Le syst√®me est aliment√© par <strong>trois batteries Li-Ion 3.7V</strong> mont√©es en s√©rie (tension totale ‚âà11.1V). 
                Cette tension alimente directement le moteur via le circuit MOSFET. 
                Pour alimenter les composants √©lectroniques en 5V, un <a href="https://cdn-shop.adafruit.com/datasheets/MP2307_r1.9.pdf" download target="_blank">module buck MP2307</a> est utilis√©. 
                Ce module convertit efficacement la tension 11.1V vers 5V avec un bon rendement.
              </p>
              <div class="image-container">
                <img src="../images/Test4/Electronique/alimentation.webp" alt="bloc_alimentation" class="image-mean"/>
                <img src="../images/Test4/Electronique/buck.webp" alt="bloc_alimentation" class="image-small"/>
              </div>
              <p>
                <ul>
                  <li><strong>Avantages du MP2307</strong>: faible √©chauffement, grande stabilit√©, courant jusqu‚Äô√† 2A. </li>
                </ul>
              </p>

              <h4>c. Les capteurs</h4>
              <h5>&#10022; Capteur √† ultrasons (HC-SR04)</h5>
                <p>
                  Le <a href="https://www.robot-maker.com/shop/img/cms/datasheet-capteur-ultrasons-hc-sr04.pdf" download target="_blank">capteur √† ultrasons HC-SR04</a> 
                  d√©termine la distance d‚Äôun objet par rapport √† sa position.
                  Il g√©n√®re un signal √† bande √©troite √† une fr√©quence de 40 kHz et capte le signal r√©fl√©chi(√©cho). 
                  Sur la base du temps de propagation du son vers et depuis l‚Äôobjet, la distance (en centim√®tres) peut √™tre d√©termin√©e assez pr√©cis√©ment.
                  Ce capteur permet donc de d√©tecter la pr√©sence d'une pi√®ce tout le long du convoyeur.                 
                </p>
                <div class="image-container">
                  <img src="../images/Test4/Electronique/ultrasonic.webp" alt="Ultrason" class="image-mean"/>
                </div>

                <p>
                  <ul>
                    <li>
                      <strong>TRIG</strong>(OUTPUT) envoie une impulsion √©lectrique de 10 microsecondes pour d√©clencher la mesure. 
                      Cette impulsion commande au capteur d‚Äô√©mettre une onde ultrasonore.
                    </li>
                    <li>
                      <strong>Echo</strong>(INPUT) re√ßoit l‚Äôonde ultrasonore r√©fl√©chie par un objet et passe √† l‚Äô√©tat HAUT pendant une dur√©e proportionnelle √† la distance mesur√©e. 
                      Cette dur√©e est utilis√©e pour calculer la distance entre le capteur et l‚Äôobjet.
                    </li>
                  </ul>
                </p>

                <div class="image-container">
                  <img src="../images/Test4/Electronique/circuit_ultrason.webp" alt="Ultrason" class="image-mean"/>
                </div>
                
                <div class="code-container">
                  <p>code_ultrasonic.ino </p>
                  <div class="btn-bar">
                    <button onclick="copierCode('code_ultrasonic-ino', this)">üìã</button>
                    <button onclick="telechargerCode('code_ultrasonic-ino', 'code_ultrasonic.ino', 'text/ino', this)">ü°á</button>
                  </div>
                  <pre><code class="hljs" id="code_ultrasonic-ino">
#define trigPin 5
#define echoPin 6

long distance = 0;  //stocke la distance calcul√©e

void setup() {
  pinMode(trigPin, OUTPUT); // Configurer trigPin en sortie
  pinMode(echoPin, INPUT); // Configurer echoPin en entr√©e
  Serial.begin(9600); // Initialiser la communication s√©rie √† 9600 bauds
}

void loop() {
  distance = getDistance(); 

  // Afficher la distance sur le moniteur s√©rie
  Serial.print("Distance: ");
  Serial.print(distance);
  Serial.println(" cm");

  delay(1000); // Attendre 1 seconde avant de refaire une lecture
}

long getDistance() {
  // Envoyer une impulsion de 10 ¬µs pour d√©clencher le capteur
  digitalWrite(trigPin, LOW);
  delayMicroseconds(2);
  digitalWrite(trigPin, HIGH);
  delayMicroseconds(10);
  digitalWrite(trigPin, LOW);

  // Mesurer la dur√©e de l'√©cho
  long duration = pulseIn(echoPin, HIGH);
  
  // Calculer la distance en cm
  long distance = (duration / 2) * 0.0344;  // Vitesse du son = 0.0344 cm/¬µs
  
  return distance;
}
                </code></pre>
              </div>

              <h5>&#10022; Capteur infrarouge</h5>
                <p>
                  Plac√© en bout de convoyeur, √† une distance ad√©quate, le <a href="https://www.vishay.com/docs/83760/tcrt5000.pdf" download target="_blank">capteur infrarouge TRCT5000</a> <strong>√©met un faisceau infrarouge</strong> √† courte port√©e √† l‚Äôaide d‚Äôune LED de 940 nm. 
                  Lorsqu‚Äôun objet s‚Äôapproche, la lumi√®re infrarouge est partiellement <strong>r√©fl√©chie vers un r√©cepteur photo√©lectrique int√©gr√©</strong>. 
                  Cette variation de lumi√®re permet au module de g√©n√©rer un signal num√©rique indiquant la pr√©sence ou l'absence d‚Äôun obstacle.
                </p>
                <p>
                  Compatible avec une alimentation de 3,3 V √† 5 V et consommant jusqu‚Äô√† 100 mA, le capteur s‚Äôadapte √† la plupart des microcontr√¥leurs. 
                  Il fonctionne √† une fr√©quence de 38 kHz, limitant les interf√©rences dues √† la lumi√®re ambiante, et peut op√©rer dans des temp√©ratures allant de -25 ¬∞C √† +55 ¬∞C.
                  Sa robustesse et sa pr√©cision en font un composant essentiel pour assurer un arr√™t pr√©cis du convoyeur en fin de cycle.
                </p>
                
                <p>
                  <strong>NB:</strong> le potentiom√®tre int√©gr√© permet d'ajuster la plage de d√©tection du module.
                </p>
                <div class="image-container">
                  <img src="../images/Test4/Electronique/infrared.webp" alt="infrared" class="image-mean"/>
                </div>

                <ul>
                  <strong>Sortie logique: </strong>
                  <li><strong>HIGH</strong> = objet d√©tect√©</li>
                  <li><strong>LOW</strong> = pas d‚Äôobjet</li>
                </ul>

                <p>
                  Ce capteur infrarouge est utilis√© pour d√©tecter l‚Äôarriv√©e d‚Äôune pi√®ce en fin de convoyage et d'arr√™ter le moteur. 
                </p>

                <div class="image-container">
                  <img src="../images/Test4/Electronique/circuit_infrared.webp" alt="infrared" class="image-mean"/>
                </div>

                <div class="code-container">
                  <p>code_infrarouge.ino </p>
                  <div class="btn-bar">
                    <button onclick="copierCode('code_infrarouge-ino', this)">üìã</button>
                    <button onclick="telechargerCode('code_infrarouge-ino', 'code_infrarouge.ino', 'text/ino', this)">ü°á</button>
                  </div>
                  <pre><code class="hljs" id="code_infrarouge-ino">
#define infraredSensor 19

int infraredValue = 0; //stocke la valeur du capteur infrarouge

void setup(){
    pinMode(infraredSensor, INPUT);
    Serial.begin(9600);
}

void loop(){
    infraredValue = digitalRead(infraredSensor);
    // affichage sur le moniteur
    Serial.print(" Valeur du capteur: ");
    Serial.println(infraredValue);
    delay(500);
}
                </code></pre>
              </div>

              <h5>&#10022; Le capteur de couleur TCS230/TCS3200</h5>
                <p>
                  Le <a href="https://www.mouser.com/catalog/specsheets/tcs3200-e11.pdf?srsltid=AfmBOoryK8wKLsTUaZK-DPXlDA7PPmU7zvHeu1G3dqKgPZAXs0rpiqxm" target="_blank">capteur de couleur TCS230/TCS3200</a> 
                  est un dispositif optique capable de d√©tecter la couleur dominante d‚Äôun objet. 
                  Il fonctionne en convertissant l‚Äôintensit√© lumineuse de la couleur per√ßue en un signal carr√© dont <strong>la fr√©quence varie selon la couleur d√©tect√©e</strong>.
                  Ce capteur est plus fiable et performant que le capteur de couleur 
                  <a href="https://www.mouser.com/datasheet/2/321/28380-ColorPAL-Documentation-370265.pdf?srsltid=AfmBOoqGq8vwQaI62oqMLZm4TdE2iRID73yldqJOA6wBk9wV9HYMWR5j" target="_blank"><strong>ColorPal</strong></a> utilis√© initialement.
                </p>
                <ul>
                  &#9673; <strong>Fonctionnement:</strong>
                  <li>
                    Le capteur est compos√© d'une matrice de 8√ó8 photodiodes, soit 64 au total: 3x16 photodiodes sensibles au rouge, vert, bleu, et 16 photodiodes sans filtre(blanc). 
                  </li>
                  <li>
                    Les photodiodes sont s√©lectionn√©es via les broches <strong>S2</strong> et <strong>S3</strong>, permettant de choisir la composante de couleur √† mesurer (R, G ou B).
                  </li>
                  <li>La sortie du capteur est fournie sur la broche <strong>OUT</strong>, sous forme d‚Äôun signal carr√© dont <strong>la fr√©quence est proportionnelle √† l‚Äôintensit√© de la couleur mesur√©e</strong>.</li>
                </ul>

                <ul>
                  &#9673; <strong>Brochage:</strong>
                  <table>
                    <thead>
                      <tr>
                        <th>Pin</th>
                        <th>R√¥le</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td><strong>VCC</strong></td>
                        <td>Alimentation(2.7-5.5V)</td>
                      </tr>
                      <tr>
                        <td><strong>GND</strong></td>
                        <td>Masse</td>
                      </tr>
                      <tr>
                        <td><strong>S0, S1</strong></td>
                        <td>Selection de l'√©chelle de fr√©quence de sortie</td>
                      </tr>
                      <tr>
                        <td><strong>S2, S3</strong></td>
                        <td>Selection du type de photodiode</td>
                      </tr>
                      <tr>
                        <td><strong>Out</strong></td>
                        <td>Sortie de fr√©quence</td>
                      </tr>
                      <tr>
                        <td><strong>OE</strong></td>
                        <td>Activer la sortie(actif bas)</td>
                      </tr>
                    </tbody>
                  </table>
                </ul>

                <ul>
                  &#9673; <strong>Utilisation avec un Arduino:</strong>
                  <li>
                    Lorsqu‚Äôun objet est plac√© devant le capteur, celui-ci mesure la lumi√®re r√©fl√©chie par l‚Äôobjet pour chaque composante de couleur (rouge, vert, bleu).
                  </li>
                  <li>
                    Le capteur envoie ensuite les fr√©quences mesur√©es √† l‚ÄôArduino, qui les analyse pour d√©terminer la couleur dominante.
                  </li>
                </ul>

                <table>
                    <thead>
                      <tr>
                        <th>S0</th>
                        <th>S1</th>
                        <th>Fr√©quence</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>LOW</td>
                        <td>LOW</td>
                        <td>0%</td>
                      </tr>
                      <tr>
                        <td>LOW</td>
                        <td>HIGH</td>
                        <td>2%</td>
                      </tr>
                      <tr>
                        <td>HIGH</td>
                        <td>LOW</td>
                        <td>20%</td>
                      </tr>
                      <tr>
                        <td>HIGH</td>
                        <td>HIGH</td>
                        <td>100%</td>
                      </tr>
                    </tbody>
                  </table>

                  <table>
                    <thead>
                      <tr>
                        <th>S2</th>
                        <th>S3</th>
                        <th>Filtre s√©l√©ctionn√©</th>
                        <th>Sensibilit√©</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>LOW</th>
                        <th>LOW</th>
                        <th>Rouge</th>
                        <th>Haute</th>
                      </tr>
                      <tr>
                        <th>LOW</th>
                        <th>HIGH</th>
                        <th>Bleu</th>
                        <th>Haute</th>
                      </tr>
                      <tr>
                        <th>HIGH</th>
                        <th>LOW</th>
                        <th>Sans filtre(clair)</th>
                        <th>Tr√®s haute</th>
                      </tr>
                      <tr>
                        <th>HIGH</th>
                        <th>HIGH</th>
                        <th>Vert</th>
                        <th>Haute</th>
                      </tr>
                    </tbody>
                  </table>

                <div class="image-container">
                  <img src="../images/Test4/Electronique/capteur_couleur.webp" alt="capteur_couleur" class="image-mean"/>
                </div>
                
                <!-- <div class="image-container">
                  <img src="../images/Test4/Electronique/circuit_sensorColor.webp" alt="capteur_couleur" class="image-mean"/>
                </div> -->
                
                <div class="code-container">
                  <p>code_tcs230.ino </p>
                  <div class="btn-bar">
                    <button onclick="copierCode('code_tcs230-ino', this)">üìã</button>
                    <button onclick="telechargerCode('code_tcs230-ino', 'code_tcs230.ino', 'text/ino', this)">ü°á</button>
                  </div>
                  <pre><code class="hljs" id="code_tcs230-ino">
// D√©finir les broches du capteur
#define S0 14
#define S1 15
#define S2 16
#define S3 17
#define sensorOut 18


void setup() {
  Serial.begin(9600); // Initialiser la communication s√©rie √† 9600 bauds
  pinMode(S0, OUTPUT); // D√©finir S0 comme sortie
  pinMode(S1, OUTPUT); // D√©finir S1 comme sortie
  pinMode(S2, OUTPUT); // D√©finir S2 comme sortie
  pinMode(S3, OUTPUT); // D√©finir S3 comme sortie
  pinMode(sensorOut, INPUT); // D√©finir sensorOut comme entr√©e


  // Configurer l'√©chelle de fr√©quence √† 20%
  digitalWrite(S0, HIGH);
  digitalWrite(S1, LOW);
}

void loop() {
  printColorFrequency();
  delay(500); // Attendre 500 ms avant la prochaine lecture
}

void printColorFrequency() {
  // Lire la valeur de la couleur rouge
  digitalWrite(S2, LOW); // Activer les photodiodes rouges
  digitalWrite(S3, LOW);
  int redFrequency = pulseIn(sensorOut, LOW); // Lire la fr√©quence de sortie pour le rouge
  Serial.print("Red: ");
  Serial.print(redFrequency);
  Serial.print("  ");


  // Lire la valeur de la couleur verte
  digitalWrite(S2, HIGH); // Activer les photodiodes vertes
  digitalWrite(S3, HIGH);
  int greenFrequency = pulseIn(sensorOut, LOW); // Lire la fr√©quence de sortie pour le vert
  Serial.print("Green: ");
  Serial.print(greenFrequency);
  Serial.print("  ");


  // Lire la valeur de la couleur bleue
  digitalWrite(S2, LOW); // Activer les photodiodes bleues
  digitalWrite(S3, HIGH);
  int blueFrequency = pulseIn(sensorOut, LOW); // Lire la fr√©quence de sortie pour le bleu
  Serial.print("Blue: ");
  Serial.println(blueFrequency);
}   
                </code></pre>
              </div>             

              <h4>d. Module Wi-Fi ESP01</h4>
                <p>
                  Le module Wi-Fi <a href="https://academy.cba.mit.edu/classes/networking_communications/ESP8266/esp01.pdf" download target="_blank">ESP-01</a>, 
                  permet aux microcontr√¥leurs de se connecter √† un r√©seau Wi-Fi. 
                  Dans notre projet, il est principalement utilis√© pour communiquer avec une <strong>interface web</strong> et transmettre des informations(la couleur detect√©e et l'√©tat du syst√®me).
                </p>
                <p>
                  <h5>&#10022; Configuration de l‚ÄôIDE Arduino pour l‚ÄôESP8266</h5>
                  Pour utiliser l‚ÄôESP8266 avec l‚ÄôIDE Arduino, il faut suivre les √©tapes suivantes :
                  <ul>
                    <li>Ajouter le support de la carte ESP8266: ajouter l‚ÄôURL(http://arduino.esp8266.com/stable/package_esp8266com_index.json) de la source ESP8266 dans les pr√©f√©rences de l‚ÄôIDE</li>
                    <li>Installer le package logiciel: rechercher et installer la biblioth√®que <strong>ESP8266</strong></li>
                    <li>S√©lectionner la carte: choisir "Generic ESP8266 Module"</li>
                  </ul>
                </p>

                  <h5>&#10022; Brochage de l‚ÄôESP-01 (ESP8266-01)</h5>
                  <table>
                  <thead>
                    <tr>
                      <th></th>
                      <th>R√¥les</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><strong>VCC</strong></td>
                      <td>Alimentation(<strong>3.3V</strong>)</td>
                    </tr>
                    <tr>
                      <td><strong>GND</strong></td>
                      <td>Masse</td>
                    </tr>
                    <tr>
                      <td><strong>TX</strong></td>
                      <td>Transmission de donn√©es</td>
                    </tr>
                    <tr>
                      <td><strong>RX</strong></td>
                      <td>R√©ception de donn√©es</td>
                    </tr>
                    <tr>
                      <td><strong>CH_PD / EN</strong></td>
                      <td>Activation du module</td>
                    </tr>
                    <tr>
                      <td><strong>Reset</strong></td>
                      <td>R√©initialisation du module</td>
                    </tr>
                    <tr>
                      <td><strong>GPIO0 et GPIO2</strong></td>
                      <td>Broches d‚Äôentr√©e/sortie num√©riques</td>
                    </tr>
                  </tbody>
                </table>
              <div class="image-container">
                <img src="../images/Test4/Electronique/module_wifi.webp" alt="module_wifi" class="image-small"/>
              </div>

              <p class="txt_center">
                <strong>NB:</strong> ce module n'est pas encore int√©gr√© dans cette documentation √† cause de probl√®mes de communication avec l'interface.
                La communication se fera alors par cable USB pour le moment.
              </p>

              <h4>e. Bloc de sortie</h4>
              <h5>&#10022; Moteur</h5>
                <p>
                  Le <strong>moteur √† courant continu</strong> (DC) 6‚Äì12 V est utilis√© pour entra√Æner le tapis du convoyeur. 
                  Il assure le d√©placement des objets d√©tect√©s gr√¢ce √† son couple adapt√© aux applications de petite puissance. 
                  Son alimentation est assur√©e par une source externe(12 V), 
                  tandis que sa mise en marche est command√©e √©lectroniquement.
                </p>
                <p>
                  Pour contr√¥ler le moteur, un transistor <strong>MOSFET canal N</strong> est utilis√© comme interrupteur √©lectronique. 
                  Ce composant permet de g√©rer l‚Äôalimentation du moteur en fonction du signal envoy√© par la carte Arduino. 
                  Une diode de roue libre est plac√©e en parall√®le du moteur afin de prot√©ger le circuit contre les surtensions transitoires g√©n√©r√©es lors de l‚Äôarr√™t du moteur, dues √† l‚Äôinduction.
                </p>
                <p>
                  La commande du moteur se fait via une broche <strong>PWM</strong> de l‚ÄôArduino connect√©e √† la grille du MOSFET. 
                  En faisant varier le rapport cyclique du signal PWM, il est possible d'<strong>ajuster la vitesse de rotation</strong> du moteur, et donc la vitesse du convoyeur. 
                  Un signal √† rapport cyclique √©lev√© entra√Æne une rotation rapide, tandis qu‚Äôun rapport plus faible r√©duit la vitesse du moteur.
                </p>
                <p>
                  Ainsi, le syst√®me est plus optimis√© et ne d√©pend plus d'un 
                  <a href="https://www.handsontec.com/dataspecs/L298N%20Motor%20Driver.pdf" download target="_blank">moteur driver</a>.
                </p>

                <div class="image-container">
                  <img src="../images/Test4/Electronique/mosfet.webp" alt="Moteur" class="image-small"/>
                  <img src="../images/Test4/Electronique/moteur_dc.webp" alt="Moteur" class="image-small"/>
                  <img src="../images/Test4/Electronique/commande_moteur1.webp" alt="Moteur" class="image-mean"/>
                </div>

                <div class="code-container">
                  <p>code_moteur.ino </p>
                  <div class="btn-bar">
                    <button onclick="copierCode('code_moteur-ino', this)">üìã</button>
                    <button onclick="telechargerCode('code_moteur-ino', 'code_moteur.ino', 'text/ino', this)">ü°á</button>
                  </div>
                  <pre><code class="hljs" id="code_moteur-ino">
#define pinMotor 3

void setup () {
    pinMode(pinMotor, OUTPUT);
}

void loop() {
    analogWrite(pinMotor, 100);
    delay(2000);
    analogWrite(pinMotor, 0);
    delay(5000);
}
                </code></pre>
              </div>

              <video controls width=50%>
                <source src="../videos/Test4/Electronique/moteur1.mp4" type="video/mp4">
                Votre navigateur ne supporte pas la vid√©o HTML5.
              </video>

              <h4>&#10022; Led RGB</h4>
                <p>
                  La <a href="https://www.electronicoscaldas.com/datasheet/LED5D-RGB-CA.pdf?srsltid=AfmBOoqs7qaS3Igqh4KOchV5kW2dMOhyP29FHSZP3KxMu2uM1ZmHUj3s" download target="_blank">LED RGB</a> 
                  affiche la couleur d√©tect√©e(rouge, bleu, vert, jaune).
                </p>
                <p>
                  Le signal PWM est utilis√© pour moduler l‚Äôintensit√© de chaque couleur et ainsi permettre le m√©lange des couleurs. 
                  Les broches de la LED doivent donc √™tre connect√©es √† des pins compatibles PWM.
                </p>

                <p>
                  Elle peut aussi indiquer l'√©tat du convoyeur(en marche ou √† l'arr√™t).
                </p>

                <div class="image-container">
                  <img src="../images/Test4/Electronique/led.webp" alt="LED" class="image-mean"/>
                  <p>Led RGB √† anode commun</p>
                </div>

                <div class="image-container">
                  <img src="../images/Test4/Electronique/circuit_led.webp" alt="LED" class="image-mean"/>
                </div>

                <div class="code-container">
                  <p>code_led.ino </p>
                  <div class="btn-bar">
                    <button onclick="copierCode('code_led-ino', this)">üìã</button>
                    <button onclick="telechargerCode('code_led-ino', 'code_led.ino', 'text/ino', this)">ü°á</button>
                  </div>
                  <pre><code class="hljs" id="code_led-ino">
#define LED_R 9
#define LED_G 10
#define LED_B 11

void setup() {
  pinMode(LED_R, OUTPUT);
  pinMode(LED_G, OUTPUT);
  pinMode(LED_B, OUTPUT);
}

void loop() {
  setColor(100, 0, 0); //rouge
  delay(2000);
  setColor(0, 100, 0); //vert
  delay(2000);
  setColor(0, 0, 100); //bleu
  delay(2000);
  setColor(100, 100, 0); //jaune
  delay(2000);
}

void setColor(unsigned int red, unsigned int green, unsigned int blue) {
  // 0 correspond √† 255 et 255 √† 0 pour LED √† anode commun
  red = map(red, 0, 255, 255, 0);
  green = map(green, 0, 255, 255, 0);
  blue = map(blue, 0, 255, 255, 0);
  analogWrite(LED_R, red);
  analogWrite(LED_G, green);
  analogWrite(LED_B, blue);
}
                </code></pre>
              </div>

              <video controls width=50%>
                <source src="../videos/Test4/Electronique/led_rgb.mp4" type="video/mp4">
                Votre navigateur ne supporte pas la vid√©o HTML5.
              </video>

              <p class="txt_center">
                <strong>NB:</strong> Utiliser des r√©sistances pour prot√©ger la led. 
                Ici, nous avons utilis√© des r√©sistances de <strong>270 &ohm;</strong> pour chaque pin RGB.
              </p>

              <h4>f. Bloc de commande</h4>
                <p>
                  Un <strong>interrupteur</strong> a √©t√© install√© pour permettre √† l'utilisateur de mettre sous tension ou de couper le courant.
                </p>
                <p>
                  Par ailleurs, deux <strong>boutons-poussoirs</strong> sont pr√©vus pour commander la mise en marche et l'arr√™t du convoyeur.
                  <ul>
                    <li>
                      <strong>Bouton Start</strong>(connect√© au pin 7 de l'Arduino): permet d'activer le syst√®me.
                    </li>
                    <li>
                      <strong>Bouton Stop</strong>(connect√© au pin 2 de l'Arduino): permet de d√©sactiver le syst√®me √† l'aide 
                      d'<a href="https://docs.arduino.cc/language-reference/en/functions/external-interrupts/attachInterrupt/" download target="_blank">interruption</a>
                      , assurant ainsi un arr√™t rapide et r√©actif.
                    </li>
                  </ul>
                </p>


                <div class="image-container">
                  <img src="../images/Test4/Electronique/boutons_poussoirs.webp" alt="boutons_poussoirs" class="image-mean"/>
                  <p>
                    <strong>NB:</strong> Nous utilisons les r√©sistances 
                    <a href="https://docs.arduino.cc/tutorials/generic/digital-input-pullup/" download target="_blank">pull-up internes</a> 
                    afin d‚Äôoptimiser l‚Äôutilisation du mat√©riel.</p>
                </div>

                <div class="code-container">
                  <p>code_bp.ino </p>
                  <div class="btn-bar">
                    <button onclick="copierCode('code_bp-ino', this)">üìã</button>
                    <button onclick="telechargerCode('code_bp-ino', 'code_bp.ino', 'text/ino', this)">ü°á</button>
                  </div>
                  <pre><code class="hljs" id="code_bp-ino">
const byte pinStart = 7;
const byte pinStop = 2; 
const byte ledPin = 12;
volatile bool blinking = false;
unsigned long lastInterrupt = 0;

void setup() {
  pinMode(ledPin, OUTPUT);
  // boutons poussoirs
  pinMode(pinStart, INPUT_PULLUP);
  pinMode(pinStop, INPUT_PULLUP);
  attachInterrupt(digitalPinToInterrupt(pinStop), interrupt_routine, FALLING);

  digitalWrite(ledPin, LOW); // √©teint la led initialement
}

void loop() {
  if(!blinking){
    while(digitalRead(pinStart)){ //tant qu'on n'appuie pas sur btnStart, la boucle continue
      delay(10);
    }
    blinking = true;
  }

  else{
    digitalWrite(ledPin, HIGH);
    delay(300);
    digitalWrite(ledPin, LOW);
    delay(300);
  }
}

void interrupt_routine() {
  unsigned long currentMillis = millis();
  if (currentMillis - lastInterrupt > 100) { // anti-rebond de 100 ms
    digitalWrite(ledPin, LOW);
    blinking = false;
    lastInterrupt = currentMillis;
  }
}
                </code></pre>
              </div>

              <!-- <video controls width=50%>
                <source src="../videos/Test4/Electronique/boutons_poussoirs.mp4" type="video/mp4">
                Votre navigateur ne supporte pas la vid√©o HTML5.
              </video> -->
              
          <h3 id="4-electro">4. Tests et validation</h3>
            <p>
              Apr√®s avoir pris en main chaque composant, il est temps de r√©aliser un test global du syst√®me √©lectrique.
            </p>
            <p>
              Nous avons r√©alis√© les branchements sur un breadboard puis le circuit sur veroboard pour les tests afin de s'assurer que chaque composant s'integre au syst√®me electronique.
            </p>
            <p>Voici quelques uns de ces test:</p>
            <ul>
              <li>Test du capteur de couleur avec la led RGB:</li>
                <video controls width=50%>
                  <source src="videos\Test4\Electronique\sensorColor_rgb.mp4" type="video/mp4">
                  Votre navigateur ne supporte pas la vid√©o HTML5.
                </video>

              <li>V√©rification de l‚Äôalimentation et du pilotage du moteur avec le circuit c√¢bl√© sur veroboard.</li>
                <video controls width=50%>
                  <source src="../videos/Test4/Electronique/moteur2.mp4" type="video/mp4">
                  Votre navigateur ne supporte pas la vid√©o HTML5.
                </video>
            </ul>

            
          <h3 id="5-electro">5. R√©alisation du PCB</h3>
            <p>
              Apr√®s avoir effectu√© tous les tests, nous avons r√©alis√© un PCB sur Kicad comme suit:
            </p>
            <div class="image-container">
              <img src="../images/Test4/Electronique/pcb1.webp" alt="pcb" class="image-mean" />
              <p>
                Conception du sch√©ma √©lectronique.
              </p>
            </div>

            <p>
              Nous avons d√©cid√© par la suite de rassembler les <strong>Vcc</strong> et <strong>GND</strong> pour les capteurs, la led et les boutons poussoirs afin de faciliter les branchements.
            </p>
            <div class="image-container">
              <img src="../images/Test4/Electronique/pcb2.webp" alt="pcb" class="image-mean" />
              <p>
                Conception du sch√©ma pour le pcb.
              </p>
            </div>
            
            <div class="image-container">
              <img src="../images/Test4/Electronique/pcb3.webp" alt="pcb" class="image-mean" />
              <p>
                Attribution des empreintes.
              </p>
            </div>
        
            <div class="image-container">
              <img src="../images/Test4/Electronique/pcb4.webp" alt="pcb" class="image-mean" />
              <p>
                Verificaton des erreurs (DRC)
              </p>
            </div>
            
            <div class="image-container">
              <img src="../images/Test4/Electronique/pcb5.webp" alt="pcb" class="image-small" />
              <p>
                Ajustement de la disposition et routage des pistes.
              </p>
            </div>


            <div class="image-container">
              <img src="../images/Test4/Electronique/pcb6.webp" alt="pcb" class="image-small" />
              <p>
                Plan de masse GND et ajout des textes pour les diff√©rents composants et pins.
              </p>
            </div>

            <div class="image-container">
              <img src="../images/Test4/Electronique/pcb7.webp" alt="pcb" class="image-small" />
              <img src="../images/Test4/Electronique/pcb8.webp" alt="pcb" class="image-small" />
              <p>
                Ajout des models 3D(arduino nano et serre-fils).
              </p>
            </div>

            <div class="image-container">
              <img src="../images/Test4/Electronique/pcb9.webp" alt="pcb" class="image-mean" />
              <p>
                Visualisation 3D
              </p>
            </div>

            <p class="txt_center">
              <a href="https://github.com/TekBot-Robotics-Challenge/2025-Team-B2MS_CleanTech-Docs/raw/refs/heads/main/Test4/Electronique/convoyeur_pcb.rar" target="_blank" class="download-link">t√©l√©charger les fichiers du PCB</a>
            </p>

          <h3 id="6-electro">6. Prototype final</h3>
            <p>
              Apr√®s les tests sur le breadboard et la conception du PCB, il est temps de r√©aliser le circuit final.
              Nous utilisons ici un veroboard, tout en respectant les pins utilis√©es dans la conception du PCB.
            </p>
            <p>
              <strong>NB:</strong> Nous avons retravaill√© notre circuit pour r√©pondre aux exigences techniques et esth√©tiques.
            </p>
            <div class="image-container">
              <img src="../images/Test4\Electronique\circuit0.webp" alt="circuit" class="image-mean"/>
              <p>
                Comparatif des deux prototypes
              </p>
            </div>

            <div class="image-container">
              <p>
                Prototype final adopt√©:
              </p>
              <img src="../images/Test4\Electronique\circuit1.webp" alt="circuit" class="image-small"/>
              <img src="../images/Test4\Electronique\circuit5.webp" alt="circuit" class="image-small"/>
              <img src="../images/Test4\Electronique\circuit6.webp" alt="circuit" class="image-small"/>
              <img src="../images/Test4\Electronique\circuit7.webp" alt="circuit" class="image-small"/>

              <img src="../images/Test4\Electronique\circuit2.webp" alt="circuit" class="image-small"/>
              <img src="../images/Test4\Electronique\circuit3.webp" alt="circuit" class="image-small"/>
              <img src="../images/Test4\Electronique\circuit4.webp" alt="circuit" class="image-small"/>
              <img src="../images/Test4\Electronique\circuit9.webp" alt="circuit" class="image-small"/>
            </div>
        </div>

      </section>
    </main>
  </div>

  <footer>
    Copyright ¬© 2025 Team B2MS CleanTech. All rights reserved.
  </footer>

  <script src="../scripts/script_commun.js"></script>
  <script src="../scripts/script_code.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
</body>
</html>
